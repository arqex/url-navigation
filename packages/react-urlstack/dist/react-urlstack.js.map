{"version":3,"file":"react-urlstack.js","sources":["../../urlhub/urlhub.js","../../urlhub/nodeStrategy.js","../../urlhub/hashStrategy.js","../../urlhub/pushStrategy.js","../../urlstack/urlstack.js","../src/utils/utils.js","../src/defaultTransitions/tabTransition.js","../src/utils/animatedStyles.js","../src/utils/wrapperContext.js","../src/ScreenWrapper.js","../src/TransitionElement.js","../src/utils/sharedElementContext.js","../src/ScreenStack.js","../src/ModalWrapper.js","../src/DrawerWrapper.js","../src/defaultTransitions/desktopTransition.js","../src/defaultTransitions/mobileTransition.js","../src/defaultTransitions/modalTransition.js","../src/Navigator.js","../src/SharedElement.js"],"sourcesContent":["var parser = require('path-to-regexp');\r\nvar qs = require('mini-querystring');\r\n\r\n/*\r\nroutes = {\r\n  path: '/hola',\r\n  cb: fn,\r\n  children: []\r\n}\r\n*/\r\n\r\n// parseUrl function needed for testing\r\nvar parseUrl;\r\nif( typeof window !== 'undefined' ){\r\n  parseUrl = function( url ){\r\n    var a = document.createElement('a');\r\n    a.href = url;\r\n    return a;\r\n  };\r\n}\r\n\r\n// The lib\r\nvar urlhub = {\r\n  create: function( options ){\r\n    return new Urlhub( options );\r\n  },\r\n  joinUrls: joinUrls // just for testing never used, see helpers at bottom\r\n}\r\n\r\n\r\n// The class\r\nvar Urlhub = function( options ){\r\n  if( !options || !options.strategy ){\r\n    throw new Error('Router needs an strategy to listen to url changes.');\r\n  }\r\n\r\n  var s = options.strategy;\r\n\r\n  var ops = {};\r\n  Object.keys( options ).forEach( function( key ){\r\n    if( key === 'strategy' ) return;\r\n    ops[key] = options[key];\r\n  });\r\n\r\n  s.init && s.init( ops );\r\n  this.strategy = s;\r\n\r\n  // Callbacks before the route change\r\n  this.obc = [];\r\n\r\n  // Callbacks to be called on route change\r\n  this.cbs = [];\r\n}\r\n\r\nvar prototype = {\r\n  setRoutes: function( routes ){\r\n    this.routes = this.parseRoutes( routes );\r\n  },\r\n  // Route translation methods\r\n  parseRoutes: function( routes, parent ){\r\n    if( !routes ) console.warn( 'No routes provided to parseRoutes' );\r\n\r\n    if( !routes.length ){\r\n      routes = [routes];\r\n    }\r\n\r\n    var parsedRoutes = [],\r\n      me = this\r\n    ;\r\n\r\n    routes.forEach( function(r){\r\n      var path = joinUrls(parent, r.path);\r\n\r\n      var params = [],\r\n        parsed = {\r\n          regex: parser( path, params ),\r\n          id: path,\r\n          cb: r.cb\r\n        }\r\n      ;\r\n\r\n      parsed.params = params.map( function(p){ return p.name } );\r\n\r\n      if( r.children && r.children.length ){\r\n        parsed.childRegex = parser( path, [], {end: false} );\r\n        parsed.children = me.parseRoutes( r.children, path );\r\n      }\r\n\r\n      parsedRoutes.push( parsed );\r\n    });\r\n\r\n    return parsedRoutes;\r\n  },\r\n\r\n  match: function( location, candidates, isChild ){\r\n    var i = 0,\r\n      url = sanitizeUrl( location ),\r\n      path, found, match, c\r\n    ;\r\n\r\n    if( !candidates ){\r\n      candidates = this.routes;\r\n    }\r\n\r\n    var parsed = (this.strategy.parseUrl || parseUrl)( url );\r\n    path =  parsed.pathname;\r\n\r\n    // Normalize pathname\r\n    if( path[0] !== '/' ){\r\n      path = '/' + path;\r\n    }\r\n\r\n    while( i < candidates.length && !found ){\r\n      c = candidates[i];\r\n      if( c.childRegex ){\r\n        //console.log( 'failed', c.regex, path );\r\n        found = c.childRegex.exec( path );\r\n        if( found ){\r\n          match = this.match( url, c.children, true );\r\n          if( match.matches.length ){\r\n            match.matches = [c.cb].concat( match.matches );\r\n            match.matchIds = [c.id].concat( match.matchIds );\r\n            return match; // The recursive call will give all the info\r\n          }\r\n          else {\r\n            found = false;\r\n          }\r\n        }\r\n      }\r\n\r\n      found = c.regex.exec( path );\r\n      if( found ){\r\n        found = {\r\n          id: c.id, cb: c.cb, params: found.slice(1)\r\n        };\r\n      }\r\n\r\n      if( !found ){\r\n        i++;\r\n      }\r\n    }\r\n\r\n    var matches = [];\r\n    var matchIds = [];\r\n\r\n    if( found ){\r\n      matches.push( found.cb )\r\n      matchIds.push( found.id )\r\n    }\r\n    else if( !isChild ){\r\n      console.error('There is no route match for ' + location);\r\n    }\r\n\r\n    match = {\r\n      matches: matches,\r\n      matchIds: matchIds,\r\n      pathname: path,\r\n      search: parsed.search,\r\n      query: qs.parse( parsed.search ),\r\n      hash: parsed.hash,\r\n      route: found && found.id || false,\r\n      params: {}\r\n    };\r\n\r\n    if( found ){\r\n      c.params.forEach( function( p, i ){\r\n        match.params[ p ] = found.params[i];\r\n      });\r\n    }\r\n\r\n    return match;\r\n  },\r\n\r\n  // Routing methods\r\n  start: function(){\r\n    var me = this;\r\n    this.strategy.onChange( function(){\r\n      var change = me.checkChange();\r\n      if( !change.next ) return;\r\n\r\n      if( change.current !== change.next ){\r\n        me.strategy.replace( change.next );\r\n      }\r\n      else {\r\n        me.location = change.nextLocation;\r\n        me.cbs.forEach( function( cb ){\r\n          cb( change.nextLocation );\r\n        });\r\n      }\r\n    });\r\n\r\n    this.strategy.start();\r\n    this.location = this.match( this.strategy.getLocation() );\r\n    return this.location;\r\n  },\r\n  stop: function(){\r\n    this.strategy.onChange( function(){} );\r\n  },\r\n  refresh: function(){\r\n    var change = this.checkChange();\r\n    change.next && change.current !== change.next && this.strategy.replace( change.next );\r\n  },\r\n  checkChange: function(){\r\n    var current = this.strategy.getLocation(),\r\n      nextLocation = this.runOnBeforeChange( this.match(current) ),\r\n      next = nextLocation && (nextLocation.pathname + nextLocation.search + nextLocation.hash)\r\n    ;\r\n\r\n    return {current:current, next:next, nextLocation:nextLocation};\r\n  },\r\n  runOnBeforeChange: function( match ){\r\n    var me = this;\r\n\r\n    this.obc.forEach( function(cb){\r\n      if( match ){\r\n        match = cb( match );\r\n        if( typeof match === 'string' ){\r\n          match = me.match( match );\r\n        }\r\n      }\r\n    });\r\n\r\n    return match;\r\n  },\r\n  onBeforeChange: function( cb ){\r\n    this.obc.push( cb );\r\n  },\r\n  onChange: function( cb ){\r\n    this.cbs.push( cb );\r\n  },\r\n  push: function( location ){\r\n    this.updateLocation('push', location);\r\n  },\r\n  replace: function( location ){\r\n    this.updateLocation('replace', location);\r\n  },\r\n  back: function(){\r\n    this.strategy.back();\r\n  },\r\n  updateLocation: function( method, location ){\r\n    var current = this.strategy.getLocation();\r\n    var next;\r\n\r\n    if(typeof location === 'string'){\r\n      next = location;\r\n    }\r\n    else {\r\n      next = mergeLocations( this.match( current ), location );\r\n    }\r\n\r\n    var nextLocation = this.runOnBeforeChange( this.match(next) );\r\n    if( nextLocation ){\r\n      next = nextLocation.pathname + nextLocation.search + nextLocation.hash;\r\n      if( current !== next ){\r\n        this.strategy[ method ]( next );\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfor( var method in prototype ) Urlhub.prototype[ method ] = prototype[method];\r\n\r\nmodule.exports = urlhub;\r\n\r\n\r\n/********* HELPERS */\r\nfunction joinUrls( one, two ){\r\n  var first = sanitizeUrl(one),\r\n    second = sanitizeUrl(two)\r\n  ;\r\n\r\n  if( !one ) return second;\r\n  if( !two ) return first;\r\n\r\n  if( first === '/'){\r\n    return second;\r\n  }\r\n  else if( second === '/' ){\r\n    return first;\r\n  }\r\n  else {\r\n    return first + second;\r\n  }\r\n}\r\n\r\nfunction sanitizeUrl( url ){\r\n  if( !url ) return '/';\r\n  var sanitized = url;\r\n  if( sanitized[ sanitized.length - 1 ] === '/' ){\r\n    sanitized = sanitized.slice(0, sanitized.length - 1);\r\n  }\r\n  if( sanitized[0] !== '/' ){\r\n    sanitized = '/' + sanitized;\r\n  }\r\n  return sanitized;\r\n}\r\n\r\nfunction mergeLocations( prev, next ){\r\n  var location = Object.assign( prev, next ),\r\n    search = location.search\r\n  ;\r\n\r\n  if( Object.keys(location.query).length ){\r\n    search = '?' + qs.stringify( location.query );\r\n  }\r\n  else {\r\n    search = '';\r\n  }\r\n\r\n  return location.pathname + search + location.hash;\r\n}\r\n","var qs = require('mini-querystring');\r\nvar onChange = function () {};\r\n\r\nvar nodeStrategy = {\r\n  init: function( options ){\r\n\t\tthis.history = [ options.initialLocation || '/' ];\r\n  },\r\n  start: function(){\r\n    this.emit();\r\n  },\r\n  push: function( location ){\r\n\t\tthis.history.push( location );\r\n    this.emit();\r\n  },\r\n  replace: function( location ){\r\n\t\tthis.history[ this.history.length ] = location;\r\n    this.emit();\r\n  },\r\n  onChange: function( cb ){\r\n    onChange = cb;\r\n  },\r\n  getLocation: function(){\r\n    return this.history[ this.history.length - 1 ];\r\n  },\r\n  emit: function(){\r\n    onChange && onChange( this.getLocation() );\r\n\t},\r\n\tparseUrl: function( str ){\r\n\t\tvar parts = str.split('?')\r\n\t\tvar searchParts = parts[1] ? parts[1].split('#') : [];\r\n\t\treturn {\r\n\t\t\tpathname: parts[0],\r\n\t\t\tsearch: searchParts[0] ? '?' + searchParts[0] : '',\r\n\t\t\thash: searchParts[1] ? '#' + searchParts[1] : '',\r\n\t\t\tquery: searchParts[0] ? qs.parse( searchParts[0] ) : {}\r\n\t\t}\r\n  },\r\n  back: function(){\r\n    if( this.history.length > 1 ){\r\n      this.history.pop()\r\n    }\r\n    this.emit();\r\n  }\r\n};\r\n\r\nmodule.exports = nodeStrategy;","var onChange = function () {};\r\nvar hashStrategy = {\r\n\tinit: function (options) {\r\n\t},\r\n\r\n\tstart: function () {\r\n\t\tvar me = this;\r\n\r\n\t\tif (!location.hash) {\r\n\t\t\tlocation.hash = '#/';\r\n\t\t}\r\n\r\n\t\t// Register event listener\r\n\t\twindow.onhashchange = function () {\r\n\t\t\tme.emit();\r\n\t\t};\r\n\r\n\t\t// Emit first onChange\r\n\t\tme.emit();\r\n\t},\r\n\tpush: function (route) {\r\n\t\twindow.location.hash = '#' + route;\r\n\t},\r\n\treplace: function (route) {\r\n\t\tvar url = location.protocol + '//' + location.host + location.pathname + '#' + route;\r\n\r\n\t\tlocation.replace(url);\r\n\t},\r\n\tonChange: function (cb) {\r\n\t\tonChange = cb;\r\n\t},\r\n\tgetLocation: function () {\r\n\t\tif( !location.hash ){\r\n\t\t\treturn '/';\r\n\t\t}\r\n\t\telse if (location.hash[1] !== '/') {\r\n\t\t\treturn '/' + location.hash;\r\n\t\t}\r\n\t\treturn location.hash.slice(1);\r\n\t},\r\n\temit: function () {\r\n\t\tonChange(this.getLocation());\r\n\t},\r\n\tback: function () {\r\n    window.history.back();\r\n\t}\r\n};\r\n\r\nmodule.exports = hashStrategy;\r\n","var onChange = function () {};\r\n\r\nvar pushStrategy = {\r\n  init: function( options ){\r\n    this.basePath = options.basePath || '';\r\n    if( this.basePath.slice(-1) === '/' ){\r\n      this.basePath = this.basePath.slice(0, -1);\r\n    }\r\n  },\r\n  start: function(){\r\n    var me = this;\r\n\r\n    // Register event listener\r\n    window.onpopstate = function(){\r\n      me.emit();\r\n    };\r\n\r\n    // Emit first onChange\r\n    me.emit();\r\n  },\r\n  push: function( location ){\r\n    history.pushState( {}, '', this.basePath + location );\r\n    this.emit();\r\n  },\r\n  replace: function( location ){\r\n    history.replaceState( {}, '', this.basePath + location );\r\n    this.emit();\r\n  },\r\n  onChange: function( cb ){\r\n    onChange = cb;\r\n  },\r\n  getLocation: function(){\r\n    var l = location.pathname + location.search + location.hash,\r\n      basePathLength = this.basePath.length\r\n    ;\r\n\r\n    if( l.slice(0, basePathLength) === this.basePath ){\r\n      l = l.slice( basePathLength );\r\n    }\r\n\r\n    return l;\r\n  },\r\n  emit: function(){\r\n    onChange && onChange( this.getLocation() );\r\n  },\r\n\tback: function () {\r\n    window.history.back();\r\n\t}\r\n};\r\n\r\nmodule.exports = pushStrategy;\r\n","import urlhub from 'urlhub'\r\nimport nodeStrategy from 'urlhub/nodeStrategy'\r\nimport hashStrategy from 'urlhub/hashStrategy'\r\nimport pushStrategy from 'urlhub/pushStrategy'\r\n\r\n// A wrapper around urlhub to better manage a stack\r\n// Changes in the current routes will be stacking the screens,\r\n// if going back the screens don't get unmounted, there is an index\r\n// that points to the current active route\r\n//\r\n// The route also handles tab screens. Navegating in a tab screen doesn't\r\n// update the main stack, but the children inside the tab screen\r\n\r\n// If we imagine a linear stack of routes like this:\r\n// /a ---> /a/tab ---> /a/tab/2 ---> /a/tab/2/details ( activeIndex: 2 )\r\n// [0]     [1]         [2]           [3]\r\n\r\n// But the real stack that handles the tab screens would be like this:\r\n//\r\n//   [0]     [1]         [2]\r\n//   /a ---> /a/tab ---> /a/tab/2/details (activeIndex: 1)\r\n//              |\r\n//              V\r\n// [/a/tab/1, /a/tab/2, /a/tab/3 ] (activeTabIndex: 1)\r\n// [0]        [1]       [2]\r\n//\r\n// So there is a new stack for every tab\r\n\r\nexport default function create( routes, options ){\r\n\tvar strategy;\r\n\tif( typeof document === 'undefined' ){\r\n\t\tstrategy = nodeStrategy\r\n\t}\r\n\telse if( options && options.strategy === 'hash' ){\r\n\t\tstrategy = hashStrategy\r\n\t}\r\n\telse {\r\n\t\tstrategy = pushStrategy\r\n\t}\r\n\r\n\tvar router = urlhub.create({strategy});\r\n\r\n\t// callbacks registered for be called on route changes\r\n\tvar callbacks = [];\r\n\r\n\tvar stackRouter = {\r\n\t\t// The actual urlhub router\r\n\t\turlhub: router,\r\n\r\n\t\t// The stack of screens in place, with nested tabs [{Screen, route, isTabs, isModal, key}]\r\n\t\tstack: [],\r\n\r\n\t\t// The current screen in the view port\r\n\t\tactiveIndex: -1,\r\n\t\t\r\n\t\t// Route cache to generate new routes\r\n\t\t_nestedStack: [],\r\n\r\n\t\t// Last navigated URLs\r\n\t\t_lastNavigated: [],\r\n\r\n\t\tmodal: { active: false, stack: [], activeIndex: -1 },\r\n\r\n\t\t// What to do when the URL changes\r\n\t\tonChange: function( handler ){\r\n\t\t\tcallbacks.push( handler )\r\n\t\t},\r\n\r\n\t\t// The main method to update the current screen\r\n\t\tnavigate: function( route ){\r\n\t\t\tvar isBack = route === this._lastNavigated[ this._lastNavigated.length - 2];\r\n\r\n\t\t\tif( isBack ){\r\n\t\t\t\tthis._lastNavigated.pop();\r\n\t\t\t\t// unfortunatelly this is buggy in chrome\r\n\t\t\t\t// router.back();\r\n\t\t\t\trouter.push.apply( router, arguments );\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._lastNavigated.push( route );\r\n\t\t\t\trouter.push.apply( router, arguments );\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// Set routes and our callback that will generate the stacks\r\n\trouter.setRoutes( routes );\r\n\trouter.onChange( createRouteChanger( stackRouter, routes, callbacks ) );\r\n\r\n\t// Some extra methods from urlhub\r\n\t['start', 'stop', 'onBeforeChange', 'replace'].forEach( method => {\r\n\t\tstackRouter[method] = function(){\r\n\t\t\treturn this.urlhub[method].apply( this.urlhub, arguments );\r\n\t\t}\r\n\t});\r\n\r\n\treturn stackRouter;\r\n}\r\n\r\n// Helper to translate urlhub's location changes to the model {stack, index}\r\nfunction createRouteChanger( router, routes, callbacks ){\r\n\r\n\t// Get the hierarchy of absolute routes\r\n\tvar routeData = getRouteData( routes );\r\n\t\r\n\tvar onChange = location => {\r\n\t\t// Check if the change hasn't been programmatic (by the browser history or address bar )\r\n\t\tlet route = location.pathname + location.search + location.hash;\r\n\t\tif( route !== router._lastNavigated[ router._lastNavigated.length - 1] ){\r\n\t\t\t// In this case we flush the last navigated as we can't rely on our history to try to predict\r\n\t\t\t// going back interactions anymore\r\n\t\t\trouter._lastNavigated = [];\r\n\t\t}\r\n\r\n\t\t// Create a nested stack based on the current location\r\n\t\tvar nestedStack = createNestedStack( location, routeData );\r\n\t\tvar { stack, index } = mergeStacks( router._nestedStack || [], nestedStack, routeData );\r\n\t\tsetStacksAndIndexes( router, splitStack( stack ), index, routeData )\r\n\r\n\t\t// Update attributes of the router\r\n\t\trouter.location = location\r\n\t\trouter._nestedStack = stack\r\n\r\n\t\t// Call user's callbacks\r\n\t\tcallbacks.forEach( clbk => clbk(location) )\r\n\t}\r\n\r\n\treturn onChange\r\n}\r\n\r\nfunction createNestedStack( location, routeData ) {\r\n\tvar matchIds = location.matchIds;\r\n\tvar inTab = false;\r\n\tvar stack = [];\r\n\r\n\tmatchIds.forEach( route => {\r\n\t\tvar data = routeData[route];\r\n\r\n\t\tif (inTab) {\r\n\t\t\t// If we are in a tab we won't push this route to the main stack,\r\n\t\t\t// just update the activeIndex\r\n\t\t\tinTab.tabs.activeIndex = findTab(route, inTab.tabs.stack)\r\n\r\n\t\t\t// Get out the stack\r\n\t\t\tinTab = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar item = createStackItem( route, location, data );\r\n\r\n\t\tif (item.isTabs) {\r\n\t\t\t// Push all children\r\n\t\t\titem.tabs = {\r\n\t\t\t\tactiveIndex: 0,\r\n\t\t\t\tstack: routeData[item.route].children.map( child => (\r\n\t\t\t\t\tcreateStackItem( route + child.path, location, routeData[ route + child.path ] )\r\n\t\t\t\t))\r\n\t\t\t};\r\n\t\t\tinTab = item;\r\n\t\t}\r\n\r\n\t\tstack.push(item);\r\n\t})\r\n\r\n\tif( inTab ){\r\n\t\t// This means that the last screen in the hierarchy was a tab wrapper\r\n\t\t// Check if we have any tab to show\r\n\t\tif( !inTab.tabs.stack.length ){\r\n\t\t\tconsole.warn('Urlstack: Hit a tabs URL without any children: ' + tabScreen.path)\r\n\t\t}\r\n\t}\r\n\r\n\treturn stack\r\n}\r\n\r\nfunction splitStack( nestedStack ){\r\n\tvar allStacks = [];\r\n\tvar currentStack = [];\r\n\r\n\tnestedStack.forEach( item => {\r\n\t\tif( item.isModal ){\r\n\t\t\tallStacks.push( currentStack );\r\n\t\t\tcurrentStack = [ item ]\r\n\t\t}\r\n\t\telse {\r\n\t\t\tcurrentStack.push( item )\r\n\t\t}\r\n\t})\r\n\tif( currentStack.length ){\r\n\t\tallStacks.push( currentStack )\r\n\t}\r\n\treturn allStacks;\r\n}\r\n\r\nfunction setStacksAndIndexes( router, stacks, targetIndex, routeData ){\r\n\tif( !stacks[0].length ){\r\n\t\t// If the first element is empty means that we are in a modal\r\n\t\tif( !router.stack.length ){\r\n\t\t\t// if the currentstack is empty we need to get the default screen\r\n\t\t\tvar bgRoute = routeData[ stacks[1][0].route ].backgroundRoute || '/*'\r\n\t\t\tvar location = router.urlhub.match( bgRoute )\r\n\t\t\tvar {stack, index} = mergeStacks( [], createNestedStack( location, routeData ), routeData);\r\n\t\t\trouter.stack = stack\r\n\t\t\trouter.activeIndex = index\r\n\t\t}\r\n\t\t// otherwise we need to preserve the current stack\r\n\t}\r\n\telse {\r\n\t\trouter.stack = stacks[0]\r\n\t\trouter.activeIndex = Math.max( 0, Math.min( targetIndex, stacks[0].length - 1 ) )\r\n\t\tif( router.modal ){\r\n\t\t\trouter.modal.active = false\r\n\t\t}\r\n\t}\r\n\r\n\tif( stacks.length > 1 ){\r\n\t\tif( !router.modal ){\r\n\t\t\trouter.modal = { stack: [], activeIndex: 0 }\r\n\t\t}\r\n\t\trouter.modal.active = targetIndex >= 0;\r\n\t\tsetStacksAndIndexes( router.modal, stacks.slice(1), targetIndex - stacks[0].length, routeData )\r\n\t}\r\n}\r\n\r\n\r\nfunction createStackItem ( route, location, routeData ){\r\n\treturn {\r\n\t\tScreen: routeData.cb,\r\n\t\troute: route,\r\n\t\tisTabs: !!routeData.isTabs,\r\n\t\tisModal: !!routeData.isModal,\r\n\t\tlocation: location,\r\n\t\tpath: getRoutePath( route, location.pathname ),\r\n\t\tkey: generateKey()\r\n\t}\r\n}\r\n\r\nfunction getRoutePath( route, pathname ){\r\n\tvar routeParts = route.split('/');\r\n\tvar pathParts = pathname.split('/');\r\n\tvar routePath = [];\r\n\r\n\trouteParts.forEach( (p, i) => {\r\n\t\troutePath.push( pathParts[i] || p )\r\n\t})\r\n\r\n\treturn routePath.join('/');\r\n}\r\n\r\nfunction mergeStacks( currentStack, candidateStack, routeData ){\r\n\tvar nextStack = []\r\n\tvar i = 0\r\n\tvar sameRoot = true\r\n\tvar current = currentStack[0]\r\n\tvar candidate = candidateStack[0]\r\n\r\n\twhile ( current || candidate ) {\r\n\t\tif (sameRoot && current && candidate) {\r\n\t\t\tif (current.Screen === candidate.Screen) {\r\n\t\t\t\tnextStack.push( mergeItems( current, candidate, routeData ) )\r\n\t\t\t\tif( current.path !== candidate.path ){\r\n\t\t\t\t\t// If the paths are not the same, some parameter might have changed\r\n\t\t\t\t\t// discard the rest of the current stack. We already have reused the id\r\n\t\t\t\t\tsameRoot = false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tsameRoot = false;\r\n\t\t\t\tnextStack.push( candidate )\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (sameRoot && current) {\r\n\t\t\tnextStack.push( current );\r\n\t\t}\r\n\t\telse if (candidate) {\r\n\t\t\tnextStack.push( candidate )\r\n\t\t}\r\n\t\t// else if( current ) do nothing because is not the same root\r\n\r\n\t\ti++;\r\n\t\tcurrent = currentStack[i]\r\n\t\tcandidate = candidateStack[i]\r\n\t}\r\n\r\n\treturn {\r\n\t\tstack: nextStack,\r\n\t\tindex: candidateStack.length - 1\r\n\t}\r\n}\r\n\r\nfunction mergeItems( current, candidate, routeData ){\r\n\tvar item = {\r\n\t\t...candidate, key: current.key,\r\n\t}\r\n\r\n\tif( item.tabs ){\r\n\t\t// Merge tab stack\r\n\t\tlet tabStack = [];\r\n\t\tlet activeIndex = item.tabs.activeIndex\r\n\r\n\t\t// Preserve current tab data, except for the active one\r\n\t\tcurrent.tabs.stack.forEach( (item, i) => {\r\n\t\t\ttabStack.push(\r\n\t\t\t\ti === activeIndex ? candidate.tabs.stack[i] : item\r\n\t\t\t)\r\n\r\n\t\t\ttabStack[i].key = item.key\r\n\t\t\t// set the parameter visited\r\n\t\t\ttabStack[i].visited = item.visited || i === activeIndex\r\n\t\t})\r\n\r\n\t\t// Refresh the tabs\r\n\t\titem.tabs = {\r\n\t\t\tstack: tabStack,\r\n\t\t\tactiveIndex\r\n\t\t}\r\n\t}\r\n\r\n\treturn item;\r\n}\r\n\r\n/**\r\n * Transform the route definition for urlhub to an object where the keys are the absolute\r\n * path of every route, this way we don't need to navigate through childrens to get\r\n * the information of a router given its path.\r\n * \r\n * @param {*} routes The route object for urlhub\r\n * @param {*} parentRoute The path of the parent route to get the absolute path of children\r\n */\r\nfunction getRouteData( routes, parentRoute = '' ){\r\n\tvar h = {}\r\n\r\n\troutes.forEach( r => {\r\n\t\tvar route = parentRoute + r.path;\r\n\t\th[route] = r;\r\n\t\tif( r.children ){\r\n\t\t\tvar childrenData = getRouteData( r.children, route );\r\n\t\t\th = { ...h, ...childrenData }\r\n\t\t}\r\n\t})\r\n\r\n\treturn h\r\n}\r\n\r\n/**\r\n * Generate a random key to identify a route\r\n */\r\nfunction generateKey() {\r\n\tvar number = Math.floor( Math.random() * 100000 )\r\n\t// Make sure it starts with a varter - j is first varter of my name :)\r\n\treturn 'j' + number.toString(36);\r\n}\r\n\r\nfunction findTab( route, stack ){\r\n\tlet i = stack.length;\r\n\twhile( i-- ){\r\n\t\tif( stack[i].route === route ){\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\r\n\t// By default we show the first tab\r\n\treturn 0;\r\n}\r\n","export function memoize( fn ){\r\n\tvar args, value;\r\n\r\n\tfunction recalculate( fnArgs ){\r\n\t\targs = fnArgs\r\n\t\tvalue = fn.apply( null, fnArgs )\r\n\t\treturn value;\r\n\t}\r\n\r\n\treturn function memoized(){\r\n\t\tif( !args || args.length !== arguments.length ){\r\n\t\t\treturn recalculate( arguments )\r\n\t\t}\r\n\r\n\t\tlet i = 0;\r\n\t\twhile( i < args.length ){\r\n\t\t\tif( args[i] !== arguments[i] ){\r\n\t\t\t\treturn recalculate( arguments )\r\n\t\t\t}\r\n\t\t\ti++\r\n\t\t}\r\n\r\n\t\treturn value\r\n\t}\r\n}\r\n\r\nexport function createId(){\r\n  return Math.round( Math.random() * 10000000 ).toString(36);\r\n}\r\n\r\nexport function nofn(){}\r\n\r\nexport function bind( that, methods ){\r\n\tmethods.forEach( m => {\r\n\t\tthat[m] = that[m].bind(that)\r\n\t})\r\n}\r\n","import { Easing } from 'react-native'\r\n\r\nexport default {\r\n\tstyles: function tabDefaultTransition( indexes, layout ) {\r\n\t\tlet scroll = layout.width / 2\r\n\t\treturn {\r\n\t\t\ttranslateX: {\r\n\t\t\t\tinputRange: [-2, -1, 0, 1, 2],\r\n\t\t\t\toutputRange: [scroll, scroll, 0, -scroll, -scroll]\r\n\t\t\t},\r\n\t\t\topacity: {\r\n\t\t\t\tinputRange: [-2, -1, 0, .8, 1],\r\n\t\t\t\toutputRange: [0, 0, 1, 0, 0]\r\n\t\t\t},\r\n\t\t}\r\n\t},\r\n\teasing: Easing.linear,\r\n\tduration: 300\r\n}","import { Animated } from 'react-native';\r\n\r\nexport function animatedStyles( transition, indexes, layout ){\r\n\tlet styles = typeof transition.styles === 'function' ? transition.styles( indexes, layout ) : transition.styles;\r\n\tif( !styles ){\r\n\t\tstyles = {}\r\n\t}\r\n\r\n\tlet animatedStyles = {}\r\n\tlet transformStyles = []\r\n\r\n\tif( indexes.count ){\r\n\t\tanimatedStyles.zIndex = indexes.count - Math.abs(indexes.relative)\r\n\t}\r\n\r\n\tObject.keys( styles ).forEach( key => {\r\n\t\tlet value = styles[key];\r\n\r\n\t\tif( styleKeys[key] ){\r\n\t\t\tif( warnKeys[key] ){\r\n\t\t\t\tconsole.warn(`react-urlstack: It's possible in web, but react-native won't animate the property \"${key}\"`)\r\n\t\t\t}\r\n\t\t\tif( value && value.inputRange ){\r\n\t\t\t\tanimatedStyles[ key ] = indexes.transition.interpolate( value )\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tanimatedStyles[ key ] = value\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if( transformKeys[key] ){\r\n\t\t\t// Check values\r\n\t\t\tlet type = transformKeys[key];\r\n\t\t\tlet warned = false;\r\n\t\t\tif( value && value.outputRange ){\r\n\t\t\t\tstyles[key].outputRange.forEach( value =>{\r\n\t\t\t\t\tif( !warned && typeof value !== type ){\r\n\t\t\t\t\t\twarned = true;\r\n\t\t\t\t\t\tconsole.warn(`react-urlstack: Even if it works in web, react-native only accepts type \"${transformKeys[key]}\" for \"${key}\". Given \"${ value }\".`);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\ttransformStyles.push({\r\n\t\t\t\t\t[key]: indexes.transition.interpolate( value )\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\ttransformStyles.push({\r\n\t\t\t\t\t[key]: value\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconsole.warn(`react-urlstack: Unknown property to animate \"${key}\"`)\r\n\t\t}\r\n\t})\r\n\r\n\tif( transformStyles.length ){\r\n\t\tanimatedStyles.transform = transformStyles\r\n\t}\r\n\r\n\treturn animatedStyles\r\n}\r\n\r\n\r\nlet styleKeys = {};\r\nlet warnKeys = {};\r\n['left', 'right', 'top', 'bottom'].forEach( key => {\r\n\tstyleKeys[key] = 1;\r\n\twarnKeys[key] = 1;\r\n});\r\n['width', 'height', 'opacity', 'backgroundColor', 'borderRadius'].forEach( key => {\r\n\tstyleKeys[key] = 1 \r\n})\r\n\r\nlet n = 'number', s = 'string';\r\nlet transformKeys = {\r\n\tperspective: n,\r\n\trotate: s, rotateX: s, rotateY: s, rotateZ: s,\r\n\tscale: n, scaleX: n, scaleY: n,\r\n\ttranslateX: n, translateY: n,\r\n\tskeyX: s, skewY: s\r\n};\r\n\r\n\r\nexport function stagger( animatedValue, gap, times, styles ){\r\n\tlet follower = new Animated.Value( animatedValue._value );\r\n\tAnimated.timing( follower, {duration: 0, toValue: animatedValue} ).start();\r\n\t\r\n\tlet stagged = [ animatedStyles({styles}, {transition: follower}) ];\r\n\r\n\tfor( let i = 1; i < times; i++ ){\r\n\t\tlet stage = {};\r\n\t\tObject.keys( styles ).forEach( attr => {\r\n\t\t\tlet val = styles[attr];\r\n\t\t\tif( val && val.inputRange ){\r\n\t\t\t\tlet shifted = {\r\n\t\t\t\t\tinputRange: [],\r\n\t\t\t\t\toutputRange: val.outputRange\r\n\t\t\t\t}\r\n\t\t\t\tval.inputRange.forEach( inputValue => {\r\n\t\t\t\t\tshifted.inputRange.push( inputValue + (i * gap) )\r\n\t\t\t\t})\r\n\t\t\t\tstage[attr] = shifted;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tstage[attr] = val;\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tlet animated = animatedStyles({styles: stage}, {transition: follower});\r\n\t\tstagged.push( animated );\r\n\t}\r\n\r\n\treturn stagged;\r\n}","import React from 'react';\r\n\r\nconst Context = React.createContext();\r\n\r\nexport default Context;","import React, {Component} from 'react'\r\nimport { StyleSheet, Animated } from 'react-native'\r\nimport tabTransition from './defaultTransitions/tabTransition'\r\nimport {animatedStyles} from './utils/animatedStyles'\r\nimport Context from './utils/wrapperContext'\r\nimport {createId, nofn} from './utils/utils'\r\n\r\nexport default class ScreenWrapper extends Component {\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\r\n\t\tthis.id = createId()\r\n\r\n\t\tthis.setAnimatedLayout( props.indexes, props.layout )\r\n\t}\r\n\r\n\tstatic defaultProps ={\r\n\t\tonReady: nofn,\r\n\t\tonUnmount: nofn\r\n\t}\r\n\r\n\trender(){\r\n\t\tlet item = this.props.item\r\n\t\tlet containerStyles = [\r\n\t\t\tstyles.container,\r\n\t\t\tthis.animatedStyles\r\n\t\t]\r\n\t\tlet contextValue = {\r\n\t\t\ttransition: this.props.transition,\r\n\t\t\tindexes: this.props.indexes,\r\n\t\t\tid: item.key\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Animated.View style={ containerStyles } onLayout={ () => this.props.onReady( item.key ) }>\r\n\t\t\t\t<Context.Provider value={contextValue}>\r\n\t\t\t\t\t{ this.renderScreen() }\r\n\t\t\t\t</Context.Provider>\r\n\t\t\t</Animated.View>\r\n\t\t)\r\n\t}\r\n\r\n\trenderScreen(){\r\n\t\tlet { item, ScreenStack, router, transition, indexes, layout, drawer, breakPoint } = this.props;\r\n\t\tlet { Screen, location } = item;\r\n\r\n\t\tif( item.isTabs ){\r\n\t\t\treturn (\r\n\t\t\t\t<Screen router={router}\r\n\t\t\t\t\tlocation={location}\r\n\t\t\t\t\tindexes={indexes}\r\n\t\t\t\t\tlayout={layout}\r\n\t\t\t\t\tdrawer= { drawer }\r\n\t\t\t\t\tbreakPoint={ breakPoint } >\r\n\t\t\t\t\t<ScreenStack router={ router }\r\n\t\t\t\t\t\tisTabs={ true }\r\n\t\t\t\t\t\tscreenTransition={ transition.tabTransition || tabTransition }\r\n\t\t\t\t\t\tstack={ item.tabs.stack }\r\n\t\t\t\t\t\tindex={ item.tabs.activeIndex }\r\n\t\t\t\t\t\tparentIndexes={ indexes }\r\n\t\t\t\t\t\tlayout={ layout }\r\n\t\t\t\t\t\tbreakPoint={ breakPoint } />\r\n\t\t\t\t</Screen>\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Screen router={router}\r\n\t\t\t\tlocation={location}\r\n\t\t\t\tindexes={indexes}\r\n\t\t\t\tlayout={layout}\r\n\t\t\t\tdrawer= { drawer }\r\n\t\t\t\tbreakPoint={ breakPoint } />\r\n\t\t)\r\n\t}\r\n\t\r\n\tsetAnimatedLayout( indexes, layout ){\r\n\t\tlet transition = this.props.transition;\r\n\t\tthis.animatedStyles = transition ? animatedStyles( transition, indexes, layout ) : {};\r\n\t}\r\n\r\n\tcomponentWillReceiveProps( nextProps ){\r\n\t\tif( this.hasLayoutChanged( nextProps ) ){\r\n\t\t\tthis.setAnimatedLayout( nextProps.indexes, nextProps.layout );\r\n\t\t}\r\n\t}\r\n\r\n\thasLayoutChanged( nextProps ){\r\n\t\tif( !nextProps.indexes ) return;\r\n\t\t\r\n\t\tlet { width } = nextProps.layout;\r\n\t\tlet { screen, relative } = nextProps.indexes;\r\n\t\tlet { layout, indexes } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\twidth !== layout.width ||\r\n\t\t\tscreen !== indexes.screen ||\r\n\t\t\trelative !== indexes.relative ||\r\n\t\t\tthis.props.transition !== nextProps.transition\r\n\t\t)\r\n\t}\r\n\r\n\tcomponentWillUnmount(){\r\n\t\tthis.props.onUnmount( this.props.item.key )\r\n\t}\r\n}\r\n\r\nlet styles = StyleSheet.create({\r\n\tcontainer: {\r\n\t\toverflow: 'hidden',\r\n\t\tposition: 'absolute',\r\n\t\ttop: 0, left: 0, bottom: 0, right: 0,\r\n\t\tzIndex:10\r\n\t}\r\n})","import React, { Component } from 'react';\r\nimport { Animated, StyleSheet, Platform } from 'react-native';\r\nimport {animatedStyles} from './utils/animatedStyles';\r\nimport PropTypes from 'prop-types'\r\n\r\nconst isWeb = Platform.OS === 'web';\r\nconst defaultDuration = 500;\r\n\r\nexport default class TransitionElement extends Component {\r\n\tstatic propTypes = {\r\n\t\t/** The entering props and box */\r\n\t\tentering: PropTypes.object, // {props, box}\r\n\t\t/** The leaving props and box */\r\n\t\tleaving: PropTypes.object, // {props, box}\r\n\t\t/** The breakpoint width from the navigator */\r\n\t\tbreakPoint: PropTypes.number,\r\n\t\t/** Screen indexes involved in the transition. If no transitionState is given in the SharedElement props, these values will be used as start and end points for  */\r\n\t\tscreenIndexes: PropTypes.object // {entering, leaving}\r\n\t}\r\n\r\n\tconstructor( props ){\r\n\t\tsuper(props);\r\n\r\n\t\tthis.indexes = this.getIndexes();\r\n\t\tthis.animatedValue = new Animated.Value( this.indexes.leaving );\r\n\t\tthis.transition = this.getTransition();\r\n\t}\r\n\r\n\trender(){\r\n\t\t// If the styles returned false, we don't want the transition \r\n\t\tif( this.transition === false ){\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tlet transitionStyles = [\r\n\t\t\tstyles.container,\r\n\t\t\tthis.props.leaving.props.style,\r\n\t\t\tanimatedStyles( this.transition, {transition: this.animatedValue} )\r\n\t\t]\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<Animated.View style={ transitionStyles } pointerEvents=\"auto\">\r\n\t\t\t\t{ this.renderChildren() }\r\n\t\t\t</Animated.View>\r\n\t\t)\r\n\t}\r\n\r\n\trenderChildren(){\r\n\t\tlet props = this.props;\r\n\t\tlet customRenderer = props.leaving.props.transitionRender;\r\n\r\n\t\tif( customRenderer ){\r\n\t\t\treturn customRenderer({\r\n\t\t\t\tanimatedValue: this.animatedValue,\r\n\t\t\t\tbreakPoint: props.breakPoint,\r\n\t\t\t\tentering: props.entering,\r\n\t\t\t\tleaving: props.leaving\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\treturn props.leaving.props.children;\r\n\t}\r\n\r\n\tgetTransition(){\r\n\t\tlet transitionStyle = this.props.leaving.props.transition;\r\n\t\tlet defaultTransition = this.getDefaultTransition()\r\n\r\n\t\tlet transition\r\n\t\t\r\n\t\tif( typeof transitionStyle === 'function' ){\r\n\t\t\tlet props = this.props\r\n\t\t\ttransition = transitionStyle( {\r\n\t\t\t\tbreakPoint: props.breakPoint,\r\n\t\t\t\tentering: props.entering,\r\n\t\t\t\tleaving: props.leaving,\r\n\t\t\t\tdefaultTransition: { ...defaultTransition }\r\n\t\t\t})\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttransition = transitionStyle;\r\n\t\t}\r\n\r\n\t\tif( transition === false ){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\telse if( transition === undefined ){\r\n\t\t\treturn defaultTransition\r\n\t\t}\r\n\r\n\t\t// Let's fill the gaps in the transitions\r\n\t\tif( !transition.duration ){\r\n\t\t\ttransition.duration = defaultTransition.duration;\r\n\t\t}\r\n\t\t\r\n\t\tlet styles = transition.styles;\r\n\t\tlet defaultStyles = defaultTransition.styles;\r\n\r\n\t\tif( !styles ){\r\n\t\t\tstyles = {}\r\n\t\t\ttransition.style = styles\r\n\t\t}\r\n\r\n\t\tObject.keys(defaultStyles).forEach(key => {\r\n\t\t\tif (styles[key] === undefined) {\r\n\t\t\t\tstyles[key] = defaultStyles[key]\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn transition;\r\n\t}\r\n\r\n\tgetIndexes(){\r\n\t\treturn {\r\n\t\t\tentering: this.props.entering.props.transitionState || this.props.screenIndexes.entering,\r\n\t\t\tleaving: this.props.leaving.props.transitionState || this.props.screenIndexes.leaving,\r\n\t\t}\r\n\t}\r\n\r\n\t// The default transition is just a translation\r\n\tgetDefaultTransition(){\r\n\t\tlet {leaving, entering} = this.indexes;\r\n\t\tlet leavingBox = this.props.leaving.box;\r\n\t\tlet enteringBox = this.props.entering.box;\r\n\t\tlet leavingTransition = this.props.leavingTransition\r\n\r\n\t\treturn {\r\n\t\t\tstyles: {\r\n\t\t\t\twidth: this.getInterpolation( leaving, entering, leavingBox.width, enteringBox.width ),\r\n\t\t\t\theight: this.getInterpolation( leaving, entering, leavingBox.height, enteringBox.height ),\r\n\t\t\t\ttranslateX: this.getInterpolation( leaving, entering, leavingBox.x, enteringBox.x ),\r\n\t\t\t\ttranslateY: this.getInterpolation( leaving, entering, leavingBox.y, enteringBox.y ),\r\n\t\t\t},\r\n\t\t\tduration: (leavingTransition && leavingTransition.duration) || defaultDuration\r\n\t\t}\r\n\t}\r\n\r\n\tgetInterpolation( fromIndex, toIndex, fromValue, toValue ){\r\n\t\tif( fromValue === toValue ) return fromValue;\r\n\t\tlet inverted = fromIndex > toIndex;\r\n\t\treturn {\r\n\t\t\tinputRange: inverted ? [ toIndex, fromIndex ] : [ fromIndex, toIndex ],\r\n\t\t\toutputRange: inverted ? [ toValue, fromValue ] : [ fromValue, toValue ]\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount(){\r\n\t\tconsole.log( 'Mounted', this.props.entering.box, this.props.leaving.box );\r\n\r\n\t\tif( this.transition !== false ){\r\n\t\t\t// Start the animation\r\n\t\t\tAnimated.timing( this.animatedValue, {\r\n\t\t\t\ttoValue: this.indexes.entering,\r\n\t\t\t\tduration: this.transition.duration || defaultDuration,\r\n\t\t\t\t// useNativeDriver: !isWeb // Native driver is not animating width and height\r\n\t\t\t}).start( () => this.props.onTransitionEnd() );\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\nconst styles = StyleSheet.create({\r\n\tcontainer: { position: 'absolute', overflow: 'hidden', top: 0, left: 0 }\r\n})","import React, {Component} from 'react'\r\nimport TransitionElement from '../TransitionElement'\r\nimport {View, StyleSheet} from 'react-native'\r\nimport {createId} from './utils'\r\n\r\nconst Context = React.createContext('sharedElement');\r\n\r\n// We will be storing the mounted elements by routes\r\nlet mountedElements = {}\r\n\r\n// When a shared element is mounted it calls to this function\r\n// and we register it\r\nfunction register(instance, props ) {\r\n\tlet wrapper = props.wrapper.id\r\n\tif (!mountedElements[wrapper]) {\r\n\t\tmountedElements[wrapper] = []\r\n\t}\r\n\tmountedElements[wrapper].push(instance);\r\n}\r\n\r\n// When it's unmounted we delete the references to it\r\nfunction unregister(instance) {\r\n\tlet wrapper = instance.props.wrapper.id\r\n\tlet stack = mountedElements[ wrapper ]\r\n\tif( !stack ) return;\r\n\t\r\n\tif (stack) {\r\n\t\tlet i = stack.length\r\n\t\twhile (i-- > 0) {\r\n\t\t\tif (stack[i] === instance) {\r\n\t\t\t\tstack.splice(i, 1); \r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// Layers registered callback to listen to transitions\r\nlet clbks = []\r\n\r\n// Here we will be store the current breakPoint and screenIndexes when\r\n// the shared elements are measured\r\nlet breakPoint, screenIndexes;\r\n\r\n// Needs to force all the shared element to measure themselves in order to get\r\n// the rights coords to start the shared element transitions\r\n// This is called by the ScreenStack when the transition has just been required\r\nfunction reMeasure( layout, bp, indexes ){\r\n\tlet screens = Object.keys( mountedElements );\r\n\tif( screens.length < 2 ) return;\r\n\r\n\tbreakPoint = bp\r\n\tscreenIndexes = indexes\r\n\r\n\tlet offset = { x: layout.x, y: layout.y };\r\n\tscreens.forEach( key => {\r\n\t\tmountedElements[key].forEach( el => {\r\n\t\t\tel.measure( offset );\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// This method is called just before starting the screen transition when the URL changes\r\n// Screen stack is the one responsible of calling it through the context\r\nfunction startTransition( leavingKeys, enteringKeys, toIndex, leavingTransition ){\r\n\tclbks.forEach( clbk => clbk( leavingKeys, enteringKeys, toIndex, leavingTransition ) )\r\n}\r\n\r\nclass TransitionLayer extends Component {\r\n\tconstructor( props ){\r\n\t\tsuper( props )\r\n\t\tthis.state = {\r\n\t\t\telements: []\r\n\t\t}\r\n\t\tthis.checkForTransitions = this.checkForTransitions.bind(this);\r\n\t}\r\n\r\n\trender(){\r\n\t\tlet layout = this.props.layout;\r\n\t\tlet box = {\r\n\t\t\ttop: layout.y || 0,\r\n\t\t\tright: (layout.x || 0) + layout.width,\r\n\t\t\tleft: layout.x || 0,\r\n\t\t\tbottom: (layout.y || 0) + layout.height\r\n\t\t}\r\n\r\n\t\tlet elements = this.state.elements;\r\n\t\tlet list = Object.keys( elements ).map( id => elements[id] );\r\n\r\n\t\tif( list.length > 0 ){\r\n\t\t\tconsole.log( 'couples found, rendering', list.length )\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<View style={ [styles.container, box] } pointerEvents=\"none\">\r\n\t\t\t\t{ list }\r\n\t\t\t</View>\r\n\t\t)\r\n\t}\r\n\r\n\tcheckForTransitions(enteringKeys, leavingKeys, toIndex, leavingTransition) {\r\n\t\tlet couples = this.getTransitionCouples( enteringKeys, leavingKeys )\r\n\r\n\t\tif (!couples.length) return;\r\n\r\n\t\tthis.leavingTransition = leavingTransition;\r\n\r\n\t\tthis.waitForReadyAndRender( couples, toIndex );\r\n\t}\r\n\r\n\twaitForReadyAndRender( couples, toIndex ){\r\n\t\t// Check if the boxes are already calculated\r\n\t\tlet i = couples.length;\r\n\t\twhile( i-- > 0 ){\r\n\t\t\tif( !couples[i].leaving.box || !couples[i].entering.box ){\r\n\t\t\t\t// oops! retry\r\n\t\t\t\treturn setTimeout( () => this.waitForReadyAndRender( couples, toIndex ) );\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tlet elements = {}\r\n\t\tcouples.forEach( couple => {\r\n\t\t\tlet id = createId()\r\n\t\t\t// console.log( `from ${JSON.stringify(couple.leaving.box)} to ${JSON.stringify(couple.entering.box)}` )\r\n\t\t\telements[ id ] = this.renderElement( couple, id )\r\n\t\t});\r\n\r\n\t\tthis.setState({elements})\r\n\t}\r\n\r\n\trenderElement( {leaving, entering}, id ){\r\n\t\treturn (\r\n\t\t\t<TransitionElement key={ id }\r\n\t\t\t\tleaving={ leaving }\r\n\t\t\t\tentering={ entering }\r\n\t\t\t\tbreakPoint={ breakPoint }\r\n\t\t\t\tscreenIndexes={ screenIndexes }\r\n\t\t\t\tleavingTransition={ this.leavingTransition && this.leavingTransition( breakPoint ) }\r\n\t\t\t\tonTransitionEnd={ () => this.removeElement(id) } />\r\n\t\t)\r\n\t}\r\n\r\n\tremoveElement( id ){\r\n\t\tlet elements = { ...this.state.elements }\r\n\t\tdelete elements[id]\r\n\t\tthis.setState({elements})\r\n\t}\r\n\r\n\tcleanProps( props ){\r\n\t\tlet clean = {};\r\n\r\n\t\tObject.keys( props ).forEach( p => {\r\n\t\t\tif( p !== 'se' && p !== 'wrapper' && p !== 'children' && p !== 'transitionStyles' ) {\r\n\t\t\t\tclean[ p ] = props[p]\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn clean;\r\n\t}\r\n\t\r\n\tgetTransitionCouples( fromIds, toIds ){\r\n\t\tlet leaving = {};\r\n\t\tlet couples = [];\r\n\r\n\t\tfromIds.forEach( id => {\r\n\t\t\tmountedElements[id] && mountedElements[id].forEach( el => {\r\n\t\t\t\tleaving[ el.props.sharedId ] = el;\r\n\t\t\t})\r\n\t\t})\r\n\r\n\t\ttoIds.forEach( id => {\r\n\t\t\tmountedElements[id] && mountedElements[id].forEach( el => {\r\n\t\t\t\tif ( leaving[el.props.sharedId] ){\r\n\t\t\t\t\tcouples.push({\r\n\t\t\t\t\t\tleaving: leaving[ el.props.sharedId ],\r\n\t\t\t\t\t\tentering: el\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\r\n\t\treturn couples;\r\n\t}\r\n\r\n\tcomponentDidMount(){\r\n\t\t// Start listening to transitions\r\n\t\tclbks.push( this.checkForTransitions );\r\n\t}\r\n\r\n\tcomponentWillUnmount(){\r\n\t\tlet i = clbks.length;\r\n\t\twhile( i-- > 0 ){\r\n\t\t\tif( clbks[i] === this.checkForTransitions ){\r\n\t\t\t\t// Remove the callback\r\n\t\t\t\tclbks.splice( i , 1 );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n\tcontainer: {\r\n\t\tposition: 'absolute',\r\n\t\tzIndex: 10000\r\n\t}\r\n})\r\n\r\nconst SharedElementWrapper = props => (\r\n\t<Context.Provider value={{ register, unregister, startTransition, reMeasure }}>\r\n\t\t{ props.children }\r\n\t\t<TransitionLayer router={ props.router } layout={ props.layout } />\r\n\t</Context.Provider>\r\n);\r\n\r\nexport {\r\n\tContext,\r\n\tSharedElementWrapper\r\n}","import React, {Component} from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport {Animated, View, StyleSheet, Platform} from 'react-native'\r\nimport {memoize, bind} from './utils/utils'\r\nimport ScreenWrapper from './ScreenWrapper'\r\nimport {animatedStyles} from './utils/animatedStyles'\r\nimport {Context} from './utils/sharedElementContext'\r\n\r\nconst isWeb = Platform.OS === 'web'\r\n\r\nexport default class ScreenStack extends Component {\r\n\tstatic propTypes = {\r\n\t\trouter: PropTypes.object,\r\n\t\tscreenTransition: PropTypes.object,\r\n\t\tstackTransition: PropTypes.object,\r\n\t\tstackIndexes: PropTypes.object,\r\n\t\tstack: PropTypes.array,\r\n\t\tindex: PropTypes.number,\r\n\t\tlayout: PropTypes.object\r\n\t}\r\n\r\n\tstatic defaultProps = {\r\n\t\tstackTransition: {},\r\n\t\tstackIndexes: {} \r\n\t}\r\n\r\n\tstatic contextType = Context;\r\n\r\n\tconstructor( props ){\r\n\t\tsuper( props );\r\n\t\t\r\n\t\tlet { stack, index } = props\r\n\r\n\t\tthis.state = {\r\n\t\t\tindexes: this.calculateIndexes({}, stack, index ),\r\n\t\t\tlayout: false\r\n\t\t}\r\n\r\n\t\tthis.previousIndex = index;\r\n\t\tthis.previousScreen = stack[index].key;\r\n\r\n\t\t// memoize a couple of methods\r\n\t\tthis.calculateIndexes = memoize( this.calculateIndexes.bind( this ) )\r\n\t\tthis.updateRelativeIndexes = memoize( this.updateRelativeIndexes.bind( this ) )\r\n\r\n\t\t// Track the screens that are ready for transitions\r\n\t\t// the one who have already a layout\r\n\t\tthis.readyScreens = {}\r\n\r\n\t\tbind( this, ['_onScreenReady', '_onScreenUnmount'] );\r\n\t}\r\n\r\n\trender(){\r\n\t\tlet { stack, router } = this.props\r\n\t\tlet containerStyles = [\r\n\t\t\tstyles.container,\r\n\t\t\tthis.animatedStyles\r\n\t\t]\r\n\r\n\t\treturn (\r\n\t\t\t<Animated.View style={containerStyles}>\r\n\t\t\t\t<View style={styles.stack} onLayout={ e => this.updateLayout(e) }>\r\n\t\t\t\t\t{ this.renderScreens(router, stack) }\r\n\t\t\t\t</View>\r\n\t\t\t</Animated.View>\r\n\t\t)\r\n\t}\r\n\t\r\n\trenderScreens( router, stack ){\r\n\t\tlet { layout, indexes } = this.state\r\n\t\t\r\n\t\t// Wait for the layout to be drawn\r\n\t\tif( !layout ) return;\r\n\r\n\t\tlet screens = [];\r\n\t\tstack.forEach( item => {\r\n\t\t\tlet key = item.key;\r\n\r\n\t\t\tif( !indexes[key] ) {\r\n\t\t\t\t// We are probably rebuilding indexes after navigating\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tscreens.push(\r\n\t\t\t\t<ScreenWrapper item={ item }\r\n\t\t\t\t\tScreenStack={ ScreenStack }\r\n\t\t\t\t\trouter={ router }\r\n\t\t\t\t\tindexes={ indexes[ key ] }\r\n\t\t\t\t\tlayout={ layout }\r\n\t\t\t\t\ttransition={ this.getScreenTransition( item.Screen ) }\r\n\t\t\t\t\tonReady={ this._onScreenReady }\r\n\t\t\t\t\tonUnmount={ this._onScreenUnmount }\r\n\t\t\t\t\tdrawer={ this.props.drawer }\r\n\t\t\t\t\tbreakPoint={ this.props.breakPoint }\r\n\t\t\t\t\tkey={ key } />\r\n\t\t\t)\r\n\t\t})\r\n\t\treturn screens;\r\n\t}\r\n\r\n\tgetScreenTransition( Screen ){\r\n\t\tif( typeof Screen.getTransition === 'function' ){\r\n\t\t\tlet transition = Screen.getTransition( this.props.breakPoint );\r\n\t\t\tif( transition === false ) return;\r\n\t\t\tif( transition ) return transition;\r\n\t\t}\r\n\r\n\t\treturn this.props.screenTransition;\r\n\t}\r\n\r\n\tupdateLayout( e ){\r\n\t\tthis.setState({ layout: e.nativeEvent.layout });\r\n\t\tthis.animatedStyles = animatedStyles(this.props.stackTransition, this.props.stackIndexes, e.nativeEvent.layout )\r\n\t}\r\n\r\n\tcomponentDidUpdate() {\r\n\t\tlet { stack, index, screenTransition } = this.props\r\n\t\tlet indexes = this.calculateIndexes( this.state.indexes, stack, this.previousIndex, screenTransition )\r\n\r\n\t\t// Check if the indexes has changed\r\n\t\tif( indexes !== this.state.indexes ){\r\n\t\t\tthis.setState( { indexes } );\r\n\t\t}\r\n\t\t\r\n\t\t// If the flag needRelativeUpdate is up, we need to update the relative\r\n\t\t// indexes to start the animations\r\n\t\tif (this.needRelativeUpdate) {\r\n\t\t\t\r\n\t\t\t// All the shared elements have been mounted, measure them ASAP\r\n\t\t\tthis.context.reMeasure(\r\n\t\t\t\tthis.props.layout,\r\n\t\t\t\tthis.props.breakPoint,\r\n\t\t\t\tthis.transitionIndexes\r\n\t\t\t);\r\n\r\n\t\t\t// Unset the transitionIndexes now\r\n\t\t\tthis.transitionIndexes = false;\r\n\r\n\t\t\t// Calculate next indexes\r\n\t\t\tlet nextIndexes = this.updateRelativeIndexes(indexes, stack, index);\r\n\r\n\t\t\t// At the next tick we can update the indexes and start the animations\r\n\t\t\tsetTimeout( () => {\r\n\t\t\t\tthis.needRelativeUpdate = false;\r\n\t\t\t\tthis.startTransition( this.state.indexes, nextIndexes );\r\n\t\t\t\tthis.setState({ indexes: nextIndexes })\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t// If the pointer to the current screen has changed we need to start\r\n\t\t// the animations at the next tick, so raise the flag needRelativeUpdate\r\n\t\tif( index !== this.previousIndex || stack[index].key !== this.previousScreen ){\r\n\t\t\tthis.transitionIndexes = {\r\n\t\t\t\tleaving: this.previousIndex,\r\n\t\t\t\tentering: index\r\n\t\t\t}\r\n\t\t\tthis.needRelativeUpdate = true;\r\n\t\t\tthis.previousIndex = index;\r\n\t\t\tthis.previousScreen = stack[index].key;\r\n\t\t\tthis.forceUpdate();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate new indexes based on the previous one and the stack.\r\n\t * If there are no changes in the indexes, returns oldIndexes.\r\n\t */\r\n\tcalculateIndexes( oldIndexes, stack, activeIndex ){\r\n\t\tlet count = stack.length\r\n\t\tlet indexes = { ...oldIndexes }\r\n\t\tlet unusedIndexes = { ...oldIndexes }\r\n\t\tlet updated = false;\r\n\r\n\t\tstack.forEach( ({ key }, i) => {\r\n\t\t\tif( unusedIndexes[key] ){\r\n\t\t\t\treturn delete unusedIndexes[key]\r\n\t\t\t}\r\n\r\n\t\t\tupdated = true;\r\n\r\n\t\t\tindexes[ key ] = {\r\n\t\t\t\tscreen: i,\r\n\t\t\t\tcount: count,\r\n\t\t\t\trelative: activeIndex - i,\r\n\t\t\t\ttransition: new Animated.Value( activeIndex - i ),\r\n\t\t\t\tparent: this.props.parentIndexes\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t// Delete tranistions not used\r\n\t\tObject.keys( unusedIndexes ).forEach( key => {\r\n\t\t\tdelete indexes[key]\r\n\t\t\tupdated = true;\r\n\t\t})\r\n\r\n\t\treturn updated ? indexes : oldIndexes\r\n\t}\r\n\t\r\n\t/**\r\n\t * Updates the relative index and the transitions.\r\n\t * Needs to be called when the activeIndex changes.\r\n\t */\r\n\tupdateRelativeIndexes( oldIndexes, stack, activeIndex ){\r\n\t\tlet indexes =  { ...oldIndexes }\r\n\t\tlet count = stack.length\r\n\r\n\t\tstack.forEach( ({key}, i) => {\r\n\t\t\tlet index = {\r\n\t\t\t\tscreen: i,\r\n\t\t\t\tcount: count,\r\n\t\t\t\trelative: activeIndex - i,\r\n\t\t\t\ttransition: indexes[key].transition,\r\n\t\t\t\tparent: this.props.parentIndexes\r\n\t\t\t}\r\n\r\n\t\t\tindexes[key] = index;\r\n\t\t})\r\n\r\n\t\treturn indexes;\r\n\t}\r\n\r\n\tstartTransition( prevIndexes, nextIndexes ){\r\n\t\tlet prevItem, nextItem, toIndex;\r\n\r\n\t\t// Screen transitions\r\n\t\tthis.props.stack.forEach( item  => {\r\n\t\t\tlet { key, Screen } = item;\r\n\r\n\t\t\tlet prevIndex = prevIndexes[key];\r\n\t\t\tlet nextIndex = nextIndexes[key];\r\n\r\n\t\t\tif( prevIndex.relative === 0 ){\r\n\t\t\t\tprevItem = item;\r\n\t\t\t}\r\n\t\t\tif( nextIndex.relative === 0 ){\r\n\t\t\t\tnextItem = item;\r\n\t\t\t\ttoIndex = prevIndex.relative;\r\n\t\t\t}\r\n\r\n\t\t\tif( prevIndex && nextIndex && prevIndex.relative !== nextIndex.relative) {\r\n\t\t\t\tlet transition = this.getScreenTransition( Screen );\r\n\t\t\t\tAnimated.timing( nextIndex.transition, {\r\n\t\t\t\t\ttoValue: nextIndex.relative,\r\n\t\t\t\t\teasing: transition.easing,\r\n\t\t\t\t\tduration: transition.duration || 300,\r\n\t\t\t\t\tuseNativeDriver: !isWeb,\r\n\t\t\t\t}).start()\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t// Signal for shared elements transition to start\r\n\t\tif (prevItem && nextItem) {\r\n\t\t\tthis.context.startTransition(\r\n\t\t\t\tthis.getActiveScreens(prevItem),\r\n\t\t\t\tthis.getActiveScreens(nextItem),\r\n\t\t\t\ttoIndex,\r\n\t\t\t\tprevItem.Screen.getTransition\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tgetActiveScreens( item ){\r\n\t\tlet keys = [item.key]\r\n\t\tlet tabs = item.tabs\r\n\r\n\t\tif( tabs ){\r\n\t\t\tkeys = keys.concat(\r\n\t\t\t\tthis.getActiveScreens( tabs.stack[tabs.activeIndex] )\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\treturn keys;\r\n\t}\r\n\r\n\t_onScreenReady( id ){\r\n\t\tthis.readyScreens[ id ] = 1;\r\n\t}\r\n\r\n\t_onScreenUnmount( id ){\r\n\t\tdelete this.readyScreens[id];\r\n\t}\r\n}\r\n\r\nlet styles = StyleSheet.create({\r\n\tcontainer: {\r\n\t\tflex: 1,\r\n\t\tposition: 'relative',\r\n\t\tzIndex: 1\r\n\t},\r\n\tdrawer: {},\r\n\tstack: {\r\n\t\theight: '100%', width: '100%'\r\n\t}\r\n})","import React, {Component} from 'react'\r\nimport { StyleSheet, Animated, View, Text } from 'react-native'\r\nimport {animatedStyles} from './utils/animatedStyles'\r\n\r\n\r\nexport default class ModalWrapper extends Component {\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tthis.setAnimatedLayout( props.indexes, props.layout )\r\n\t}\r\n\r\n\trender(){\r\n\t\tlet containerStyles = [\r\n\t\t\tstyles.container,\r\n\t\t\tthis.animatedStyles\r\n\t\t]\r\n\r\n\t\tlet item = this.props.stack[0];\r\n\t\tlet content = item ? <item.Screen /> : <View></View>;\r\n\r\n\t\treturn (\r\n\t\t\t<Animated.View style={ containerStyles }>\r\n\t\t\t\t{ content }\r\n\t\t\t</Animated.View>\r\n\t\t)\r\n\t}\r\n\r\n\tgetScreenItem( item ){\r\n\t\tif( item && item !== this.item ){\r\n\t\t\tthis.item = item;\r\n\t\t}\r\n\t\treturn this.item;\r\n\t}\r\n\t\r\n\tsetAnimatedLayout( indexes, layout ){\r\n\t\tthis.animatedStyles = animatedStyles( this.props.transition, indexes, layout )\r\n\t}\r\n\r\n\tcomponentWillReceiveProps( nextProps ){\r\n\t\tif( this.hasLayoutChanged( nextProps ) ){\r\n\t\t\tthis.setAnimatedLayout( nextProps.indexes, nextProps.layout );\r\n\t\t}\r\n\t}\r\n\r\n\thasLayoutChanged( nextProps ){\r\n\t\tif( !nextProps.indexes ) return;\r\n\t\t\r\n\t\tlet { width } = nextProps.layout;\r\n\t\tlet { showing } = nextProps.indexes;\r\n\t\tlet { layout, indexes } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\twidth !== layout.width ||\r\n\t\t\tshowing !== indexes.showing\r\n\t\t)\r\n\t}\r\n}\r\n\r\nlet styles = StyleSheet.create({\r\n\tcontainer: {\r\n\t\toverflow: 'hidden',\r\n\t\tposition: 'absolute',\r\n\t\twidth: '100%', height: '100%',\r\n\t\ttop: 0, left: 0,\r\n\t\tzIndex:10,\r\n\t\tshadowColor: '#000',\r\n\t\tshadowOpacity: .1,\r\n\t\tshadowRadius: 10,\r\n\t\televation: 3\r\n\t}\r\n})","import React, {Component} from 'react'\r\nimport { StyleSheet, Animated, View } from 'react-native'\r\nimport {animatedStyles} from './utils/animatedStyles'\r\nimport Interactable from 'react-interactable'\r\n\r\nlet handleWidth = 30\r\n\r\nexport default class DrawerWrapper extends Component {\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tthis.drawerWidth = 300;\r\n\r\n\t\tthis.drawerPos = new Animated.Value(0);\r\n\t\tthis.calculateDrawerIndex();\r\n\t\r\n\t\tthis.state = {\r\n\t\t\topen: false\r\n\t\t}\r\n\r\n\t\tthis.overlayAnimStyle = {\r\n\t\t\ttransform: [{translateX: this.drawerIndex.interpolate({\r\n\t\t\t\tinputRange: [0, 0.01, 1],\r\n\t\t\t\toutputRange: [ -10000, 0, 0]\r\n\t\t\t})}],\r\n\t\t\topacity: this.drawerIndex.interpolate({\r\n\t\t\t\tinputRange: [0,0,1,1],\r\n\t\t\t\toutputRange: [0,0,.5,.5]\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tconst drawerMethods = {\r\n\t\t\topen: () => this.openDrawer(),\r\n\t\t\tclose: () => this.closeDrawer()\r\n\t\t}\r\n\t\tthis._drawerMethods = drawerMethods\r\n\t}\r\n\r\n\trender(){\r\n\t\tlet { Drawer, router, collapsible } = this.props\r\n\t\tlet handle, overlay\r\n\t\tif( collapsible ){\r\n\t\t\thandle = <View style={ styles.handle } />\r\n\t\t\toverlay = (\r\n\t\t\t<Animated.View style={ [styles.overlay, this.overlayAnimStyle] }\r\n\t\t\t\tonClick={ () => this.closeDrawer() }>\r\n\t\t\t</Animated.View>\r\n\t\t\t)\r\n\t\t}\r\n\t\tlet width = this.state.open ? this.drawerWidth * 2 : this.drawerWidth + handleWidth;\r\n\r\n\t\tlet containerStyles = [\r\n\t\t\tstyles.container,\r\n\t\t\tcollapsible && styles.collapsibleContainer,\r\n\t\t\tcollapsible && {width, left: handleWidth - this.drawerWidth},\r\n\t\t\tthis.animatedStyles\r\n\t\t]\r\n\r\n\t\tlet drawerStyles = [\r\n\t\t\tstyles.drawer,\r\n\t\t\tcollapsible && styles.collapsibleDrawer\r\n\t\t]\r\n\r\n\t\tlet snapPoints = [\r\n\t\t\t{ x: 0, id: 'closed' }, {x: this.drawerWidth - handleWidth - 10, id: 'open'}\r\n\t\t];\r\n\r\n\t\treturn (\r\n\t\t\t<Animated.View style={ containerStyles }>\r\n\t\t\t\t{ overlay }\r\n\t\t\t\t<Interactable.View dragEnabled={ !!collapsible }\r\n\t\t\t\t\tref=\"drawer\"\r\n\t\t\t\t\thorizontalOnly={ true } snapPoints={ snapPoints }\r\n\t\t\t\t\tboundaries={{right: this.drawerWidth - handleWidth, bounce: 0}}\r\n\t\t\t\t\tonDrag={ e => this.onDrag( e ) }\r\n\t\t\t\t\tanimatedValueX={ this.drawerPos }>\r\n\t\t\t\t\t<View style={ drawerStyles } ref=\"layout\" onLayout={ e => this.updateLayout(e) }>\r\n\t\t\t\t\t\t<Drawer router={ router } drawer={ this._drawerMethods } />\r\n\t\t\t\t\t\t{ handle }\r\n\t\t\t\t\t</View>\r\n\t\t\t\t</Interactable.View>\r\n\t\t\t</Animated.View>\r\n\t\t)\r\n\t}\r\n\t\r\n\tupdateLayout( e ){\r\n\t\tlet {layout} = e.nativeEvent;\r\n\t\t\r\n\t\tthis.animatedStyles = animatedStyles(this.props.transition, this.props.indexes, layout );\r\n\t\tthis.drawerWidth = layout.width;\r\n\t\tthis.calculateDrawerIndex();\r\n\t\tthis.forceUpdate();\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps) {\r\n\t\tif( prevProps.collapsible !== this.props.collapsible ){\r\n\t\t\tthis.drawerPos.setValue(0);\r\n\t\t}\r\n\t\tif( prevProps.breakPoint !== this.props.breakPoint ){\r\n\t\t\tthis.refs.layout.measure( (dx, dy, width, height, x, y) => {\r\n\t\t\t\tthis.updateLayout({ nativeEvent: {layout: {width, height, x, y}}});\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tcalculateDrawerIndex(){\r\n\t\tlet di = this.drawerIndex;\r\n\t\tlet index = this.drawerPos.interpolate({\r\n\t\t\tinputRange: [0, this.drawerWidth ],\r\n\t\t\toutputRange: [0, 1]\r\n\t\t})\r\n\r\n\t\tif( di ){\r\n\t\t\tdi._config = index._config;\r\n\t\t\tdi._interpolation = index._interpolation;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.drawerIndex = index;\r\n\t\t}\r\n\t}\r\n\r\n\topenDrawer(){\r\n\t\tif( !this.props.collapsible || this.state.open ) return;\r\n\r\n\t\tlet drawer = this.refs.drawer\r\n\t\tthis.setState({open: true})\r\n\t\tdrawer && drawer.setVelocity({x: 2000})\r\n\t}\r\n\r\n\tcloseDrawer(){\r\n\t\tif( !this.props.collapsible || !this.state.open ) return;\r\n\r\n\t\tlet drawer = this.refs.drawer\r\n\t\tthis.setState({open: false})\r\n\t\tdrawer && drawer.setVelocity({x: -2000})\r\n\t}\r\n\r\n\tonDrag( e ){\r\n\t\tif( e.nativeEvent ) e = e.nativeEvent\r\n\t\t\r\n\t\tif( e.state === 'start' ){\r\n\t\t\tthis.setState({open: true})\r\n\t\t}\r\n\t\telse if( e.state === 'end' && e.targetSnapPointId === 'closed' ){\r\n\t\t\tthis.setState({open: false})\r\n\t\t}\r\n\t}\r\n}\r\n\r\nlet styles = StyleSheet.create({\r\n\tcontainer: {\r\n\t\tflexDirection: 'row'\r\n\t},\r\n\tcollapsibleContainer: {\r\n    position: 'absolute',\r\n\t\ttop: 0, bottom: 0,\r\n\t\tzIndex: 2000,\r\n\t},\r\n\tdrawer: {\r\n    // position: 'absolute',\r\n\t\ttop: 0, left: 0,\r\n\t\theight: '100%', width: '100%',\r\n\t\tflex: 1\r\n\t},\r\n\tcollapsibleDrawer: {\r\n    left: 0,\r\n    width: '100%',\r\n    flex: 1,\r\n\t\tposition: 'relative',\r\n\t\tzIndex: 20000,\r\n\t\tpaddingRight: handleWidth\r\n\t},\r\n\thandle: {\r\n\t\twidth: handleWidth,\r\n\t\ttop: 0, bottom: 0, right: 0,\r\n\t\t// backgroundColor: 'green',\r\n\t\tposition: 'absolute',\r\n\t\tzIndex: 10\r\n\t},\r\n\toverlay: {\r\n\t\tbackgroundColor: 'black',\r\n\t\theight: '100%',\r\n\t\twidth: '400%',\r\n\t\tposition: 'absolute'\r\n\t},\r\n\texpander: {\r\n\t\tposition: 'absolute',\r\n\t\theight: '100%',\r\n\t\ttop: 0, left: 0, bottom: 0\r\n\t}\r\n})","import { Easing } from 'react-native'\r\n\r\nexport default {\r\n\tstyles: function desktopMobileTransition( indexes, layout ){\r\n\t\tlet leftColumn = indexes.screen ? 400 : 0;\r\n\t\treturn {\r\n\t\t\twidth: {\r\n\t\t\t\tinputRange: [ -2, -1, 0, 1, 2, 3 ],\r\n\t\t\t\toutputRange: [ 0, 0, layout.width - leftColumn, 400, 0, 0]\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\ttranslateX: {\r\n\t\t\t\tinputRange: [ -2, -1, 0, 1, 2 ],\r\n\t\t\t\toutputRange: [ layout.width, layout.width, leftColumn, 0, 0]\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\teasing: Easing.linear,\r\n\tduration: 300,\r\n\r\n\t// different transitions for modals can be set here\r\n\t// modalTransition: { stack, drawer, modal}\r\n}","export default {\r\n\tstyles: function mobileDefaultTransition( indexes, layout ){\r\n\t\treturn {\r\n\t\t\ttranslateX: {\r\n\t\t\t\tinputRange: [ -2, -1, 0, 1 ],\r\n\t\t\t\toutputRange: [ layout.width, layout.width, 0, 0 ]\r\n\t\t\t},\r\n\t\t\topacity: {\r\n\t\t\t\tinputRange: [ -2, -1, 0, .8, 1 ],\r\n\t\t\t\toutputRange: [ 0, 1, 1, 0, 0]\r\n\t\t\t},\r\n\t\t\tscale: {\r\n\t\t\t\tinputRange: [ -1, 0, 1, 2 ],\r\n\t\t\t\toutputRange: [ 1, 1, .5, .5]\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tduration: 300,\r\n\tcollapsibleDrawer: true,\r\n\t\r\n\t// different transitions for modals can be set here\r\n\t// modalTransition: { stack, drawer, modal}\r\n\r\n\t// also transitions for tabs\r\n\t// tabTransition: {styles, duration, easing}\r\n}","import {Easing} from 'react-native'\r\n\r\nlet stackAndDrawer = {\r\n\tstyles: {\r\n\t\ttranslateY: {\r\n\t\t\tinputRange: [ 0, 1 ],\r\n\t\t\toutputRange: [ -100, 0 ]\r\n\t\t},\r\n\t\topacity: {\r\n\t\t\tinputRange: [ 0, 1 ],\r\n\t\t\toutputRange: [ 0, 1 ]\r\n\t\t}\r\n\t},\r\n\teasing: Easing.linear,\r\n\tduration: 300\r\n}\r\n\r\nexport default {\r\n\tstack: stackAndDrawer,\r\n\tdrawer: stackAndDrawer,\r\n\tmodal:{\r\n\t\tstyles: function modalDefaultTransition( indexes, layout ) {\r\n\t\t\treturn {\r\n\t\t\t\ttranslateY: {\r\n\t\t\t\t\tinputRange: [ 0, 1 ],\r\n\t\t\t\t\toutputRange: [ layout.height, 0 ]\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\teasing: Easing.linear,\r\n\t\tduration: 300\r\n\t}\r\n}","import React, {Component} from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport createRouter from 'urlstack'\r\nimport { Dimensions, View, StyleSheet, Animated, Platform, StatusBar, BackHandler } from 'react-native'\r\nimport ScreenStack from './ScreenStack'\r\nimport ModalWrapper from './ModalWrapper'\r\nimport DrawerWrapper from './DrawerWrapper'\r\nimport { SharedElementWrapper } from './utils/sharedElementContext'\r\nimport desktopTransition from './defaultTransitions/desktopTransition'\r\nimport mobileTransition from './defaultTransitions/mobileTransition'\r\nimport modalTransition from './defaultTransitions/modalTransition'\r\nimport {memoize} from './utils/utils'\r\n\r\nconst isWeb = Platform.OS === 'web'\r\n\r\nexport default class Navigator extends Component {\r\n\tconstructor( props ){\r\n\t\tsuper( props )\r\n\r\n\t\tthis.state = {\r\n\t\t\tlayout: this.getWindowSize()\r\n\t\t};\r\n\r\n\t\tthis.calculateTransition( props.transitions, this.state.layout.width )\r\n\r\n\t\tthis.getScreenStack = memoize( this.getScreenStack )\r\n\t\tthis._onBack = this._onBack.bind( this )\r\n\r\n\t\tthis.drawer = {\r\n\t\t\topen: () => this.drawerInstance.openDrawer(),\r\n\t\t\tclose: () => this.drawerInstance.closeDrawer(),\r\n\t\t}\r\n\r\n\t\tBackHandler.addEventListener( 'hardwareBackPress', this._onBack )\r\n\t}\r\n\r\n\tstatic propTypes = {\r\n\t\ttransitions: PropTypes.object,\r\n\t\tinterceptor: PropTypes.func\r\n\t}\r\n\r\n\tstatic defaultProps = {\r\n\t\ttransitions: {\r\n\t\t\t0: mobileTransition,\r\n\t\t\t800: desktopTransition\r\n\t\t}\r\n\t}\r\n\r\n\trender(){\r\n\t\tlet router = this.router;\r\n\t\tif( !router ) return null;\r\n\t\t\r\n\t\tlet { DrawerComponent, transitions } = this.props\r\n\t\tlet { layout, indexes } = this.state\r\n\t\t\r\n\t\tlet transition = this.currentTransition\r\n\t\tlet breakPoint = this.currentBreakpoint\r\n\t\tlet modalTransition = this.getModalTransitions( transition )\r\n\t\tlet { stack, index } = this.getScreenStack( router.stack, router.activeIndex )\r\n\r\n\t\treturn (\r\n\t\t\t<SharedElementWrapper router={router} layout={layout}>\r\n\t\t\t\t<View style={ styles.windowWrapper }>\r\n\t\t\t\t\t<View style={styles.container} onLayout={ e => this._onLayout( e.nativeEvent.layout ) }>\r\n\t\t\t\t\t\t<DrawerWrapper ref={ component => this.drawerInstance = component }\r\n\t\t\t\t\t\t\trouter={router}\r\n\t\t\t\t\t\t\ttransition={modalTransition.drawer}\r\n\t\t\t\t\t\t\tbreakPoint={ breakPoint }\r\n\t\t\t\t\t\t\tindexes={indexes.stack}\r\n\t\t\t\t\t\t\tcollapsible={ transition.collapsibleDrawer }\r\n\t\t\t\t\t\t\tDrawer={ DrawerComponent } />\r\n\t\t\t\t\t\t<ScreenStack router={router}\r\n\t\t\t\t\t\t\tscreenTransition={transition}\r\n\t\t\t\t\t\t\tstackTransition={modalTransition.stack}\r\n\t\t\t\t\t\t\tstackIndexes={indexes.stack}\r\n\t\t\t\t\t\t\tbreakPoint={ breakPoint }\r\n\t\t\t\t\t\t\tstack={stack}\r\n\t\t\t\t\t\t\tindex={index}\r\n\t\t\t\t\t\t\tlayout={layout}\r\n\t\t\t\t\t\t\tdrawer={this.drawer} />\r\n\t\t\t\t\t\t<ModalWrapper router={router}\r\n\t\t\t\t\t\t\tstack={router.modal.stack}\r\n\t\t\t\t\t\t\tindex={router.modal.stack}\r\n\t\t\t\t\t\t\ttransition={modalTransition.modal}\r\n\t\t\t\t\t\t\tbreakPoint={ breakPoint }\r\n\t\t\t\t\t\t\tindexes={indexes.modal}\r\n\t\t\t\t\t\t\tlayout={layout}\r\n\t\t\t\t\t\t\tdrawer={this.drawer} />\r\n\t\t\t\t\t</View>\r\n\t\t\t\t</View>\r\n\t\t\t</SharedElementWrapper>\r\n\t\t)\r\n\t}\r\n\r\n\tcalculateTransition( transitions, width ){\r\n\t\tlet breakPoints = Object.keys( transitions ).sort( (a,b) => a - b )\r\n\t\tlet i = breakPoints.length\r\n\t\t\r\n\t\twhile( i-- > 0 ){\r\n\t\t\tif( width >= parseInt( breakPoints[i]) ){\r\n\t\t\t\tthis.currentTransition = transitions[ breakPoints[i] ]\r\n\t\t\t\tthis.currentBreakpoint = parseInt(breakPoints[i]);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tthis.currentTransition = transitions[ breakPoints[0] ]\r\n\t\tthis.currentBreakpoint = parseInt(breakPoints[0]);\r\n\t}\r\n\r\n\tgetModalTransitions( transition ){\r\n\t\tlet t = transition || this.currentTransition;\r\n\t\treturn t.modalTransition || modalTransition\r\n\t}\r\n\r\n\t// Takes the modal screens out of the stack\r\n\tgetScreenStack( routerStack, routerIndex ){\r\n\t\tlet stack = routerStack.slice();\r\n\t\tlet index = routerIndex;\r\n\t\tlet lastIndex = routerStack.length - 1;\r\n\t\tlet last = stack[ lastIndex ]\r\n\t\tlet options = last.Screen.urlstackOptions || {}\r\n\r\n\t\tif( options.modal ){\r\n\t\t\tstack.pop()\r\n\t\t\tif( index === lastIndex ){\r\n\t\t\t\tindex--;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn {stack, index}\r\n\t}\r\n\r\n\tstartRouter(){\r\n\t\tlet router = createRouter( this.props.routes );\r\n\r\n\t\tlet interceptor = this.props.interceptor;\r\n\t\tif( interceptor ){\r\n\t\t\trouter.onBeforeChange( interceptor );\r\n\t\t}\r\n\r\n\t\tthis.fu = () => this.forceUpdate();\r\n\t\trouter.onChange( () => this.fu() );\r\n\t\trouter.start();\r\n\r\n\t\tthis.router = router;\r\n\r\n\t\tthis.showingModal = this.detectModal();\r\n\t\tthis.updateModalIndexes( this.showingModal );\r\n\t}\r\n\r\n\tgetWindowSize(){\r\n\t\tlet { width, height } = Dimensions.get('window')\r\n\t\treturn { \r\n\t\t\twidth, height, x: 0, y: 0\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.startRouter();\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tthis.fu = () => {}\r\n\t\tBackHandler.removeEventListener( 'hardwareBackPress', this._onBack )\r\n\t}\r\n\r\n\tcomponentDidUpdate( prevProps ){\r\n\t\tlet showModal = this.detectModal()\r\n\t\tif( this.showingModal !== showModal ){\r\n\t\t\tthis.showingModal = showModal;\r\n\t\t\tthis.updateModalIndexes( showModal );\r\n\t\t}\r\n\r\n\t\tif( prevProps.transistions !== this.props.transistions ){\r\n\t\t\tthis.calculateTransition( this.props.transitions, this.state.layout.width )\r\n\t\t}\r\n\t}\r\n\r\n\t_onLayout( layout ){\r\n\t\tconsole.log( layout )\r\n\t\tthis.calculateTransition( this.props.transitions, layout.width )\r\n\t\tthis.setState( {layout} )\r\n\t}\r\n\r\n\t_onBack(){\r\n\t\tlet router = this.router;\r\n\t\tlet stack = router.stack;\r\n\t\tlet nextRoute;\r\n\t\tif( router.modal.active ){\r\n\t\t\tif( router.modal.activeIndex ){\r\n\t\t\t\tnextRoute = router.modal.stack[ router.modal.activeIndex - 1 ].path\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnextRoute = stack[ router.activeIndex ].location\r\n\t\t\t\tnextRoute = nextRoute.pathname + nextRoute.search\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if( router.activeIndex ){\r\n\t\t\tnextRoute = stack[ router.activeIndex - 1 ].path\r\n\t\t}\r\n\r\n\t\tif( nextRoute ){\r\n\t\t\trouter.navigate( nextRoute )\r\n\t\t\treturn true; // Prevents getting out of the app\r\n\t\t}\r\n\t}\r\n\r\n\tdetectModal(){\r\n\t\treturn this.router.modal.active;\r\n\t}\r\n\r\n\tupdateModalIndexes( showModal ){\r\n\t\tlet {indexes} = this.state\r\n\r\n\t\tif( !indexes ){\r\n\t\t\tindexes = {\r\n\t\t\t\tmodal: {showing: !!showModal, transition: new Animated.Value( showModal ? 1 : 0) },\r\n\t\t\t\tstack: {showing: !showModal, transition: new Animated.Value( showModal ? 0 : 1) }\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet transitions = this.getModalTransitions()\r\n\r\n\t\t\tindexes = {\r\n\t\t\t\tmodal: {showing: !!showModal, transition: indexes.modal.transition },\r\n\t\t\t\tstack: {showing: !showModal, transition: indexes.stack.transition }\r\n\t\t\t}\r\n\r\n\t\t\tAnimated.timing( indexes.modal.transition, {\r\n\t\t\t\ttoValue: showModal ? 1 : 0,\r\n\t\t\t\teasing: transitions.modal.easing,\r\n\t\t\t\tduration: transitions.modal.duration || 300,\r\n\t\t\t\tuseNativeDriver: !isWeb\r\n\t\t\t}).start()\r\n\r\n\t\t\tAnimated.timing( indexes.stack.transition, {\r\n\t\t\t\ttoValue: showModal ? 0 : 1,\r\n\t\t\t\teasing: transitions.stack.easing,\r\n\t\t\t\tduration: transitions.stack.duration || 300,\r\n\t\t\t\tuseNativeDriver: !isWeb\r\n\t\t\t}).start()\r\n\t\t}\r\n\r\n\t\tthis.setState({indexes})\r\n\t}\r\n}\r\n\r\nlet statusBarHeight = Platform.OS === 'android' ? StatusBar.currentHeight : 0\r\nif( Platform.OS === 'web' ){\r\n\t// Hack to try styles with a status bar in the web\r\n\tstatusBarHeight = 20;\r\n}\r\n\r\nlet styles = StyleSheet.create({\r\n\twindowWrapper: {\r\n\t\tpaddingTop: statusBarHeight,\r\n\t\tflex: 1,\r\n\t},\r\n\r\n\tcontainer: {\r\n\t\tflex: 1,\r\n\t\tflexDirection: 'row',\r\n\t\toverflow: 'hidden'\r\n\t},\r\n})","import React, { Component } from 'react';\r\nimport { View, Platform } from 'react-native';\r\nimport { Context } from './utils/sharedElementContext';\r\nimport WrapperContext from './utils/wrapperContext';\r\nimport PropTypes from 'prop-types'\r\n\r\nconst isWeb = Platform.OS === 'web';\r\n\r\nclass SharedElement extends Component {\r\n\tstatic propTypes = {\r\n\t\t// These properties are used by the TransitionElement\r\n\t\ttransition: PropTypes.oneOf([ PropTypes.object, PropTypes.func ]),\r\n\t\ttransitionRender: PropTypes.func,\r\n\t\ttransitionState: PropTypes.number,\r\n\r\n\t\t// This sharedId is used by the sharedElementContext to match what components\r\n\t\t// need to be shared\r\n\t\tsharedId: PropTypes.string,\r\n\t}\r\n\r\n\tstatic defaultTypes = {\r\n\t\r\n\t}\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tprops.se.register( this, props );\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<View style={ this.props.style }\r\n\t\t\t\tref=\"el\"\r\n\t\t\t\tonLayout={ () => this._onLayout() }\r\n\t\t\t\tpointerEvents=\"auto\">\r\n\t\t\t\t{ this.props.children }\r\n\t\t\t</View>\r\n\t\t);\r\n\t}\r\n\t\r\n\tcomponentWillUnmount(){\r\n\t\tthis.props.se.unregister( this );\r\n\t}\r\n\r\n\tmeasure( offset ){\r\n\t\tthis.box = false;\r\n\r\n\t\tif( !isWeb && !this.layouted ){\r\n\t\t\t// We need the layout to calculate the measures properly in native\r\n\t\t\tconsole.log('skipping')\r\n\t\t\treturn setTimeout( () => this.measure( offset ) );\r\n\t\t}\r\n\t\t\r\n\t\tthis.refs.el && this.refs.el.measure( ( cx, cy, width, height, x, y ) => {\r\n\t\t\tthis.box = {\r\n\t\t\t\twidth, height,\r\n\t\t\t\tx: x - offset.x,\r\n\t\t\t\ty: y - offset.y\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tconsole.log('measured' );\r\n\t\t})\r\n\t}\r\n\r\n\t_onLayout(){\r\n\t\tthis.layouted = true;\r\n\t}\r\n}\r\n\r\nfunction ContextConsumerHOC( Component ){\r\n\treturn function SharedElementHOC( props ){\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<Context.Consumer>\r\n\t\t\t\t{ se => (\r\n\t\t\t\t\t<WrapperContext.Consumer>\r\n\t\t\t\t\t\t{ wrapper => (\r\n\t\t\t\t\t\t\t<Component {...props} se={se} wrapper={wrapper} />\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</WrapperContext.Consumer>\r\n\t\t\t\t)}\r\n\t\t\t</Context.Consumer>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nconst SharedElementWithContext = ContextConsumerHOC( SharedElement )\r\nexport default SharedElementWithContext\r\n"],"names":["parseUrl","window","url","a","document","createElement","href","urlhub","create","options","Urlhub","joinUrls","strategy","Error","s","ops","Object","keys","forEach","key","init","obc","cbs","prototype","setRoutes","routes","this","parseRoutes","parent","console","warn","length","parsedRoutes","me","r","path","params","parsed","regex","parser","id","cb","map","p","name","children","childRegex","end","push","match","location","candidates","isChild","found","c","i","sanitizeUrl","pathname","exec","matches","concat","matchIds","slice","error","search","query","qs","parse","hash","route","start","onChange","change","checkChange","next","current","replace","nextLocation","getLocation","stop","refresh","runOnBeforeChange","onBeforeChange","updateLocation","back","method","mergeLocations","module","one","two","first","second","sanitized","prev","assign","stringify","nodeStrategy","history","initialLocation","emit","str","parts","split","searchParts","pop","hashStrategy","onhashchange","protocol","host","pushStrategy","basePath","onpopstate","pushState","replaceState","l","basePathLength","router","callbacks","stackRouter","stack","activeIndex","_nestedStack","_lastNavigated","modal","active","handler","navigate","apply","arguments","createRouteChanger","routeData","getRouteData","nestedStack","createNestedStack","mergeStacks","index","setStacksAndIndexes","splitStack","clbk","inTab","data","tabs","findTab","item","createStackItem","isTabs","child","tabScreen","allStacks","currentStack","isModal","stacks","targetIndex","Math","max","min","bgRoute","backgroundRoute","Screen","getRoutePath","generateKey","routeParts","pathParts","routePath","join","candidateStack","nextStack","sameRoot","candidate","mergeItems","tabStack","visited","parentRoute","h","childrenData","floor","random","toString","memoize","fn","args","value","recalculate","fnArgs","createId","round","nofn","bind","that","methods","m","styles","indexes","layout","scroll","width","translateX","inputRange","outputRange","opacity","easing","Easing","linear","duration","animatedStyles","transition","transformStyles","count","zIndex","abs","relative","styleKeys","warnKeys","interpolate","transformKeys","type","warned","_typeof","transform","n","perspective","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","translateY","skeyX","skewY","stagger","animatedValue","gap","times","follower","Animated","Value","_value","timing","toValue","stagged","stage","attr","val","shifted","inputValue","animated","Context","React","createContext","ScreenWrapper","props","setAnimatedLayout","Component","containerStyles","container","contextValue","View","style","onLayout","_this2","onReady","Provider","renderScreen","ScreenStack","drawer","breakPoint","screenTransition","tabTransition","parentIndexes","nextProps","hasLayoutChanged","screen","onUnmount","StyleSheet","overflow","position","top","left","bottom","right","isWeb","Platform","OS","defaultDuration","TransitionElement","_this","getIndexes","leaving","getTransition","transitionStyles","pointerEvents","renderChildren","customRenderer","transitionRender","entering","transitionStyle","defaultTransition","getDefaultTransition","undefined","defaultStyles","transitionState","screenIndexes","leavingBox","box","enteringBox","leavingTransition","getInterpolation","height","x","y","fromIndex","toIndex","fromValue","inverted","log","onTransitionEnd","PropTypes","object","number","mountedElements","register","instance","wrapper","unregister","splice","clbks","reMeasure","bp","screens","offset","el","measure","startTransition","leavingKeys","enteringKeys","TransitionLayer","state","elements","checkForTransitions","list","couples","getTransitionCouples","waitForReadyAndRender","setTimeout","couple","renderElement","setState","_this3","removeElement","clean","fromIds","toIds","sharedId","SharedElementWrapper","calculateIndexes","previousIndex","previousScreen","updateRelativeIndexes","readyScreens","e","updateLayout","renderScreens","getScreenTransition","_onScreenReady","_onScreenUnmount","nativeEvent","stackTransition","stackIndexes","needRelativeUpdate","context","transitionIndexes","nextIndexes","_this4","forceUpdate","oldIndexes","unusedIndexes","updated","_this5","_this6","prevIndexes","prevItem","nextItem","prevIndex","nextIndex","_this7","useNativeDriver","getActiveScreens","array","flex","ModalWrapper","content","showing","shadowColor","shadowOpacity","shadowRadius","elevation","handleWidth","DrawerWrapper","drawerWidth","drawerPos","calculateDrawerIndex","open","overlayAnimStyle","drawerIndex","drawerMethods","openDrawer","close","closeDrawer","_drawerMethods","handle","overlay","Drawer","collapsible","onClick","collapsibleContainer","drawerStyles","collapsibleDrawer","snapPoints","Interactable","dragEnabled","ref","horizontalOnly","boundaries","bounce","onDrag","animatedValueX","prevProps","setValue","refs","dx","dy","di","_config","_interpolation","setVelocity","targetSnapPointId","flexDirection","paddingRight","backgroundColor","expander","leftColumn","stackAndDrawer","Navigator","getWindowSize","calculateTransition","transitions","getScreenStack","_onBack","drawerInstance","BackHandler","addEventListener","DrawerComponent","currentTransition","currentBreakpoint","modalTransition","getModalTransitions","windowWrapper","_onLayout","component","breakPoints","sort","b","parseInt","routerStack","routerIndex","lastIndex","urlstackOptions","createRouter","interceptor","fu","showingModal","detectModal","updateModalIndexes","Dimensions","get","startRouter","removeEventListener","showModal","transistions","nextRoute","func","mobileTransition","desktopTransition","statusBarHeight","StatusBar","currentHeight","paddingTop","SharedElement","se","layouted","cx","cy","ContextConsumerHOC","Consumer","WrapperContext","oneOf","string","SharedElementWithContext"],"mappings":";;;;;4JAYIA,6jEACkB,oBAAXC,SACTD,SAAW,SAAUE,OACfC,EAAIC,SAASC,cAAc,YAC/BF,EAAEG,KAAOJ,EACFC,IAKX,IAAII,OAAS,CACXC,OAAQ,SAAUC,UACT,IAAIC,OAAQD,IAErBE,SAAUA,UAKRD,OAAS,SAAUD,OAChBA,IAAYA,EAAQG,eACjB,IAAIC,MAAM,0DAGdC,EAAIL,EAAQG,SAEZG,EAAM,GACVC,OAAOC,KAAMR,GAAUS,QAAS,SAAUC,GAC5B,aAARA,IACJJ,EAAII,GAAOV,EAAQU,MAGrBL,EAAEM,MAAQN,EAAEM,KAAML,QACbH,SAAWE,OAGXO,IAAM,QAGNC,IAAM,IAGTC,UAAY,CACdC,UAAW,SAAUC,QACdA,OAASC,KAAKC,YAAaF,IAGlCE,YAAa,SAAUF,EAAQG,GACxBH,GAASI,QAAQC,KAAM,qCAEvBL,EAAOM,SACVN,EAAS,CAACA,QAGRO,EAAe,GACjBC,EAAKP,YAGPD,EAAOP,QAAS,SAASgB,OACnBC,EAAOxB,SAASiB,EAAQM,EAAEC,MAE1BC,EAAS,GACXC,EAAS,CACPC,MAAOC,aAAQJ,EAAMC,GACrBI,GAAIL,EACJM,GAAIP,EAAEO,IAIVJ,EAAOD,OAASA,EAAOM,IAAK,SAASC,UAAWA,EAAEC,OAE9CV,EAAEW,UAAYX,EAAEW,SAASd,SAC3BM,EAAOS,WAAaP,aAAQJ,EAAM,GAAI,CAACY,KAAK,IAC5CV,EAAOQ,SAAWZ,EAAGN,YAAaO,EAAEW,SAAUV,IAGhDH,EAAagB,KAAMX,KAGdL,GAGTiB,MAAO,SAAUC,EAAUC,EAAYC,OAGnCjB,EAAMkB,EAAOJ,EAAOK,EAFlBC,EAAI,EACNrD,EAAMsD,YAAaN,GAIhBC,IACHA,EAAazB,KAAKD,YAGhBY,GAAUX,KAAKd,SAASZ,UAAYA,UAAWE,OAInC,OAHhBiC,EAAQE,EAAOoB,UAGN,KACPtB,EAAO,IAAMA,GAGRoB,EAAIJ,EAAWpB,SAAWsB,GAAO,KACtCC,EAAIH,EAAWI,IACTT,aAEJO,EAAQC,EAAER,WAAWY,KAAMvB,IAChB,IACTc,EAAQvB,KAAKuB,MAAO/C,EAAKoD,EAAET,UAAU,GACjCI,EAAMU,QAAQ5B,cAChBkB,EAAMU,QAAU,CAACL,EAAEb,IAAImB,OAAQX,EAAMU,SACrCV,EAAMY,SAAW,CAACP,EAAEd,IAAIoB,OAAQX,EAAMY,UAC/BZ,EAGPI,GAAQ,GAKdA,EAAQC,EAAEhB,MAAMoB,KAAMvB,MAEpBkB,EAAQ,CACNb,GAAIc,EAAEd,GAAIC,GAAIa,EAAEb,GAAIL,OAAQiB,EAAMS,MAAM,KAIvCT,GACHE,QAIAI,EAAU,GACVE,EAAW,UAEXR,GACFM,EAAQX,KAAMK,EAAMZ,IACpBoB,EAASb,KAAMK,EAAMb,KAEbY,GACRvB,QAAQkC,MAAM,+BAAiCb,GAGjDD,EAAQ,CACNU,QAASA,EACTE,SAAUA,EACVJ,SAAUtB,EACV6B,OAAQ3B,EAAO2B,OACfC,MAAOC,gBAAGC,MAAO9B,EAAO2B,QACxBI,KAAM/B,EAAO+B,KACbC,MAAOhB,GAASA,EAAMb,KAAM,EAC5BJ,OAAQ,IAGNiB,GACFC,EAAElB,OAAOlB,QAAS,SAAUyB,EAAGY,GAC7BN,EAAMb,OAAQO,GAAMU,EAAMjB,OAAOmB,KAI9BN,GAITqB,MAAO,eACDrC,EAAKP,iBACJd,SAAS2D,SAAU,eAClBC,EAASvC,EAAGwC,cACXD,EAAOE,OAERF,EAAOG,UAAYH,EAAOE,KAC5BzC,EAAGrB,SAASgE,QAASJ,EAAOE,OAG5BzC,EAAGiB,SAAWsB,EAAOK,aACrB5C,EAAGX,IAAIJ,QAAS,SAAUuB,GACxBA,EAAI+B,EAAOK,yBAKZjE,SAAS0D,aACTpB,SAAWxB,KAAKuB,MAAOvB,KAAKd,SAASkE,eACnCpD,KAAKwB,UAEd6B,KAAM,gBACCnE,SAAS2D,SAAU,eAE1BS,QAAS,eACHR,EAAS9C,KAAK+C,cAClBD,EAAOE,MAAQF,EAAOG,UAAYH,EAAOE,MAAQhD,KAAKd,SAASgE,QAASJ,EAAOE,OAEjFD,YAAa,eACPE,EAAUjD,KAAKd,SAASkE,cAC1BD,EAAenD,KAAKuD,kBAAmBvD,KAAKuB,MAAM0B,UAI7C,CAACA,QAAQA,EAASD,KAHhBG,GAAiBA,EAAapB,SAAWoB,EAAab,OAASa,EAAaT,KAGjDS,aAAaA,IAEnDI,kBAAmB,SAAUhC,OACvBhB,EAAKP,iBAEJL,IAAIH,QAAS,SAASuB,GACrBQ,GAEmB,iBADrBA,EAAQR,EAAIQ,MAEVA,EAAQhB,EAAGgB,MAAOA,MAKjBA,GAETiC,eAAgB,SAAUzC,QACnBpB,IAAI2B,KAAMP,IAEjB8B,SAAU,SAAU9B,QACbnB,IAAI0B,KAAMP,IAEjBO,KAAM,SAAUE,QACTiC,eAAe,OAAQjC,IAE9B0B,QAAS,SAAU1B,QACZiC,eAAe,UAAWjC,IAEjCkC,KAAM,gBACCxE,SAASwE,QAEhBD,eAAgB,SAAUE,EAAQnC,OAE5BwB,EADAC,EAAUjD,KAAKd,SAASkE,cAI1BJ,EADqB,iBAAbxB,EACDA,EAGAoC,eAAgB5D,KAAKuB,MAAO0B,GAAWzB,OAG5C2B,EAAenD,KAAKuD,kBAAmBvD,KAAKuB,MAAMyB,IAClDG,GAEEF,KADJD,EAAOG,EAAapB,SAAWoB,EAAab,OAASa,EAAaT,YAE3DxD,SAAUyE,GAAUX,KAMjC,IAAK,IAAIW,UAAU9D,UAAYb,OAAOa,UAAW8D,QAAW9D,UAAU8D,QAEtEE,aAAiBhF,OAIjB,SAASI,SAAU6E,EAAKC,OAClBC,EAAQlC,YAAYgC,GACtBG,EAASnC,YAAYiC,UAGlBD,EACAC,EAES,MAAVC,EACKC,EAEW,MAAXA,EACAD,EAGAA,EAAQC,EATCD,EADAC,EAcpB,SAASnC,YAAatD,OACfA,EAAM,MAAO,QACd0F,EAAY1F,QAC0B,MAAtC0F,EAAWA,EAAU7D,OAAS,KAChC6D,EAAYA,EAAU9B,MAAM,EAAG8B,EAAU7D,OAAS,IAE/B,MAAjB6D,EAAU,KACZA,EAAY,IAAMA,GAEbA,EAGT,SAASN,eAAgBO,EAAMnB,OACzBxB,EAAWlC,OAAO8E,OAAQD,EAAMnB,GAClCV,EAASd,EAASc,cAIlBA,EADEhD,OAAOC,KAAKiC,EAASe,OAAOlC,OACrB,IAAMmC,gBAAG6B,UAAW7C,EAASe,OAG7B,GAGJf,EAASO,SAAWO,EAASd,EAASkB,KCpT/C,IAAIG,UAAW,aAEXyB,aAAe,CACjB5E,KAAM,SAAUX,QACXwF,QAAU,CAAExF,EAAQyF,iBAAmB,MAE5C5B,MAAO,gBACA6B,QAEPnD,KAAM,SAAUE,QACX+C,QAAQjD,KAAME,QACZiD,QAEPvB,QAAS,SAAU1B,QACd+C,QAASvE,KAAKuE,QAAQlE,QAAWmB,OAC/BiD,QAEP5B,SAAU,SAAU9B,GAClB8B,UAAW9B,GAEbqC,YAAa,kBACJpD,KAAKuE,QAASvE,KAAKuE,QAAQlE,OAAS,IAE7CoE,KAAM,WACJ5B,WAAYA,UAAU7C,KAAKoD,gBAE9B9E,SAAU,SAAUoG,OACfC,EAAQD,EAAIE,MAAM,KAClBC,EAAcF,EAAM,GAAKA,EAAM,GAAGC,MAAM,KAAO,SAC5C,CACN7C,SAAU4C,EAAM,GAChBrC,OAAQuC,EAAY,GAAK,IAAMA,EAAY,GAAK,GAChDnC,KAAMmC,EAAY,GAAK,IAAMA,EAAY,GAAK,GAC9CtC,MAAOsC,EAAY,GAAKrC,gBAAGC,MAAOoC,EAAY,IAAO,KAGtDnB,KAAM,WACA1D,KAAKuE,QAAQlE,OAAS,QACnBkE,QAAQO,WAEVL,wBAIQH,aC7CbzB,YAAW,aACXkC,aAAe,CAClBrF,KAAM,SAAUX,KAGhB6D,MAAO,eACFrC,EAAKP,KAEJwB,SAASkB,OACblB,SAASkB,KAAO,MAIjBnE,OAAOyG,aAAe,WACrBzE,EAAGkE,QAIJlE,EAAGkE,QAEJnD,KAAM,SAAUqB,GACfpE,OAAOiD,SAASkB,KAAO,IAAMC,GAE9BO,QAAS,SAAUP,OACdnE,EAAMgD,SAASyD,SAAW,KAAOzD,SAAS0D,KAAO1D,SAASO,SAAW,IAAMY,EAE/EnB,SAAS0B,QAAQ1E,IAElBqE,SAAU,SAAU9B,GACnB8B,YAAW9B,GAEZqC,YAAa,kBACP5B,SAASkB,KAGgB,MAArBlB,SAASkB,KAAK,GACf,IAAMlB,SAASkB,KAEhBlB,SAASkB,KAAKN,MAAM,GALnB,KAOTqC,KAAM,WACL5B,YAAS7C,KAAKoD,gBAEfM,KAAM,WACHnF,OAAOgG,QAAQb,wBAIFqB,aChDblC,YAAW,aAEXsC,aAAe,CACjBzF,KAAM,SAAUX,QACTqG,SAAWrG,EAAQqG,UAAY,GACJ,MAA5BpF,KAAKoF,SAAShD,OAAO,UAClBgD,SAAWpF,KAAKoF,SAAShD,MAAM,GAAI,KAG5CQ,MAAO,eACDrC,EAAKP,KAGTzB,OAAO8G,WAAa,WAClB9E,EAAGkE,QAILlE,EAAGkE,QAELnD,KAAM,SAAUE,GACd+C,QAAQe,UAAW,GAAI,GAAItF,KAAKoF,SAAW5D,QACtCiD,QAEPvB,QAAS,SAAU1B,GACjB+C,QAAQgB,aAAc,GAAI,GAAIvF,KAAKoF,SAAW5D,QACzCiD,QAEP5B,SAAU,SAAU9B,GAClB8B,YAAW9B,GAEbqC,YAAa,eACPoC,EAAIhE,SAASO,SAAWP,SAASc,OAASd,SAASkB,KACrD+C,EAAiBzF,KAAKoF,SAAS/E,cAG7BmF,EAAEpD,MAAM,EAAGqD,KAAoBzF,KAAKoF,WACtCI,EAAIA,EAAEpD,MAAOqD,IAGRD,GAETf,KAAM,WACJ5B,aAAYA,YAAU7C,KAAKoD,gBAE9BM,KAAM,WACHnF,OAAOgG,QAAQb,wBAIFyB,aCtBF,SAASrG,OAAQiB,EAAQhB,OACnCG,EAEHA,EADuB,oBAAbR,SACC4F,eAEHvF,GAAgC,SAArBA,EAAQG,SAChB6F,eAGAI,mBAGRO,EAAS7G,SAAOC,OAAO,CAACI,SAAAA,IAGxByG,EAAY,GAEZC,EAAc,CAEjB/G,OAAQ6G,EAGRG,MAAO,GAGPC,aAAc,EAGdC,aAAc,GAGdC,eAAgB,GAEhBC,MAAO,CAAEC,QAAQ,EAAOL,MAAO,GAAIC,aAAc,GAGjDjD,SAAU,SAAUsD,GACnBR,EAAUrE,KAAM6E,IAIjBC,SAAU,SAAUzD,GACNA,IAAU3C,KAAKgG,eAAgBhG,KAAKgG,eAAe3F,OAAS,SAGnE2F,eAAelB,MAGpBY,EAAOpE,KAAK+E,MAAOX,EAAQY,kBAGtBN,eAAe1E,KAAMqB,GAC1B+C,EAAOpE,KAAK+E,MAAOX,EAAQY,qBAM9BZ,EAAO5F,UAAWC,GAClB2F,EAAO7C,SAAU0D,mBAAoBX,EAAa7F,EAAQ4F,KAGzD,QAAS,OAAQ,iBAAkB,WAAWnG,QAAS,SAAAmE,GACvDiC,EAAYjC,GAAU,kBACd3D,KAAKnB,OAAO8E,GAAQ0C,MAAOrG,KAAKnB,OAAQyH,cAI1CV,EAIR,SAASW,mBAAoBb,EAAQ3F,EAAQ4F,OAGxCa,EAAYC,aAAc1G,UAEf,SAAAyB,GAEFA,EAASO,SAAWP,EAASc,OAASd,EAASkB,OAC7CgD,EAAOM,eAAgBN,EAAOM,eAAe3F,OAAS,KAGnEqF,EAAOM,eAAiB,QAIrBU,EAAcC,kBAAmBnF,EAAUgF,KACxBI,YAAalB,EAAOK,cAAgB,GAAIW,EAAaF,GAAtEX,IAAAA,MAAOgB,IAAAA,MACbC,oBAAqBpB,EAAQqB,WAAYlB,GAASgB,EAAOL,GAGzDd,EAAOlE,SAAWA,EAClBkE,EAAOK,aAAeF,EAGtBF,EAAUnG,QAAS,SAAAwH,UAAQA,EAAKxF,MAMlC,SAASmF,kBAAmBnF,EAAUgF,OACjCrE,EAAWX,EAASW,SACpB8E,GAAQ,EACRpB,EAAQ,UAEZ1D,EAAS3C,QAAS,SAAAmD,OACbuE,EAAOV,EAAU7D,MAEjBsE,SAGHA,EAAME,KAAKrB,YAAcsB,QAAQzE,EAAOsE,EAAME,KAAKtB,YAGnDoB,GAAQ,OAILI,EAAOC,gBAAiB3E,EAAOnB,EAAU0F,GAEzCG,EAAKE,SAERF,EAAKF,KAAO,CACXrB,YAAa,EACbD,MAAOW,EAAUa,EAAK1E,OAAOxB,SAASH,IAAK,SAAAwG,UAC1CF,gBAAiB3E,EAAQ6E,EAAM/G,KAAMe,EAAUgF,EAAW7D,EAAQ6E,EAAM/G,UAG1EwG,EAAQI,GAGTxB,EAAMvE,KAAK+F,KAGRJ,IAGEA,EAAME,KAAKtB,MAAMxF,QACrBF,QAAQC,KAAK,kDAAoDqH,UAAUhH,OAItEoF,EAGR,SAASkB,WAAYL,OAChBgB,EAAY,GACZC,EAAe,UAEnBjB,EAAYlH,QAAS,SAAA6H,GAChBA,EAAKO,SACRF,EAAUpG,KAAMqG,GAChBA,EAAe,CAAEN,IAGjBM,EAAarG,KAAM+F,KAGjBM,EAAatH,QAChBqH,EAAUpG,KAAMqG,GAEVD,EAGR,SAASZ,oBAAqBpB,EAAQmC,EAAQC,EAAatB,MACrDqB,EAAO,GAAGxH,OAadqF,EAAOG,MAAQgC,EAAO,GACtBnC,EAAOI,YAAciC,KAAKC,IAAK,EAAGD,KAAKE,IAAKH,EAAaD,EAAO,GAAGxH,OAAS,IACxEqF,EAAOO,QACVP,EAAOO,MAAMC,QAAS,YAdlBR,EAAOG,MAAMxF,OAAQ,KAErB6H,EAAU1B,EAAWqB,EAAO,GAAG,GAAGlF,OAAQwF,iBAAmB,OAE5CvB,YAAa,GAAID,kBADvBjB,EAAO7G,OAAO0C,MAAO2G,GAC+B1B,GAAaA,GAA3EX,IAAAA,MAAOgB,IAAAA,MACZnB,EAAOG,MAAQA,EACfH,EAAOI,YAAce,EAYnBgB,EAAOxH,OAAS,IACdqF,EAAOO,QACXP,EAAOO,MAAQ,CAAEJ,MAAO,GAAIC,YAAa,IAE1CJ,EAAOO,MAAMC,OAAS4B,GAAe,EACrChB,oBAAqBpB,EAAOO,MAAO4B,EAAOzF,MAAM,GAAI0F,EAAcD,EAAO,GAAGxH,OAAQmG,IAKtF,SAASc,gBAAkB3E,EAAOnB,EAAUgF,SACpC,CACN4B,OAAQ5B,EAAUzF,GAClB4B,MAAOA,EACP4E,SAAUf,EAAUe,OACpBK,UAAWpB,EAAUoB,QACrBpG,SAAUA,EACVf,KAAM4H,aAAc1F,EAAOnB,EAASO,UACpCtC,IAAK6I,eAIP,SAASD,aAAc1F,EAAOZ,OACzBwG,EAAa5F,EAAMiC,MAAM,KACzB4D,EAAYzG,EAAS6C,MAAM,KAC3B6D,EAAY,UAEhBF,EAAW/I,QAAS,SAACyB,EAAGY,GACvB4G,EAAUnH,KAAMkH,EAAU3G,IAAMZ,KAG1BwH,EAAUC,KAAK,KAGvB,SAAS9B,YAAae,EAAcgB,EAAgBnC,WAC/CoC,EAAY,GACZ/G,EAAI,EACJgH,GAAW,EACX5F,EAAU0E,EAAa,GACvBmB,EAAYH,EAAe,GAEvB1F,GAAW6F,GACdD,GAAY5F,GAAW6F,EACtB7F,EAAQmF,SAAWU,EAAUV,QAChCQ,EAAUtH,KAAMyH,WAAY9F,EAAS6F,EAAWtC,IAC5CvD,EAAQxC,OAASqI,EAAUrI,OAG9BoI,GAAW,KAIZA,GAAW,EACXD,EAAUtH,KAAMwH,IAGTD,GAAY5F,EACpB2F,EAAUtH,KAAM2B,GAER6F,GACRF,EAAUtH,KAAMwH,GAKjB7F,EAAU0E,IADV9F,GAEAiH,EAAYH,EAAe9G,SAGrB,CACNgE,MAAO+C,EACP/B,MAAO8B,EAAetI,OAAS,GAIjC,SAAS0I,WAAY9F,EAAS6F,EAAWtC,OACpCa,mBACAyB,GAAWrJ,IAAKwD,EAAQxD,SAGxB4H,EAAKF,KAAM,KAEV6B,EAAW,GACXlD,EAAcuB,EAAKF,KAAKrB,YAG5B7C,EAAQkE,KAAKtB,MAAMrG,QAAS,SAAC6H,EAAMxF,GAClCmH,EAAS1H,KACRO,IAAMiE,EAAcgD,EAAU3B,KAAKtB,MAAMhE,GAAKwF,GAG/C2B,EAASnH,GAAGpC,IAAM4H,EAAK5H,IAEvBuJ,EAASnH,GAAGoH,QAAU5B,EAAK4B,SAAWpH,IAAMiE,IAI7CuB,EAAKF,KAAO,CACXtB,MAAOmD,EACPlD,YAAAA,UAIKuB,EAWR,SAASZ,aAAc1G,OAAQmJ,yDAAc,GACxCC,EAAI,UAERpJ,EAAOP,QAAS,SAAAgB,OACXmC,EAAQuG,EAAc1I,EAAEC,QAC5B0I,EAAExG,GAASnC,EACPA,EAAEW,SAAU,KACXiI,EAAe3C,aAAcjG,EAAEW,SAAUwB,GAC7CwG,mBAASA,EAAMC,MAIVD,EAMR,SAASb,oBAGD,IAFMP,KAAKsB,MAAuB,IAAhBtB,KAAKuB,UAEVC,SAAS,IAG9B,SAASnC,QAASzE,EAAOkD,WACpBhE,EAAIgE,EAAMxF,OACPwB,QACFgE,EAAMhE,GAAGc,QAAUA,SACfd,SAKF,EC1WD,SAAS2H,QAASC,OACpBC,EAAMC,WAEDC,EAAaC,UACrBH,EAAOG,EACPF,EAAQF,EAAGpD,MAAO,KAAMwD,UAIlB,eACDH,GAAQA,EAAKrJ,SAAWiG,UAAUjG,cAC/BuJ,EAAatD,mBAGjBzE,EAAI,EACDA,EAAI6H,EAAKrJ,QAAQ,IACnBqJ,EAAK7H,KAAOyE,UAAUzE,UAClB+H,EAAatD,WAErBzE,WAGM8H,GAIT,SAAgBG,kBACP/B,KAAKgC,MAAuB,IAAhBhC,KAAKuB,UAAsBC,SAAS,IAGzD,SAAgBS,QAET,SAASC,KAAMC,EAAMC,GAC3BA,EAAQ3K,QAAS,SAAA4K,GAChBF,EAAKE,GAAKF,EAAKE,GAAGH,KAAKC,KChCzB,kBAAe,CACdG,OAAQ,SAA+BC,EAASC,OAC3CC,EAASD,EAAOE,MAAQ,QACrB,CACNC,WAAY,CACXC,WAAY,EAAE,GAAI,EAAG,EAAG,EAAG,GAC3BC,YAAa,CAACJ,EAAQA,EAAQ,GAAIA,GAASA,IAE5CK,QAAS,CACRF,WAAY,EAAE,GAAI,EAAG,EAAG,GAAI,GAC5BC,YAAa,CAAC,EAAG,EAAG,EAAG,EAAG,MAI7BE,OAAQC,mBAAOC,OACfC,SAAU,cCfKC,eAAgBC,EAAYb,EAASC,OAChDF,EAAsC,mBAAtBc,EAAWd,OAAwBc,EAAWd,OAAQC,EAASC,GAAWY,EAAWd,OACpGA,IACJA,EAAS,QAGNa,EAAiB,GACjBE,EAAkB,UAElBd,EAAQe,QACXH,EAAeI,OAAShB,EAAQe,MAAQtD,KAAKwD,IAAIjB,EAAQkB,WAG1DlM,OAAOC,KAAM8K,GAAS7K,QAAS,SAAAC,OAC1BkK,EAAQU,EAAO5K,MAEfgM,UAAUhM,GACTiM,SAASjM,IACZU,QAAQC,mGAA2FX,QAEhGkK,GAASA,EAAMgB,WAClBO,EAAgBzL,GAAQ6K,EAAQa,WAAWQ,YAAahC,GAGxDuB,EAAgBzL,GAAQkK,OAGrB,GAAIiC,cAAcnM,GAAM,KAExBoM,EAAOD,cAAcnM,GACrBqM,GAAS,EACTnC,GAASA,EAAMiB,aAClBP,EAAO5K,GAAKmL,YAAYpL,QAAS,SAAAmK,GAC3BmC,GAAUC,QAAOpC,KAAUkC,IAC/BC,GAAS,EACT3L,QAAQC,wFAAiFwL,cAAcnM,qBAAcA,uBAAiBkK,YAIxIyB,EAAgB9J,wBACd7B,EAAM6K,EAAQa,WAAWQ,YAAahC,MAIxCyB,EAAgB9J,wBACd7B,EAAMkK,SAKTxJ,QAAQC,4DAAqDX,UAI3D2L,EAAgB/K,SACnB6K,EAAec,UAAYZ,GAGrBF,EAIR,IAAIO,UAAY,GACZC,SAAW,GACf,CAAC,OAAQ,QAAS,MAAO,UAAUlM,QAAS,SAAAC,GAC3CgM,UAAUhM,GAAO,EACjBiM,SAASjM,GAAO,IAEjB,CAAC,QAAS,SAAU,UAAW,kBAAmB,gBAAgBD,QAAS,SAAAC,GAC1EgM,UAAUhM,GAAO,IAGlB,IAAIwM,EAAI,SAAU7M,EAAI,SAClBwM,cAAgB,CACnBM,YAAaD,EACbE,OAAQ/M,EAAGgN,QAAShN,EAAGiN,QAASjN,EAAGkN,QAASlN,EAC5CmN,MAAON,EAAGO,OAAQP,EAAGQ,OAAQR,EAC7BvB,WAAYuB,EAAGS,WAAYT,EAC3BU,MAAOvN,EAAGwN,MAAOxN,GAIlB,SAAgByN,QAASC,EAAeC,EAAKC,EAAO3C,OAC/C4C,EAAW,IAAIC,qBAASC,MAAOL,EAAcM,QACjDF,qBAASG,OAAQJ,EAAU,CAAChC,SAAU,EAAGqC,QAASR,IAAiBlK,gBAE/D2K,EAAU,CAAErC,eAAe,CAACb,OAAAA,GAAS,CAACc,WAAY8B,gBAE7CpL,OACJ2L,EAAQ,GACZlO,OAAOC,KAAM8K,GAAS7K,QAAS,SAAAiO,OAC1BC,EAAMrD,EAAOoD,MACbC,GAAOA,EAAI/C,WAAY,KACtBgD,EAAU,CACbhD,WAAY,GACZC,YAAa8C,EAAI9C,aAElB8C,EAAI/C,WAAWnL,QAAS,SAAAoO,GACvBD,EAAQhD,WAAWrJ,KAAMsM,EAAc/L,EAAIkL,KAE5CS,EAAMC,GAAQE,OAGdH,EAAMC,GAAQC,QAIZG,EAAW3C,eAAe,CAACb,OAAQmD,GAAQ,CAACrC,WAAY8B,IAC5DM,EAAQjM,KAAMuM,IApBNhM,EAAI,EAAGA,EAAImL,EAAOnL,MAAlBA,UAuBF0L,EC/GR,IAAMO,QAAUC,eAAMC,gBCKDC,qCACRC,wGACLA,KAEDpN,GAAKgJ,aAELqE,kBAAmBD,EAAM5D,QAAS4D,EAAM3D,6BANJ6D,2EAerC/G,EAAOrH,KAAKkO,MAAM7G,KAClBgH,EAAkB,CACrBhE,OAAOiE,UACPtO,KAAKkL,gBAEFqD,EAAe,CAClBpD,WAAYnL,KAAKkO,MAAM/C,WACvBb,QAAStK,KAAKkO,MAAM5D,QACpBxJ,GAAIuG,EAAK5H,YAITsO,6BAACb,qBAASsB,MAAKC,MAAQJ,EAAkBK,SAAW,kBAAMC,EAAKT,MAAMU,QAASvH,EAAK5H,OAClFsO,6BAACD,QAAQe,UAASlF,MAAO4E,GACtBvO,KAAK8O,8DAO2E9O,KAAKkO,MAApF7G,IAAAA,KAAM0H,IAAAA,YAAarJ,IAAAA,OAAQyF,IAAAA,WAAYb,IAAAA,QAASC,IAAAA,OAAQyE,IAAAA,OAAQC,IAAAA,WAChE7G,EAAqBf,EAArBe,OAAQ5G,EAAa6F,EAAb7F,gBAEV6F,EAAKE,OAEPwG,6BAAC3F,GAAO1C,OAAQA,EACflE,SAAUA,EACV8I,QAASA,EACTC,OAAQA,EACRyE,OAAUA,EACVC,WAAaA,GACblB,6BAACgB,GAAYrJ,OAASA,EACrB6B,QAAS,EACT2H,iBAAmB/D,EAAWgE,eAAiBA,cAC/CtJ,MAAQwB,EAAKF,KAAKtB,MAClBgB,MAAQQ,EAAKF,KAAKrB,YAClBsJ,cAAgB9E,EAChBC,OAASA,EACT0E,WAAaA,KAMhBlB,6BAAC3F,GAAO1C,OAAQA,EACflE,SAAUA,EACV8I,QAASA,EACTC,OAAQA,EACRyE,OAAUA,EACVC,WAAaA,8CAIG3E,EAASC,OACvBY,EAAanL,KAAKkO,MAAM/C,gBACvBD,eAAiBC,EAAaD,eAAgBC,EAAYb,EAASC,GAAW,qDAGzD8E,GACtBrP,KAAKsP,iBAAkBD,SACrBlB,kBAAmBkB,EAAU/E,QAAS+E,EAAU9E,iDAIrC8E,MACZA,EAAU/E,aAETG,EAAU4E,EAAU9E,OAApBE,QACqB4E,EAAU/E,QAA/BiF,IAAAA,OAAQ/D,IAAAA,WACYxL,KAAKkO,MAAzB3D,IAAAA,OAAQD,IAAAA,eAGbG,IAAUF,EAAOE,OACjB8E,IAAWjF,EAAQiF,QACnB/D,IAAalB,EAAQkB,UACrBxL,KAAKkO,MAAM/C,aAAekE,EAAUlE,gEAKhC+C,MAAMsB,UAAWxP,KAAKkO,MAAM7G,KAAK5H,8BAhGnBwO,6BASC,CACpBW,QAAS5E,KACTwF,UAAWxF,OAyFb,IAAIK,OAASoF,uBAAW3Q,OAAO,CAC9BwP,UAAW,CACVoB,SAAU,SACVC,SAAU,WACVC,IAAK,EAAGC,KAAM,EAAGC,OAAQ,EAAGC,MAAO,EACnCzE,OAAO,MC3GH0E,MAAwB,QAAhBC,qBAASC,GACjBC,gBAAkB,IAEHC,yCAYPlC,wGACNA,KAED5D,QAAU+F,EAAKC,eACfxD,cAAgB,IAAII,qBAASC,MAAOkD,EAAK/F,QAAQiG,WACjDpF,WAAakF,EAAKG,qCAjBsBpC,oEAsBrB,IAApBpO,KAAKmL,kBACD,SAGJsF,EAAmB,CACtBpG,SAAOiE,UACPtO,KAAKkO,MAAMqC,QAAQrC,MAAMO,MACzBvD,eAAgBlL,KAAKmL,WAAY,CAACA,WAAYnL,KAAK8M,wBAInDiB,6BAACb,qBAASsB,MAAKC,MAAQgC,EAAmBC,cAAc,QACrD1Q,KAAK2Q,+DAMLzC,EAAQlO,KAAKkO,MACb0C,EAAiB1C,EAAMqC,QAAQrC,MAAM2C,wBAErCD,EACIA,EAAe,CACrB9D,cAAe9M,KAAK8M,cACpBmC,WAAYf,EAAMe,WAClB6B,SAAU5C,EAAM4C,SAChBP,QAASrC,EAAMqC,UAIVrC,EAAMqC,QAAQrC,MAAM/M,qDAOvBgK,EAHA4F,EAAkB/Q,KAAKkO,MAAMqC,QAAQrC,MAAM/C,WAC3C6F,EAAoBhR,KAAKiR,0BAIE,mBAApBF,EAAgC,KACtC7C,EAAQlO,KAAKkO,MACjB/C,EAAa4F,EAAiB,CAC7B9B,WAAYf,EAAMe,WAClB6B,SAAU5C,EAAM4C,SAChBP,QAASrC,EAAMqC,QACfS,mCAAwBA,UAIzB7F,EAAa4F,MAGK,IAAf5F,SACI,EAEH,QAAmB+F,IAAf/F,SACD6F,EAIH7F,EAAWF,WACfE,EAAWF,SAAW+F,EAAkB/F,cAGrCZ,EAASc,EAAWd,OACpB8G,EAAgBH,EAAkB3G,cAEjCA,IACJA,EAAS,GACTc,EAAWsD,MAAQpE,GAGpB/K,OAAOC,KAAK4R,GAAe3R,QAAQ,SAAAC,QACdyR,IAAhB7G,EAAO5K,KACV4K,EAAO5K,GAAO0R,EAAc1R,MAIvB0L,6CAIA,CACN2F,SAAU9Q,KAAKkO,MAAM4C,SAAS5C,MAAMkD,iBAAmBpR,KAAKkO,MAAMmD,cAAcP,SAChFP,QAASvQ,KAAKkO,MAAMqC,QAAQrC,MAAMkD,iBAAmBpR,KAAKkO,MAAMmD,cAAcd,8DAMrDvQ,KAAKsK,QAA1BiG,IAAAA,QAASO,IAAAA,SACVQ,EAAatR,KAAKkO,MAAMqC,QAAQgB,IAChCC,EAAcxR,KAAKkO,MAAM4C,SAASS,IAClCE,EAAoBzR,KAAKkO,MAAMuD,wBAE5B,CACNpH,OAAQ,CACPI,MAAOzK,KAAK0R,iBAAkBnB,EAASO,EAAUQ,EAAW7G,MAAO+G,EAAY/G,OAC/EkH,OAAQ3R,KAAK0R,iBAAkBnB,EAASO,EAAUQ,EAAWK,OAAQH,EAAYG,QACjFjH,WAAY1K,KAAK0R,iBAAkBnB,EAASO,EAAUQ,EAAWM,EAAGJ,EAAYI,GAChFlF,WAAY1M,KAAK0R,iBAAkBnB,EAASO,EAAUQ,EAAWO,EAAGL,EAAYK,IAEjF5G,SAAWwG,GAAqBA,EAAkBxG,UAAakF,0DAI/C2B,EAAWC,EAASC,EAAW1E,MAC5C0E,IAAc1E,EAAU,OAAO0E,MAC/BC,EAAWH,EAAYC,QACpB,CACNpH,WAAYsH,EAAW,CAAEF,EAASD,GAAc,CAAEA,EAAWC,GAC7DnH,YAAaqH,EAAW,CAAE3E,EAAS0E,GAAc,CAAEA,EAAW1E,2DAK/DnN,QAAQ+R,IAAK,UAAWlS,KAAKkO,MAAM4C,SAASS,IAAKvR,KAAKkO,MAAMqC,QAAQgB,MAE5C,IAApBvR,KAAKmL,YAER+B,qBAASG,OAAQrN,KAAK8M,cAAe,CACpCQ,QAAStN,KAAKsK,QAAQwG,SACtB7F,SAAUjL,KAAKmL,WAAWF,UAAYkF,kBAEpCvN,MAAO,kBAAM+L,EAAKT,MAAMiE,6CAlJT/B,8BACD,CAElBU,SAAUsB,UAAUC,OAEpB9B,QAAS6B,UAAUC,OAEnBpD,WAAYmD,UAAUE,OAEtBjB,cAAee,UAAUC,SA+I3B,IAAMhI,SAASoF,uBAAW3Q,OAAO,CAChCwP,UAAW,CAAEqB,SAAU,WAAYD,SAAU,SAAUE,IAAK,EAAGC,KAAM,KC5JhE/B,UAAUC,eAAMC,cAAc,iBAGhCuE,gBAAkB,GAItB,SAASC,SAASC,EAAUvE,OACvBwE,EAAUxE,EAAMwE,QAAQ5R,GACvByR,gBAAgBG,KACpBH,gBAAgBG,GAAW,IAE5BH,gBAAgBG,GAASpR,KAAKmR,GAI/B,SAASE,WAAWF,OACfC,EAAUD,EAASvE,MAAMwE,QAAQ5R,GACjC+E,EAAQ0M,gBAAiBG,MACxB7M,GAEDA,UACChE,EAAIgE,EAAMxF,OACPwB,KAAM,GACRgE,EAAMhE,KAAO4Q,GAChB5M,EAAM+M,OAAO/Q,EAAG,GAOpB,IAIIoN,WAAYoC,cAJZwB,MAAQ,GASZ,SAASC,UAAWvI,EAAQwI,EAAIzI,OAC3B0I,EAAU1T,OAAOC,KAAMgT,sBACvBS,EAAQ3S,OAAS,IAErB4O,WAAa8D,EACb1B,cAAgB/G,MAEZ2I,EAAS,CAAErB,EAAGrH,EAAOqH,EAAGC,EAAGtH,EAAOsH,GACtCmB,EAAQxT,QAAS,SAAAC,GAChB8S,gBAAgB9S,GAAKD,QAAS,SAAA0T,GAC7BA,EAAGC,QAASF,QAOf,SAASG,gBAAiBC,EAAaC,EAAcvB,EAASN,GAC7DoB,MAAMrT,QAAS,SAAAwH,UAAQA,EAAMqM,EAAaC,EAAcvB,EAASN,SAG5D8B,uCACQrF,wGACLA,KACFsF,MAAQ,CACZC,SAAU,MAENC,oBAAsBrD,EAAKqD,oBAAoBzJ,qDANxBmE,oEAUxB7D,EAASvK,KAAKkO,MAAM3D,OACpBgH,EAAM,CACT3B,IAAKrF,EAAOsH,GAAK,EACjB9B,OAAQxF,EAAOqH,GAAK,GAAKrH,EAAOE,MAChCoF,KAAMtF,EAAOqH,GAAK,EAClB9B,QAASvF,EAAOsH,GAAK,GAAKtH,EAAOoH,QAG9B8B,EAAWzT,KAAKwT,MAAMC,SACtBE,EAAOrU,OAAOC,KAAMkU,GAAWzS,IAAK,SAAAF,UAAM2S,EAAS3S,YAEnD6S,EAAKtT,OAAS,GACjBF,QAAQ+R,IAAK,2BAA4ByB,EAAKtT,QAI9C0N,6BAACS,kBAAKC,MAAQ,CAACpE,SAAOiE,UAAWiD,GAAOb,cAAc,QACnDiD,+CAKeL,EAAcD,EAAatB,EAASN,OACnDmC,EAAU5T,KAAK6T,qBAAsBP,EAAcD,GAElDO,EAAQvT,cAERoR,kBAAoBA,OAEpBqC,sBAAuBF,EAAS7B,kDAGf6B,EAAS7B,kBAE3BlQ,EAAI+R,EAAQvT,OACTwB,KAAM,OACP+R,EAAQ/R,GAAG0O,QAAQgB,MAAQqC,EAAQ/R,GAAGiP,SAASS,WAE5CwC,WAAY,kBAAMpF,EAAKmF,sBAAuBF,EAAS7B,SAI5D0B,EAAW,GACfG,EAAQpU,QAAS,SAAAwU,OACZlT,EAAKgJ,WAET2J,EAAU3S,GAAO6N,EAAKsF,cAAeD,EAAQlT,UAGzCoT,SAAS,CAACT,SAAAA,4CAGoB3S,cAApByP,IAAAA,QAASO,IAAAA,gBAEvB/C,6BAACqC,mBAAkB3Q,IAAMqB,EACxByP,QAAUA,EACVO,SAAWA,EACX7B,WAAaA,WACboC,cAAgBA,cAChBI,kBAAoBzR,KAAKyR,mBAAqBzR,KAAKyR,kBAAmBxC,YACtEkD,gBAAkB,kBAAMgC,EAAKC,cAActT,4CAI/BA,OACV2S,mBAAgBzT,KAAKwT,MAAMC,iBACxBA,EAAS3S,QACXoT,SAAS,CAACT,SAAAA,uCAGJvF,OACPmG,EAAQ,UAEZ/U,OAAOC,KAAM2O,GAAQ1O,QAAS,SAAAyB,GACnB,OAANA,GAAoB,YAANA,GAAyB,aAANA,GAA0B,qBAANA,IACxDoT,EAAOpT,GAAMiN,EAAMjN,MAIdoT,+CAGcC,EAASC,OAC1BhE,EAAU,GACVqD,EAAU,UAEdU,EAAQ9U,QAAS,SAAAsB,GAChByR,gBAAgBzR,IAAOyR,gBAAgBzR,GAAItB,QAAS,SAAA0T,GACnD3C,EAAS2C,EAAGhF,MAAMsG,UAAatB,MAIjCqB,EAAM/U,QAAS,SAAAsB,GACdyR,gBAAgBzR,IAAOyR,gBAAgBzR,GAAItB,QAAS,SAAA0T,GAC9C3C,EAAQ2C,EAAGhF,MAAMsG,WACrBZ,EAAQtS,KAAK,CACZiP,QAASA,EAAS2C,EAAGhF,MAAMsG,UAC3B1D,SAAUoC,QAMPU,8CAKPf,MAAMvR,KAAMtB,KAAK0T,4EAIb7R,EAAIgR,MAAMxS,OACPwB,KAAM,GACRgR,MAAMhR,KAAO7B,KAAK0T,qBAErBb,MAAMD,OAAQ/Q,EAAI,YAMhBwI,SAASoF,uBAAW3Q,OAAO,CAChCwP,UAAW,CACVqB,SAAU,WACVrE,OAAQ,OAIJmJ,qBAAuB,SAAAvG,UAC5BH,6BAACD,UAAQe,UAASlF,MAAO,CAAE6I,SAAAA,SAAUG,WAAAA,WAAYS,gBAAAA,gBAAiBN,UAAAA,YAC/D5E,EAAM/M,SACR4M,6BAACwF,iBAAgB7N,OAASwI,EAAMxI,OAAS6E,OAAS2D,EAAM3D,WCzMpDyF,QAAwB,QAAhBC,qBAASC,GAEFnB,mCAkBPb,gGACLA,QAEDrI,EAAiBqI,EAAjBrI,MAAOgB,EAAUqH,EAAVrH,eAER2M,MAAQ,CACZlJ,QAAS+F,EAAKqE,iBAAiB,GAAI7O,EAAOgB,GAC1C0D,QAAQ,KAGJoK,cAAgB9N,IAChB+N,eAAiB/O,EAAMgB,GAAOpH,MAG9BiV,iBAAmBlL,QAAS6G,EAAKqE,iBAAiBzK,mCAClD4K,sBAAwBrL,QAAS6G,EAAKwE,sBAAsB5K,mCAI5D6K,aAAe,GAEpB7K,+BAAY,CAAC,iBAAkB,0CAvCQmE,6EA2CfpO,KAAKkO,MAAvBrI,IAAAA,MAAOH,IAAAA,OACT2I,EAAkB,CACrBhE,SAAOiE,UACPtO,KAAKkL,uBAIL6C,6BAACb,qBAASsB,MAAKC,MAAOJ,GACrBN,6BAACS,kBAAKC,MAAOpE,SAAOxE,MAAO6I,SAAW,SAAAqG,UAAKpG,EAAKqG,aAAaD,KAC1D/U,KAAKiV,cAAcvP,EAAQG,2CAMlBH,EAAQG,gBACI7F,KAAKwT,MAAzBjJ,IAAAA,OAAQD,IAAAA,WAGTC,OAEDyI,EAAU,UACdnN,EAAMrG,QAAS,SAAA6H,OACV5H,EAAM4H,EAAK5H,IAEV6K,EAAQ7K,IAKbuT,EAAQ1R,KACPyM,6BAACE,eAAc5G,KAAOA,EACrB0H,YAAcA,EACdrJ,OAASA,EACT4E,QAAUA,EAAS7K,GACnB8K,OAASA,EACTY,WAAagJ,EAAKe,oBAAqB7N,EAAKe,QAC5CwG,QAAUuF,EAAKgB,eACf3F,UAAY2E,EAAKiB,iBACjBpG,OAASmF,EAAKjG,MAAMc,OACpBC,WAAakF,EAAKjG,MAAMe,WACxBxP,IAAMA,OAGFuT,+CAGa5K,MACgB,mBAAzBA,EAAOoI,cAA8B,KAC3CrF,EAAa/C,EAAOoI,cAAexQ,KAAKkO,MAAMe,gBAC/B,IAAf9D,EAAuB,UACvBA,EAAa,OAAOA,SAGlBnL,KAAKkO,MAAMgB,sDAGL6F,QACRb,SAAS,CAAE3J,OAAQwK,EAAEM,YAAY9K,cACjCW,eAAiBA,eAAelL,KAAKkO,MAAMoH,gBAAiBtV,KAAKkO,MAAMqH,aAAcR,EAAEM,YAAY9K,kEAI/DvK,KAAKkO,MAAxCrI,IAAAA,MAAOgB,IAAAA,MAAOqI,IAAAA,iBAChB5E,EAAUtK,KAAK0U,iBAAkB1U,KAAKwT,MAAMlJ,QAASzE,EAAO7F,KAAK2U,cAAezF,MAGhF5E,IAAYtK,KAAKwT,MAAMlJ,cACrB4J,SAAU,CAAE5J,QAAAA,IAKdtK,KAAKwV,mBAAoB,MAGvBC,QAAQ3C,UACZ9S,KAAKkO,MAAM3D,OACXvK,KAAKkO,MAAMe,WACXjP,KAAK0V,wBAIDA,mBAAoB,MAGrBC,EAAc3V,KAAK6U,sBAAsBvK,EAASzE,EAAOgB,GAG7DkN,WAAY,WACX6B,EAAKJ,oBAAqB,EAC1BI,EAAKxC,gBAAiBwC,EAAKpC,MAAMlJ,QAASqL,GAC1CC,EAAK1B,SAAS,CAAE5J,QAASqL,MAMvB9O,IAAU7G,KAAK2U,eAAiB9O,EAAMgB,GAAOpH,MAAQO,KAAK4U,sBACxDc,kBAAoB,CACxBnF,QAASvQ,KAAK2U,cACd7D,SAAUjK,QAEN2O,oBAAqB,OACrBb,cAAgB9N,OAChB+N,eAAiB/O,EAAMgB,GAAOpH,SAC9BoW,wDAQWC,EAAYjQ,EAAOC,cAChCuF,EAAQxF,EAAMxF,OACdiK,mBAAewL,GACfC,mBAAqBD,GACrBE,GAAU,SAEdnQ,EAAMrG,QAAS,WAAUqC,OAAPpC,IAAAA,OACbsW,EAActW,iBACHsW,EAActW,GAG7BuW,GAAU,EAEV1L,EAAS7K,GAAQ,CAChB8P,OAAQ1N,EACRwJ,MAAOA,EACPG,SAAU1F,EAAcjE,EACxBsJ,WAAY,IAAI+B,qBAASC,MAAOrH,EAAcjE,GAC9C3B,OAAQ+V,EAAK/H,MAAMkB,iBAKrB9P,OAAOC,KAAMwW,GAAgBvW,QAAS,SAAAC,UAC9B6K,EAAQ7K,GACfuW,GAAU,IAGJA,EAAU1L,EAAUwL,gDAOLA,EAAYjQ,EAAOC,cACrCwE,mBAAgBwL,GAChBzK,EAAQxF,EAAMxF,cAElBwF,EAAMrG,QAAS,WAAQqC,OAANpC,IAAAA,IACZoH,EAAQ,CACX0I,OAAQ1N,EACRwJ,MAAOA,EACPG,SAAU1F,EAAcjE,EACxBsJ,WAAYb,EAAQ7K,GAAK0L,WACzBjL,OAAQgW,EAAKhI,MAAMkB,eAGpB9E,EAAQ7K,GAAOoH,IAGTyD,0CAGS6L,EAAaR,OACzBS,EAAUC,EAAUtE,cAGnB7D,MAAMrI,MAAMrG,QAAS,SAAA6H,OACnB5H,EAAgB4H,EAAhB5H,IAAK2I,EAAWf,EAAXe,OAEPkO,EAAYH,EAAY1W,GACxB8W,EAAYZ,EAAYlW,MAED,IAAvB6W,EAAU9K,WACb4K,EAAW/O,GAEe,IAAvBkP,EAAU/K,WACb6K,EAAWhP,EACX0K,EAAUuE,EAAU9K,UAGjB8K,GAAaC,GAAaD,EAAU9K,WAAa+K,EAAU/K,SAAU,KACpEL,EAAaqL,EAAKtB,oBAAqB9M,GAC3C8E,qBAASG,OAAQkJ,EAAUpL,WAAY,CACtCmC,QAASiJ,EAAU/K,SACnBV,OAAQK,EAAWL,OACnBG,SAAUE,EAAWF,UAAY,IACjCwL,iBAAkBzG,UAChBpN,WAKDwT,GAAYC,QACVZ,QAAQrC,gBACZpT,KAAK0W,iBAAiBN,GACtBpW,KAAK0W,iBAAiBL,GACtBtE,EACAqE,EAAShO,OAAOoI,wDAKDnJ,OACb9H,EAAO,CAAC8H,EAAK5H,KACb0H,EAAOE,EAAKF,YAEZA,IACH5H,EAAOA,EAAK2C,OACXlC,KAAK0W,iBAAkBvP,EAAKtB,MAAMsB,EAAKrB,gBAIlCvG,yCAGQuB,QACVgU,aAAchU,GAAO,2CAGTA,UACVd,KAAK8U,aAAahU,4BA7QNiO,wBACD,CAClBrJ,OAAQ0M,UAAUC,OAClBnD,iBAAkBkD,UAAUC,OAC5BiD,gBAAiBlD,UAAUC,OAC3BkD,aAAcnD,UAAUC,OACxBxM,MAAOuM,UAAUuE,MACjB9P,MAAOuL,UAAUE,OACjB/H,OAAQ6H,UAAUC,yBARCtD,2BAWE,CACrBuG,gBAAiB,GACjBC,aAAc,qBAbKxG,0BAgBCjB,WAiQtB,IAAIzD,SAASoF,uBAAW3Q,OAAO,CAC9BwP,UAAW,CACVsI,KAAM,EACNjH,SAAU,WACVrE,OAAQ,GAET0D,OAAQ,GACRnJ,MAAO,CACN8L,OAAQ,OAAQlH,MAAO,UC9RJoM,oCACR3I,wGACLA,KACDC,kBAAmBD,EAAM5D,QAAS4D,EAAM3D,6BAHL6D,oEAOpCC,EAAkB,CACrBhE,SAAOiE,UACPtO,KAAKkL,gBAGF7D,EAAOrH,KAAKkO,MAAMrI,MAAM,GACxBiR,EAAUzP,EAAO0G,6BAAC1G,EAAKe,aAAY2F,6BAACS,8BAGvCT,6BAACb,qBAASsB,MAAKC,MAAQJ,GACpByI,yCAKUzP,UACVA,GAAQA,IAASrH,KAAKqH,YACpBA,KAAOA,GAENrH,KAAKqH,+CAGMiD,EAASC,QACtBW,eAAiBA,eAAgBlL,KAAKkO,MAAM/C,WAAYb,EAASC,qDAG5C8E,GACtBrP,KAAKsP,iBAAkBD,SACrBlB,kBAAmBkB,EAAU/E,QAAS+E,EAAU9E,iDAIrC8E,MACZA,EAAU/E,aAETG,EAAU4E,EAAU9E,OAApBE,MACAsM,EAAY1H,EAAU/E,QAAtByM,UACoB/W,KAAKkO,MAAzB3D,IAAAA,OAAQD,IAAAA,eAGbG,IAAUF,EAAOE,OACjBsM,IAAYzM,EAAQyM,kBAKnB1M,SAASoF,uBAAW3Q,OAAO,CAC9BwP,UAAW,CACVoB,SAAU,SACVC,SAAU,WACVlF,MAAO,OAAQkH,OAAQ,OACvB/B,IAAK,EAAGC,KAAM,EACdvE,OAAO,GACP0L,YAAa,OACbC,cAAe,GACfC,aAAc,GACdC,UAAW,KC/DTC,YAAc,GAEGC,qCACRnJ,iGACLA,KACDoJ,YAAc,MAEdC,UAAY,IAAIrK,qBAASC,MAAM,KAC/BqK,yBAEAhE,MAAQ,CACZiE,MAAM,KAGFC,iBAAmB,CACvB1L,UAAW,CAAC,CAACtB,WAAY2F,EAAKsH,YAAYhM,YAAY,CACrDhB,WAAY,CAAC,EAAG,IAAM,GACtBC,YAAa,EAAG,IAAO,EAAG,OAE3BC,QAASwF,EAAKsH,YAAYhM,YAAY,CACrChB,WAAY,CAAC,EAAE,EAAE,EAAE,GACnBC,YAAa,CAAC,EAAE,EAAE,GAAG,WAIjBgN,EAAgB,CACrBH,KAAM,kBAAMpH,EAAKwH,cACjBC,MAAO,kBAAMzH,EAAK0H,yBAEdC,eAAiBJ,uBA3BmBxJ,oEAgCrC6J,EAAQC,WAD0BlY,KAAKkO,MAArCiK,IAAAA,OAAQzS,IAAAA,OAAQ0S,IAAAA,YAElBA,IACHH,EAASlK,6BAACS,kBAAKC,MAAQpE,SAAO4N,SAC9BC,EACAnK,6BAACb,qBAASsB,MAAKC,MAAQ,CAACpE,SAAO6N,QAASlY,KAAK0X,kBAC5CW,QAAU,kBAAM1J,EAAKoJ,sBAInBtN,EAAQzK,KAAKwT,MAAMiE,KAA0B,EAAnBzX,KAAKsX,YAAkBtX,KAAKsX,YAAcF,YAEpE/I,EAAkB,CACrBhE,SAAOiE,UACP8J,GAAe/N,SAAOiO,qBACtBF,GAAe,CAAC3N,MAAAA,EAAOoF,KAAMuH,YAAcpX,KAAKsX,aAChDtX,KAAKkL,gBAGFqN,EAAe,CAClBlO,SAAO2E,OACPoJ,GAAe/N,SAAOmO,mBAGnBC,EAAa,CAChB,CAAE7G,EAAG,EAAG9Q,GAAI,UAAY,CAAC8Q,EAAG5R,KAAKsX,YAAcF,YAAc,GAAItW,GAAI,gBAIrEiN,6BAACb,qBAASsB,MAAKC,MAAQJ,GACpB6J,EACFnK,6BAAC2K,aAAalK,MAAKmK,cAAgBP,EAClCQ,IAAI,SACJC,gBAAiB,EAAOJ,WAAaA,EACrCK,WAAY,CAAC/I,MAAO/P,KAAKsX,YAAcF,YAAa2B,OAAQ,GAC5DC,OAAS,SAAAjE,UAAKpG,EAAKqK,OAAQjE,IAC3BkE,eAAiBjZ,KAAKuX,WACtBxJ,6BAACS,kBAAKC,MAAQ8J,EAAeK,IAAI,SAASlK,SAAW,SAAAqG,UAAKpG,EAAKqG,aAAaD,KAC3EhH,6BAACoK,GAAOzS,OAASA,EAASsJ,OAAShP,KAAKgY,iBACtCC,0CAOOlD,OACRxK,EAAUwK,EAAEM,YAAZ9K,YAEAW,eAAiBA,eAAelL,KAAKkO,MAAM/C,WAAYnL,KAAKkO,MAAM5D,QAASC,QAC3E+M,YAAc/M,EAAOE,WACrB+M,4BACA3B,yDAGaqD,cACdA,EAAUd,cAAgBpY,KAAKkO,MAAMkK,kBACnCb,UAAU4B,SAAS,GAErBD,EAAUjK,aAAejP,KAAKkO,MAAMe,iBAClCmK,KAAK7O,OAAO4I,QAAS,SAACkG,EAAIC,EAAI7O,EAAOkH,EAAQC,EAAGC,GACpDsC,EAAKa,aAAa,CAAEK,YAAa,CAAC9K,OAAQ,CAACE,MAAAA,EAAOkH,OAAAA,EAAQC,EAAAA,EAAGC,EAAAA,2DAM3D0H,EAAKvZ,KAAK2X,YACV9Q,EAAQ7G,KAAKuX,UAAU5L,YAAY,CACtChB,WAAY,CAAC,EAAG3K,KAAKsX,aACrB1M,YAAa,CAAC,EAAG,KAGd2O,GACHA,EAAGC,QAAU3S,EAAM2S,QACnBD,EAAGE,eAAiB5S,EAAM4S,qBAGrB9B,YAAc9Q,0CAKf7G,KAAKkO,MAAMkK,cAAepY,KAAKwT,MAAMiE,UAEtCzI,EAAShP,KAAKoZ,KAAKpK,YAClBkF,SAAS,CAACuD,MAAM,IACrBzI,GAAUA,EAAO0K,YAAY,CAAC9H,EAAG,gDAI5B5R,KAAKkO,MAAMkK,aAAgBpY,KAAKwT,MAAMiE,UAEvCzI,EAAShP,KAAKoZ,KAAKpK,YAClBkF,SAAS,CAACuD,MAAM,IACrBzI,GAAUA,EAAO0K,YAAY,CAAC9H,GAAI,sCAG3BmD,GACHA,EAAEM,cAAcN,EAAIA,EAAEM,aAEV,UAAZN,EAAEvB,WACAU,SAAS,CAACuD,MAAM,IAED,QAAZ1C,EAAEvB,OAA2C,WAAxBuB,EAAE4E,wBAC1BzF,SAAS,CAACuD,MAAM,aAKpBpN,SAASoF,uBAAW3Q,OAAO,CAC9BwP,UAAW,CACVsL,cAAe,OAEhBtB,qBAAsB,CACnB3I,SAAU,WACZC,IAAK,EAAGE,OAAQ,EAChBxE,OAAQ,KAET0D,OAAQ,CAEPY,IAAK,EAAGC,KAAM,EACd8B,OAAQ,OAAQlH,MAAO,OACvBmM,KAAM,GAEP4B,kBAAmB,CAChB3I,KAAM,EACNpF,MAAO,OACPmM,KAAM,EACRjH,SAAU,WACVrE,OAAQ,IACRuO,aAAczC,aAEfa,OAAQ,CACPxN,MAAO2M,YACPxH,IAAK,EAAGE,OAAQ,EAAGC,MAAO,EAE1BJ,SAAU,WACVrE,OAAQ,IAET4M,QAAS,CACR4B,gBAAiB,QACjBnI,OAAQ,OACRlH,MAAO,OACPkF,SAAU,YAEXoK,SAAU,CACTpK,SAAU,WACVgC,OAAQ,OACR/B,IAAK,EAAGC,KAAM,EAAGC,OAAQ,uBCzLZ,CACdzF,OAAQ,SAAkCC,EAASC,OAC9CyP,EAAa1P,EAAQiF,OAAS,IAAM,QACjC,CACN9E,MAAO,CACNE,WAAY,EAAG,GAAI,EAAG,EAAG,EAAG,EAAG,GAC/BC,YAAa,CAAE,EAAG,EAAGL,EAAOE,MAAQuP,EAAY,IAAK,EAAG,IAGzDtP,WAAY,CACXC,WAAY,EAAG,GAAI,EAAG,EAAG,EAAG,GAC5BC,YAAa,CAAEL,EAAOE,MAAOF,EAAOE,MAAOuP,EAAY,EAAG,MAI7DlP,OAAQC,mBAAOC,OACfC,SAAU,sBClBI,CACdZ,OAAQ,SAAkCC,EAASC,SAC3C,CACNG,WAAY,CACXC,WAAY,EAAG,GAAI,EAAG,EAAG,GACzBC,YAAa,CAAEL,EAAOE,MAAOF,EAAOE,MAAO,EAAG,IAE/CI,QAAS,CACRF,WAAY,EAAG,GAAI,EAAG,EAAG,GAAI,GAC7BC,YAAa,CAAE,EAAG,EAAG,EAAG,EAAG,IAE5B2B,MAAO,CACN5B,WAAY,EAAG,EAAG,EAAG,EAAG,GACxBC,YAAa,CAAE,EAAG,EAAG,GAAI,OAI5BK,SAAU,IACVuN,mBAAmB,GChBhByB,eAAiB,CACpB5P,OAAQ,CACPqC,WAAY,CACX/B,WAAY,CAAE,EAAG,GACjBC,YAAa,EAAG,IAAK,IAEtBC,QAAS,CACRF,WAAY,CAAE,EAAG,GACjBC,YAAa,CAAE,EAAG,KAGpBE,OAAQC,mBAAOC,OACfC,SAAU,qBAGI,CACdpF,MAAOoU,eACPjL,OAAQiL,eACRhU,MAAM,CACLoE,OAAQ,SAAiCC,EAASC,SAC1C,CACNmC,WAAY,CACX/B,WAAY,CAAE,EAAG,GACjBC,YAAa,CAAEL,EAAOoH,OAAQ,MAIjC7G,OAAQC,mBAAOC,OACfC,SAAU,MCjBN+E,QAAwB,QAAhBC,qBAASC,GAEFgK,iCACPhM,wGACLA,KAEFsF,MAAQ,CACZjJ,OAAQ8F,EAAK8J,mBAGTC,oBAAqBlM,EAAMmM,YAAahK,EAAKmD,MAAMjJ,OAAOE,SAE1D6P,eAAiB9Q,QAAS6G,EAAKiK,kBAC/BC,QAAUlK,EAAKkK,QAAQtQ,kCAEvB+E,OAAS,CACbyI,KAAM,kBAAMpH,EAAKmK,eAAe3C,cAChCC,MAAO,kBAAMzH,EAAKmK,eAAezC,gBAGlC0C,wBAAYC,iBAAkB,oBAAqBrK,EAAKkK,8BAlBnBnM,2EAkCjC1I,EAAS1F,KAAK0F,WACbA,EAAS,OAAO,WAEkB1F,KAAKkO,MAAtCyM,IAAAA,qBAAiBN,YACGra,KAAKwT,OAAzBjJ,IAAAA,OAAQD,IAAAA,QAEVa,EAAanL,KAAK4a,kBAClB3L,EAAajP,KAAK6a,kBAClBC,EAAkB9a,KAAK+a,oBAAqB5P,KACzBnL,KAAKsa,eAAgB5U,EAAOG,MAAOH,EAAOI,aAA3DD,IAAAA,MAAOgB,IAAAA,aAGZkH,6BAAC0G,sBAAqB/O,OAAQA,EAAQ6E,OAAQA,GAC7CwD,6BAACS,kBAAKC,MAAQpE,SAAO2Q,eACpBjN,6BAACS,kBAAKC,MAAOpE,SAAOiE,UAAWI,SAAW,SAAAqG,UAAKpG,EAAKsM,UAAWlG,EAAEM,YAAY9K,UAC5EwD,6BAACsJ,eAAcuB,IAAM,SAAAsC,UAAavM,EAAK6L,eAAiBU,GACvDxV,OAAQA,EACRyF,WAAY2P,EAAgB9L,OAC5BC,WAAaA,EACb3E,QAASA,EAAQzE,MACjBuS,YAAcjN,EAAWqN,kBACzBL,OAASwC,IACV5M,6BAACgB,aAAYrJ,OAAQA,EACpBwJ,iBAAkB/D,EAClBmK,gBAAiBwF,EAAgBjV,MACjC0P,aAAcjL,EAAQzE,MACtBoJ,WAAaA,EACbpJ,MAAOA,EACPgB,MAAOA,EACP0D,OAAQA,EACRyE,OAAQhP,KAAKgP,SACdjB,6BAAC8I,cAAanR,OAAQA,EACrBG,MAAOH,EAAOO,MAAMJ,MACpBgB,MAAOnB,EAAOO,MAAMJ,MACpBsF,WAAY2P,EAAgB7U,MAC5BgJ,WAAaA,EACb3E,QAASA,EAAQrE,MACjBsE,OAAQA,EACRyE,OAAQhP,KAAKgP,wDAOEqL,EAAa5P,WAC7B0Q,EAAc7b,OAAOC,KAAM8a,GAAce,KAAM,SAAC3c,EAAE4c,UAAM5c,EAAI4c,IAC5DxZ,EAAIsZ,EAAY9a,OAEbwB,KAAM,MACR4I,GAAS6Q,SAAUH,EAAYtZ,gBAC7B+Y,kBAAoBP,EAAac,EAAYtZ,cAC7CgZ,kBAAoBS,SAASH,EAAYtZ,UAK3C+Y,kBAAoBP,EAAac,EAAY,SAC7CN,kBAAoBS,SAASH,EAAY,gDAG1BhQ,UACZA,GAAcnL,KAAK4a,mBAClBE,iBAAmBA,uDAIbS,EAAaC,OACxB3V,EAAQ0V,EAAYnZ,QACpByE,EAAQ2U,EACRC,EAAYF,EAAYlb,OAAS,SAC1BwF,EAAO4V,GACCrT,OAAOsT,iBAAmB,IAEjCzV,QACXJ,EAAMf,MACF+B,IAAU4U,GACb5U,KAIK,CAAChB,MAAAA,EAAOgB,MAAAA,oDAIXnB,EAASiW,OAAc3b,KAAKkO,MAAMnO,QAElC6b,EAAc5b,KAAKkO,MAAM0N,YACzBA,GACHlW,EAAOlC,eAAgBoY,QAGnBC,GAAK,kBAAM1H,EAAK0B,eACrBnQ,EAAO7C,SAAU,kBAAMsR,EAAK0H,OAC5BnW,EAAO9C,aAEF8C,OAASA,OAEToW,aAAe9b,KAAK+b,mBACpBC,mBAAoBhc,KAAK8b,4DAING,uBAAWC,IAAI,gBAChC,CACNzR,QAFKA,MAEEkH,SAFKA,OAEGC,EAAG,EAAGC,EAAG,oDAKpBsK,kEAIAN,GAAK,aACVpB,wBAAY2B,oBAAqB,oBAAqBpc,KAAKua,oDAGxCrB,OACfmD,EAAYrc,KAAK+b,cACjB/b,KAAK8b,eAAiBO,SACpBP,aAAeO,OACfL,mBAAoBK,IAGtBnD,EAAUoD,eAAiBtc,KAAKkO,MAAMoO,mBACpClC,oBAAqBpa,KAAKkO,MAAMmM,YAAara,KAAKwT,MAAMjJ,OAAOE,yCAI3DF,GACVpK,QAAQ+R,IAAK3H,QACR6P,oBAAqBpa,KAAKkO,MAAMmM,YAAa9P,EAAOE,YACpDyJ,SAAU,CAAC3J,OAAAA,0CAMZgS,EAFA7W,EAAS1F,KAAK0F,OACdG,EAAQH,EAAOG,SAEfH,EAAOO,MAAMC,OAEfqW,EADG7W,EAAOO,MAAMH,YACJJ,EAAOO,MAAMJ,MAAOH,EAAOO,MAAMH,YAAc,GAAIrF,MAG/D8b,EAAY1W,EAAOH,EAAOI,aAActE,UAClBO,SAAWwa,EAAUja,OAGpCoD,EAAOI,cACfyW,EAAY1W,EAAOH,EAAOI,YAAc,GAAIrF,MAGzC8b,SACH7W,EAAOU,SAAUmW,IACV,+CAKDvc,KAAK0F,OAAOO,MAAMC,kDAGNmW,OACd/R,EAAWtK,KAAKwT,MAAhBlJ,WAEAA,EAMA,KACA+P,EAAcra,KAAK+a,sBAEvBzQ,EAAU,CACTrE,MAAO,CAAC8Q,UAAWsF,EAAWlR,WAAYb,EAAQrE,MAAMkF,YACxDtF,MAAO,CAACkR,SAAUsF,EAAWlR,WAAYb,EAAQzE,MAAMsF,aAGxD+B,qBAASG,OAAQ/C,EAAQrE,MAAMkF,WAAY,CAC1CmC,QAAS+O,EAAY,EAAI,EACzBvR,OAAQuP,EAAYpU,MAAM6E,OAC1BG,SAAUoP,EAAYpU,MAAMgF,UAAY,IACxCwL,iBAAkBzG,UAChBpN,QAEHsK,qBAASG,OAAQ/C,EAAQzE,MAAMsF,WAAY,CAC1CmC,QAAS+O,EAAY,EAAI,EACzBvR,OAAQuP,EAAYxU,MAAMiF,OAC1BG,SAAUoP,EAAYxU,MAAMoF,UAAY,IACxCwL,iBAAkBzG,UAChBpN,aAzBH0H,EAAU,CACTrE,MAAO,CAAC8Q,UAAWsF,EAAWlR,WAAY,IAAI+B,qBAASC,MAAOkP,EAAY,EAAI,IAC9ExW,MAAO,CAACkR,SAAUsF,EAAWlR,WAAY,IAAI+B,qBAASC,MAAOkP,EAAY,EAAI,UA0B1EnI,SAAS,CAAC5J,QAAAA,6BArOI4P,sBAqBD,CAClBG,YAAajI,UAAUC,OACvBuJ,YAAaxJ,UAAUoK,uBAvBJtC,yBA0BE,CACrBG,YAAa,GACToC,qBACEC,qBA4MR,IAAIC,gBAAkC,YAAhB1M,qBAASC,GAAmB0M,sBAAUC,cAAgB,EACxD,QAAhB5M,qBAASC,KAEZyM,gBAAkB,IAGnB,IAAItS,SAASoF,uBAAW3Q,OAAO,CAC9Bkc,cAAe,CACd8B,WAAYH,gBACZ/F,KAAM,GAGPtI,UAAW,CACVsI,KAAM,EACNgD,cAAe,MACflK,SAAU,YCjQNM,QAAwB,QAAhBC,qBAASC,GAEjB6M,qCAgBO7O,uGACLA,IACNA,EAAM8O,GAAGxK,mCAAgBtE,wBAlBCE,kFAuBzBL,6BAACS,kBAAKC,MAAQzO,KAAKkO,MAAMO,MACxBmK,IAAI,KACJlK,SAAW,kBAAMC,EAAKsM,aACtBvK,cAAc,QACZ1Q,KAAKkO,MAAM/M,8DAMV+M,MAAM8O,GAAGrK,WAAY3S,sCAGlBiT,sBACH1B,KAAM,GAENvB,UAAUhQ,KAAKid,gBAEnB9c,QAAQ+R,IAAI,YACL6B,WAAY,kBAAMI,EAAKhB,QAASF,UAGnCmG,KAAKlG,IAAMlT,KAAKoZ,KAAKlG,GAAGC,QAAS,SAAE+J,EAAIC,EAAI1S,EAAOkH,EAAQC,EAAGC,GACjEsC,EAAK5C,IAAM,CACV9G,MAAAA,EAAOkH,OAAAA,EACPC,EAAGA,EAAIqB,EAAOrB,EACdC,EAAGA,EAAIoB,EAAOpB,GAGf1R,QAAQ+R,IAAI,uDAKR+K,UAAW,WAIlB,SAASG,mBAAoBhP,UACrB,SAA2BF,UAGhCH,6BAACD,UAAQuP,cACN,SAAAL,UACDjP,6BAACuP,QAAeD,cACb,SAAA3K,UACD3E,6BAACK,cAAcF,GAAO8O,GAAIA,EAAItK,QAASA,0BArExCqK,0BACc,CAElB5R,WAAYiH,UAAUmL,MAAM,CAAEnL,UAAUC,OAAQD,UAAUoK,OAC1D3L,iBAAkBuB,UAAUoK,KAC5BpL,gBAAiBgB,UAAUE,OAI3BkC,SAAUpC,UAAUoL,yBAThBT,6BAYiB,IAkEvB,IAAMU,yBAA2BL,mBAAoBL"}