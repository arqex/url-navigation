{"version":3,"file":"urlstack.js","sources":["../../urlhub/node_modules/path-to-regexp/index.js","../../urlhub/node_modules/q-flat/dist/index.js","../../urlhub/node_modules/q-set/dist/index.js","../../urlhub/node_modules/mini-querystring/dist/index.js","../../urlhub/urlhub.js","../../urlhub/nodeStrategy.js","../../urlhub/hashStrategy.js","../../urlhub/pushStrategy.js","../urlstack.js"],"sourcesContent":["var isarray = require('isarray')\n\n/**\n * Expose `pathToRegexp`.\n */\nmodule.exports = pathToRegexp\nmodule.exports.parse = parse\nmodule.exports.compile = compile\nmodule.exports.tokensToFunction = tokensToFunction\nmodule.exports.tokensToRegExp = tokensToRegExp\n\n/**\n * The main path matching regexp utility.\n *\n * @type {RegExp}\n */\nvar PATH_REGEXP = new RegExp([\n  // Match escaped characters that would otherwise appear in future matches.\n  // This allows the user to escape special characters that won't transform.\n  '(\\\\\\\\.)',\n  // Match Express-style parameters and un-named parameters with a prefix\n  // and optional suffixes. Matches appear as:\n  //\n  // \"/:test(\\\\d+)?\" => [\"/\", \"test\", \"\\d+\", undefined, \"?\", undefined]\n  // \"/route(\\\\d+)\"  => [undefined, undefined, undefined, \"\\d+\", undefined, undefined]\n  // \"/*\"            => [\"/\", undefined, undefined, undefined, undefined, \"*\"]\n  '([\\\\/.])?(?:(?:\\\\:(\\\\w+)(?:\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))?|\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))([+*?])?|(\\\\*))'\n].join('|'), 'g')\n\n/**\n * Parse a string for the raw tokens.\n *\n * @param  {string}  str\n * @param  {Object=} options\n * @return {!Array}\n */\nfunction parse (str, options) {\n  var tokens = []\n  var key = 0\n  var index = 0\n  var path = ''\n  var defaultDelimiter = options && options.delimiter || '/'\n  var res\n\n  while ((res = PATH_REGEXP.exec(str)) != null) {\n    var m = res[0]\n    var escaped = res[1]\n    var offset = res.index\n    path += str.slice(index, offset)\n    index = offset + m.length\n\n    // Ignore already escaped sequences.\n    if (escaped) {\n      path += escaped[1]\n      continue\n    }\n\n    var next = str[index]\n    var prefix = res[2]\n    var name = res[3]\n    var capture = res[4]\n    var group = res[5]\n    var modifier = res[6]\n    var asterisk = res[7]\n\n    // Push the current path onto the tokens.\n    if (path) {\n      tokens.push(path)\n      path = ''\n    }\n\n    var partial = prefix != null && next != null && next !== prefix\n    var repeat = modifier === '+' || modifier === '*'\n    var optional = modifier === '?' || modifier === '*'\n    var delimiter = res[2] || defaultDelimiter\n    var pattern = capture || group\n\n    tokens.push({\n      name: name || key++,\n      prefix: prefix || '',\n      delimiter: delimiter,\n      optional: optional,\n      repeat: repeat,\n      partial: partial,\n      asterisk: !!asterisk,\n      pattern: pattern ? escapeGroup(pattern) : (asterisk ? '.*' : '[^' + escapeString(delimiter) + ']+?')\n    })\n  }\n\n  // Match any characters still remaining.\n  if (index < str.length) {\n    path += str.substr(index)\n  }\n\n  // If the path exists, push it onto the end.\n  if (path) {\n    tokens.push(path)\n  }\n\n  return tokens\n}\n\n/**\n * Compile a string to a template function for the path.\n *\n * @param  {string}             str\n * @param  {Object=}            options\n * @return {!function(Object=, Object=)}\n */\nfunction compile (str, options) {\n  return tokensToFunction(parse(str, options))\n}\n\n/**\n * Prettier encoding of URI path segments.\n *\n * @param  {string}\n * @return {string}\n */\nfunction encodeURIComponentPretty (str) {\n  return encodeURI(str).replace(/[\\/?#]/g, function (c) {\n    return '%' + c.charCodeAt(0).toString(16).toUpperCase()\n  })\n}\n\n/**\n * Encode the asterisk parameter. Similar to `pretty`, but allows slashes.\n *\n * @param  {string}\n * @return {string}\n */\nfunction encodeAsterisk (str) {\n  return encodeURI(str).replace(/[?#]/g, function (c) {\n    return '%' + c.charCodeAt(0).toString(16).toUpperCase()\n  })\n}\n\n/**\n * Expose a method for transforming tokens into the path function.\n */\nfunction tokensToFunction (tokens) {\n  // Compile all the tokens into regexps.\n  var matches = new Array(tokens.length)\n\n  // Compile all the patterns before compilation.\n  for (var i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] === 'object') {\n      matches[i] = new RegExp('^(?:' + tokens[i].pattern + ')$')\n    }\n  }\n\n  return function (obj, opts) {\n    var path = ''\n    var data = obj || {}\n    var options = opts || {}\n    var encode = options.pretty ? encodeURIComponentPretty : encodeURIComponent\n\n    for (var i = 0; i < tokens.length; i++) {\n      var token = tokens[i]\n\n      if (typeof token === 'string') {\n        path += token\n\n        continue\n      }\n\n      var value = data[token.name]\n      var segment\n\n      if (value == null) {\n        if (token.optional) {\n          // Prepend partial segment prefixes.\n          if (token.partial) {\n            path += token.prefix\n          }\n\n          continue\n        } else {\n          throw new TypeError('Expected \"' + token.name + '\" to be defined')\n        }\n      }\n\n      if (isarray(value)) {\n        if (!token.repeat) {\n          throw new TypeError('Expected \"' + token.name + '\" to not repeat, but received `' + JSON.stringify(value) + '`')\n        }\n\n        if (value.length === 0) {\n          if (token.optional) {\n            continue\n          } else {\n            throw new TypeError('Expected \"' + token.name + '\" to not be empty')\n          }\n        }\n\n        for (var j = 0; j < value.length; j++) {\n          segment = encode(value[j])\n\n          if (!matches[i].test(segment)) {\n            throw new TypeError('Expected all \"' + token.name + '\" to match \"' + token.pattern + '\", but received `' + JSON.stringify(segment) + '`')\n          }\n\n          path += (j === 0 ? token.prefix : token.delimiter) + segment\n        }\n\n        continue\n      }\n\n      segment = token.asterisk ? encodeAsterisk(value) : encode(value)\n\n      if (!matches[i].test(segment)) {\n        throw new TypeError('Expected \"' + token.name + '\" to match \"' + token.pattern + '\", but received \"' + segment + '\"')\n      }\n\n      path += token.prefix + segment\n    }\n\n    return path\n  }\n}\n\n/**\n * Escape a regular expression string.\n *\n * @param  {string} str\n * @return {string}\n */\nfunction escapeString (str) {\n  return str.replace(/([.+*?=^!:${}()[\\]|\\/\\\\])/g, '\\\\$1')\n}\n\n/**\n * Escape the capturing group by escaping special characters and meaning.\n *\n * @param  {string} group\n * @return {string}\n */\nfunction escapeGroup (group) {\n  return group.replace(/([=!:$\\/()])/g, '\\\\$1')\n}\n\n/**\n * Attach the keys as a property of the regexp.\n *\n * @param  {!RegExp} re\n * @param  {Array}   keys\n * @return {!RegExp}\n */\nfunction attachKeys (re, keys) {\n  re.keys = keys\n  return re\n}\n\n/**\n * Get the flags for a regexp from the options.\n *\n * @param  {Object} options\n * @return {string}\n */\nfunction flags (options) {\n  return options.sensitive ? '' : 'i'\n}\n\n/**\n * Pull out keys from a regexp.\n *\n * @param  {!RegExp} path\n * @param  {!Array}  keys\n * @return {!RegExp}\n */\nfunction regexpToRegexp (path, keys) {\n  // Use a negative lookahead to match only capturing groups.\n  var groups = path.source.match(/\\((?!\\?)/g)\n\n  if (groups) {\n    for (var i = 0; i < groups.length; i++) {\n      keys.push({\n        name: i,\n        prefix: null,\n        delimiter: null,\n        optional: false,\n        repeat: false,\n        partial: false,\n        asterisk: false,\n        pattern: null\n      })\n    }\n  }\n\n  return attachKeys(path, keys)\n}\n\n/**\n * Transform an array into a regexp.\n *\n * @param  {!Array}  path\n * @param  {Array}   keys\n * @param  {!Object} options\n * @return {!RegExp}\n */\nfunction arrayToRegexp (path, keys, options) {\n  var parts = []\n\n  for (var i = 0; i < path.length; i++) {\n    parts.push(pathToRegexp(path[i], keys, options).source)\n  }\n\n  var regexp = new RegExp('(?:' + parts.join('|') + ')', flags(options))\n\n  return attachKeys(regexp, keys)\n}\n\n/**\n * Create a path regexp from string input.\n *\n * @param  {string}  path\n * @param  {!Array}  keys\n * @param  {!Object} options\n * @return {!RegExp}\n */\nfunction stringToRegexp (path, keys, options) {\n  return tokensToRegExp(parse(path, options), keys, options)\n}\n\n/**\n * Expose a function for taking tokens and returning a RegExp.\n *\n * @param  {!Array}          tokens\n * @param  {(Array|Object)=} keys\n * @param  {Object=}         options\n * @return {!RegExp}\n */\nfunction tokensToRegExp (tokens, keys, options) {\n  if (!isarray(keys)) {\n    options = /** @type {!Object} */ (keys || options)\n    keys = []\n  }\n\n  options = options || {}\n\n  var strict = options.strict\n  var end = options.end !== false\n  var route = ''\n\n  // Iterate over the tokens and create our regexp string.\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n\n    if (typeof token === 'string') {\n      route += escapeString(token)\n    } else {\n      var prefix = escapeString(token.prefix)\n      var capture = '(?:' + token.pattern + ')'\n\n      keys.push(token)\n\n      if (token.repeat) {\n        capture += '(?:' + prefix + capture + ')*'\n      }\n\n      if (token.optional) {\n        if (!token.partial) {\n          capture = '(?:' + prefix + '(' + capture + '))?'\n        } else {\n          capture = prefix + '(' + capture + ')?'\n        }\n      } else {\n        capture = prefix + '(' + capture + ')'\n      }\n\n      route += capture\n    }\n  }\n\n  var delimiter = escapeString(options.delimiter || '/')\n  var endsWithDelimiter = route.slice(-delimiter.length) === delimiter\n\n  // In non-strict mode we allow a slash at the end of match. If the path to\n  // match already ends with a slash, we remove it for consistency. The slash\n  // is valid at the end of a path match, not in the middle. This is important\n  // in non-ending mode, where \"/test/\" shouldn't match \"/test//route\".\n  if (!strict) {\n    route = (endsWithDelimiter ? route.slice(0, -delimiter.length) : route) + '(?:' + delimiter + '(?=$))?'\n  }\n\n  if (end) {\n    route += '$'\n  } else {\n    // In non-ending mode, we need the capturing groups to match as much as\n    // possible by using a positive lookahead to the end or next path segment.\n    route += strict && endsWithDelimiter ? '' : '(?=' + delimiter + '|$)'\n  }\n\n  return attachKeys(new RegExp('^' + route, flags(options)), keys)\n}\n\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n *\n * @param  {(string|RegExp|Array)} path\n * @param  {(Array|Object)=}       keys\n * @param  {Object=}               options\n * @return {!RegExp}\n */\nfunction pathToRegexp (path, keys, options) {\n  if (!isarray(keys)) {\n    options = /** @type {!Object} */ (keys || options)\n    keys = []\n  }\n\n  options = options || {}\n\n  if (path instanceof RegExp) {\n    return regexpToRegexp(path, /** @type {!Array} */ (keys))\n  }\n\n  if (isarray(path)) {\n    return arrayToRegexp(/** @type {!Array} */ (path), /** @type {!Array} */ (keys), options)\n  }\n\n  return stringToRegexp(/** @type {string} */ (path), /** @type {!Array} */ (keys), options)\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar _a = Object.prototype, toString = _a.toString, hasOwnProperty = _a.hasOwnProperty;\nvar OBJECT_TYPE = \"[object Object]\";\nvar ARRAY_TYPE = \"[object Array]\";\n/**\n * @description\n * Creates a querystring style object from a nested one.\n *\n * @example\n * var result = flatten({ a: { b: 1 }, c: { d: 1 } });\n * result; //-> { \"a[b]\": 1, \"c[d]\": 2 }\n *\n * @param obj The object to flatten.\n */\nfunction flatten(obj, path, result) {\n    var type = toString.call(obj);\n    if (result === undefined) {\n        if (type === OBJECT_TYPE) {\n            result = {};\n        }\n        else if (type === ARRAY_TYPE) {\n            result = [];\n        }\n        else {\n            return;\n        }\n    }\n    for (var key in obj) {\n        /* istanbul ignore if */\n        if (!hasOwnProperty.call(obj, key)) {\n            continue;\n        }\n        var val = obj[key];\n        if (val == null) {\n            continue;\n        }\n        switch (toString.call(val)) {\n            case ARRAY_TYPE:\n            case OBJECT_TYPE:\n                flatten(val, join(path, key), result);\n                break;\n            default:\n                result[join(path, key)] = val;\n                break;\n        }\n    }\n    return result;\n}\nexports.flatten = flatten;\n/**\n * Join path keys using query string `a[b]` style syntax.\n */\nfunction join(path, key) {\n    return path != null ? path + \"[\" + key + \"]\" : key;\n}\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar matchArray = /[^\\[\\]]+|\\[\\]/g;\nvar matchInteger = /^\\d+$/;\nvar temp = [];\n/**\n * @description\n * A setter for querystring style fields like \"a[b][c]\".\n * The setter will create arrays for repeat keys and supports the \"[]\" push syntax.\n *\n * @example\n * deep({}, \"a[b][c]\", 1) // { a: { b: { c: 1 } } }\n *\n * @param obj The object to set a value on.\n * @param path The querystring path to set.\n * @param value The value to set at the path.\n */\nfunction deep(obj, path, value) {\n    var keys = path === \"\" ? [\"\"] : path.match(matchArray);\n    var len = keys.length;\n    var cur = obj;\n    var prev;\n    var key;\n    var exists;\n    for (var i = 0; i < len; i++) {\n        prev = cur;\n        key = keys[i];\n        var next = keys[i + 1];\n        if (key === \"[]\") {\n            key = cur.length;\n        }\n        // Make path as we go.\n        cur = (exists = typeof cur === \"object\" && key in cur)\n            ? cur[key]\n            : // Check if the next path is an explicit array.\n                (cur[key] = next === \"[]\" || matchInteger.test(next) ? [] : {});\n    }\n    prev[key] = exists ? temp.concat(cur, value) : value;\n    return obj;\n}\nexports.deep = deep;\n/**\n * @description\n * Appends to an object using query string syntax with \"[]\" syntax push support.\n *\n * @example\n * shallow({}, \"a[b][c]\", 1) // { \"a[b][c]\": 1 }\n * shallow({}, \"a[]\", 1) // { a: [1] }\n *\n * @param obj The object to set a value on.\n * @param path The querystring path to set.\n * @param value The value to set at the path.\n */\nfunction shallow(obj, key, val) {\n    key = arrayPushIndexes(obj, key);\n    obj[key] = key in obj ? temp.concat(obj[key], val) : val;\n    return obj;\n}\nexports.shallow = shallow;\n/**\n * Given a qs style key and an object will convert array push syntax to integers.\n * Eg: a[b][] -> a[b][0]\n */\nfunction arrayPushIndexes(obj, key) {\n    var path = key.split(\"[]\");\n    if (path.length === 1) {\n        return key;\n    }\n    var cur = path[0];\n    var keys = Object.keys(obj);\n    for (var i = 1, len = path.length; i < len; i++) {\n        cur += \"[\" + findLastIndex(keys, cur) + \"]\" + path[i];\n    }\n    return cur;\n}\n/**\n * Given a path to push to will return the next valid index if possible.\n * Eg: a[b][] -> 0 // if array is empty.\n */\nfunction findLastIndex(keys, path) {\n    var last = -1;\n    for (var i = keys.length; i--;) {\n        var key = keys[i];\n        if (key.indexOf(path) !== 0) {\n            continue;\n        }\n        var index = Number(key.replace(path, \"\").slice(1, key.indexOf(\"]\") - 1));\n        if (index > last) {\n            last = index;\n        }\n    }\n    return last + 1;\n}\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar q_flat_1 = require(\"q-flat\");\nvar q_set_1 = require(\"q-set\");\nvar parseReg = /([^=?&]+)=?([^&]*)/g;\n/**\n * @description\n * Converts an object to a query string and optionally flattens it.\n *\n * @example\n * stringify({ a: 1 }) === 'a=1'\n *\n * stringify({ a: { b: 1 } }, true) === 'a[b]=1'\n *\n * @param obj The object to stringify.\n * @param deep If true the object will be flattened using query string syntax.\n */\nfunction stringify(obj, deep) {\n    if (deep) {\n        obj = q_flat_1.flatten(obj);\n    }\n    var keys = Object.keys(obj);\n    if (!keys.length) {\n        return \"\";\n    }\n    for (var i = 0, len = keys.length; i < len; i++) {\n        var key = keys[i];\n        keys[i] = encodeURIComponent(key) + \"=\" + encodeURIComponent(obj[key]);\n    }\n    return keys.join(\"&\");\n}\nexports.stringify = stringify;\n/**\n * @description\n * Parses a query string and optionally unflattens it.\n *\n * @example\n * parse('a=1&b=2&') === \"{ a: '1', b: '2' }\"\n *\n * parse('a=1&b[c]=2', true) === \"{ a: '1', b: { c: '1' } }\"\n *\n * @param str The string to parse.\n * @param deep If true, nested querystring paths will be resolved.\n */\nfunction parse(str, deep) {\n    var set = deep ? q_set_1.deep : q_set_1.shallow;\n    var result = {};\n    for (;;) {\n        var part = parseReg.exec(str);\n        if (!part) {\n            break;\n        }\n        var prop = part[1], val = part[2];\n        set(result, decodeURIComponent(prop), decodeURIComponent(val));\n    }\n    return result;\n}\nexports.parse = parse;\n//# sourceMappingURL=index.js.map","var parser = require('path-to-regexp');\r\nvar qs = require('mini-querystring');\r\n\r\n/*\r\nroutes = {\r\n  path: '/hola',\r\n  cb: fn,\r\n  children: []\r\n}\r\n*/\r\n\r\n// parseUrl function needed for testing\r\nvar parseUrl;\r\nif( typeof window !== 'undefined' ){\r\n  parseUrl = function( url ){\r\n    var a = document.createElement('a');\r\n    a.href = url;\r\n    return a;\r\n  };\r\n}\r\n\r\n// The lib\r\nvar urlhub = {\r\n  create: function( options ){\r\n    return new Urlhub( options );\r\n  },\r\n  joinUrls: joinUrls // just for testing never used, see helpers at bottom\r\n}\r\n\r\n\r\n// The class\r\nvar Urlhub = function( options ){\r\n  if( !options || !options.strategy ){\r\n    throw new Error('Router needs an strategy to listen to url changes.');\r\n  }\r\n\r\n  var s = options.strategy;\r\n\r\n  var ops = {};\r\n  Object.keys( options ).forEach( function( key ){\r\n    if( key === 'strategy' ) return;\r\n    ops[key] = options[key];\r\n  });\r\n\r\n  s.init && s.init( ops );\r\n  this.strategy = s;\r\n\r\n  // Callbacks before the route change\r\n  this.obc = [];\r\n\r\n  // Callbacks to be called on route change\r\n  this.cbs = [];\r\n}\r\n\r\nvar prototype = {\r\n  setRoutes: function( routes ){\r\n    this.routes = this.parseRoutes( routes );\r\n  },\r\n  // Route translation methods\r\n  parseRoutes: function( routes, parent ){\r\n    if( !routes ) console.warn( 'No routes provided to parseRoutes' );\r\n\r\n    if( !routes.length ){\r\n      routes = [routes];\r\n    }\r\n\r\n    var parsedRoutes = [],\r\n      me = this\r\n    ;\r\n\r\n    routes.forEach( function(r){\r\n      var path = joinUrls(parent, r.path);\r\n\r\n      var params = [],\r\n        parsed = {\r\n          regex: parser( path, params ),\r\n          id: path,\r\n          cb: r.cb\r\n        }\r\n      ;\r\n\r\n      parsed.params = params.map( function(p){ return p.name } );\r\n\r\n      if( r.children && r.children.length ){\r\n        parsed.childRegex = parser( path, [], {end: false} );\r\n        parsed.children = me.parseRoutes( r.children, path );\r\n      }\r\n\r\n      parsedRoutes.push( parsed );\r\n    });\r\n\r\n    return parsedRoutes;\r\n  },\r\n\r\n  match: function( location, candidates, isChild ){\r\n    var i = 0,\r\n      url = sanitizeUrl( location ),\r\n      path, found, match, c\r\n    ;\r\n\r\n    if( !candidates ){\r\n      candidates = this.routes;\r\n    }\r\n\r\n    var parsed = (this.strategy.parseUrl || parseUrl)( url );\r\n    path =  parsed.pathname;\r\n\r\n    // Normalize pathname\r\n    if( path[0] !== '/' ){\r\n      path = '/' + path;\r\n    }\r\n\r\n    while( i < candidates.length && !found ){\r\n      c = candidates[i];\r\n      if( c.childRegex ){\r\n        //console.log( 'failed', c.regex, path );\r\n        found = c.childRegex.exec( path );\r\n        if( found ){\r\n          match = this.match( url, c.children, true );\r\n          if( match.matches.length ){\r\n            match.matches = [c.cb].concat( match.matches );\r\n            match.matchIds = [c.id].concat( match.matchIds );\r\n            return match; // The recursive call will give all the info\r\n          }\r\n          else {\r\n            found = false;\r\n          }\r\n        }\r\n      }\r\n\r\n      found = c.regex.exec( path );\r\n      if( found ){\r\n        found = {\r\n          id: c.id, cb: c.cb, params: found.slice(1)\r\n        };\r\n      }\r\n\r\n      if( !found ){\r\n        i++;\r\n      }\r\n    }\r\n\r\n    var matches = [];\r\n    var matchIds = [];\r\n\r\n    if( found ){\r\n      matches.push( found.cb )\r\n      matchIds.push( found.id )\r\n    }\r\n    else if( !isChild ){\r\n      console.error('There is no route match for ' + location);\r\n    }\r\n\r\n    match = {\r\n      matches: matches,\r\n      matchIds: matchIds,\r\n      pathname: path,\r\n      search: parsed.search,\r\n      query: qs.parse( parsed.search ),\r\n      hash: parsed.hash,\r\n      route: found && found.id || false,\r\n      params: {}\r\n    };\r\n\r\n    if( found ){\r\n      c.params.forEach( function( p, i ){\r\n        match.params[ p ] = found.params[i];\r\n      });\r\n    }\r\n\r\n    return match;\r\n  },\r\n\r\n  // Routing methods\r\n  start: function(){\r\n    var me = this;\r\n    this.strategy.onChange( function(){\r\n      var change = me.checkChange();\r\n      if( !change.next ) return;\r\n\r\n      if( change.current !== change.next ){\r\n        me.strategy.replace( change.next );\r\n      }\r\n      else {\r\n        me.location = change.nextLocation;\r\n        me.cbs.forEach( function( cb ){\r\n          cb( change.nextLocation );\r\n        });\r\n      }\r\n    });\r\n\r\n    this.strategy.start();\r\n    this.location = this.match( this.strategy.getLocation() );\r\n    return this.location;\r\n  },\r\n  stop: function(){\r\n    this.strategy.onChange( function(){} );\r\n  },\r\n  refresh: function(){\r\n    var change = this.checkChange();\r\n    change.next && change.current !== change.next && this.strategy.replace( change.next );\r\n  },\r\n  checkChange: function(){\r\n    var current = this.strategy.getLocation(),\r\n      nextLocation = this.runOnBeforeChange( this.match(current) ),\r\n      next = nextLocation && (nextLocation.pathname + nextLocation.search + nextLocation.hash)\r\n    ;\r\n\r\n    return {current:current, next:next, nextLocation:nextLocation};\r\n  },\r\n  runOnBeforeChange: function( match ){\r\n    var me = this;\r\n\r\n    this.obc.forEach( function(cb){\r\n      if( match ){\r\n        match = cb( match );\r\n        if( typeof match === 'string' ){\r\n          match = me.match( match );\r\n        }\r\n      }\r\n    });\r\n\r\n    return match;\r\n  },\r\n  onBeforeChange: function( cb ){\r\n    this.obc.push( cb );\r\n  },\r\n  onChange: function( cb ){\r\n    this.cbs.push( cb );\r\n  },\r\n  push: function( location ){\r\n    this.updateLocation('push', location);\r\n  },\r\n  replace: function( location ){\r\n    this.updateLocation('replace', location);\r\n  },\r\n  back: function(){\r\n    this.strategy.back();\r\n  },\r\n  updateLocation: function( method, location ){\r\n    var current = this.strategy.getLocation();\r\n    var next;\r\n\r\n    if(typeof location === 'string'){\r\n      next = location;\r\n    }\r\n    else {\r\n      next = mergeLocations( this.match( current ), location );\r\n    }\r\n\r\n    var nextLocation = this.runOnBeforeChange( this.match(next) );\r\n    if( nextLocation ){\r\n      next = nextLocation.pathname + nextLocation.search + nextLocation.hash;\r\n      if( current !== next ){\r\n        this.strategy[ method ]( next );\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfor( var method in prototype ) Urlhub.prototype[ method ] = prototype[method];\r\n\r\nmodule.exports = urlhub;\r\n\r\n\r\n/********* HELPERS */\r\nfunction joinUrls( one, two ){\r\n  var first = sanitizeUrl(one),\r\n    second = sanitizeUrl(two)\r\n  ;\r\n\r\n  if( !one ) return second;\r\n  if( !two ) return first;\r\n\r\n  if( first === '/'){\r\n    return second;\r\n  }\r\n  else if( second === '/' ){\r\n    return first;\r\n  }\r\n  else {\r\n    return first + second;\r\n  }\r\n}\r\n\r\nfunction sanitizeUrl( url ){\r\n  if( !url ) return '/';\r\n  var sanitized = url;\r\n  if( sanitized[ sanitized.length - 1 ] === '/' ){\r\n    sanitized = sanitized.slice(0, sanitized.length - 1);\r\n  }\r\n  if( sanitized[0] !== '/' ){\r\n    sanitized = '/' + sanitized;\r\n  }\r\n  return sanitized;\r\n}\r\n\r\nfunction mergeLocations( prev, next ){\r\n  var location = Object.assign( prev, next ),\r\n    search = location.search\r\n  ;\r\n\r\n  if( Object.keys(location.query).length ){\r\n    search = '?' + qs.stringify( location.query );\r\n  }\r\n  else {\r\n    search = '';\r\n  }\r\n\r\n  return location.pathname + search + location.hash;\r\n}\r\n","var qs = require('mini-querystring');\r\nvar onChange = function () {};\r\n\r\nvar nodeStrategy = {\r\n  init: function( options ){\r\n\t\tthis.history = [ options.initialLocation || '/' ];\r\n  },\r\n  start: function(){\r\n    this.emit();\r\n  },\r\n  push: function( location ){\r\n\t\tthis.history.push( location );\r\n    this.emit();\r\n  },\r\n  replace: function( location ){\r\n\t\tthis.history[ this.history.length ] = location;\r\n    this.emit();\r\n  },\r\n  onChange: function( cb ){\r\n    onChange = cb;\r\n  },\r\n  getLocation: function(){\r\n    return this.history[ this.history.length - 1 ];\r\n  },\r\n  emit: function(){\r\n    onChange && onChange( this.getLocation() );\r\n\t},\r\n\tparseUrl: function( str ){\r\n\t\tvar parts = str.split('?')\r\n\t\tvar searchParts = parts[1] ? parts[1].split('#') : [];\r\n\t\treturn {\r\n\t\t\tpathname: parts[0],\r\n\t\t\tsearch: searchParts[0] ? '?' + searchParts[0] : '',\r\n\t\t\thash: searchParts[1] ? '#' + searchParts[1] : '',\r\n\t\t\tquery: searchParts[0] ? qs.parse( searchParts[0] ) : {}\r\n\t\t}\r\n  },\r\n  back: function(){\r\n    if( this.history.length > 1 ){\r\n      this.history.pop()\r\n    }\r\n    this.emit();\r\n  }\r\n};\r\n\r\nmodule.exports = nodeStrategy;","var onChange = function () {};\r\nvar hashStrategy = {\r\n\tinit: function (options) {\r\n\t},\r\n\r\n\tstart: function () {\r\n\t\tvar me = this;\r\n\r\n\t\tif (!location.hash) {\r\n\t\t\tlocation.hash = '#/';\r\n\t\t}\r\n\r\n\t\t// Register event listener\r\n\t\twindow.onhashchange = function () {\r\n\t\t\tme.emit();\r\n\t\t};\r\n\r\n\t\t// Emit first onChange\r\n\t\tme.emit();\r\n\t},\r\n\tpush: function (route) {\r\n\t\twindow.location.hash = '#' + route;\r\n\t},\r\n\treplace: function (route) {\r\n\t\tvar url = location.protocol + '//' + location.host + location.pathname + '#' + route;\r\n\r\n\t\tlocation.replace(url);\r\n\t},\r\n\tonChange: function (cb) {\r\n\t\tonChange = cb;\r\n\t},\r\n\tgetLocation: function () {\r\n\t\tif( !location.hash ){\r\n\t\t\treturn '/';\r\n\t\t}\r\n\t\telse if (location.hash[1] !== '/') {\r\n\t\t\treturn '/' + location.hash;\r\n\t\t}\r\n\t\treturn location.hash.slice(1);\r\n\t},\r\n\temit: function () {\r\n\t\tonChange(this.getLocation());\r\n\t},\r\n\tback: function () {\r\n    window.history.back();\r\n\t}\r\n};\r\n\r\nmodule.exports = hashStrategy;\r\n","var onChange = function () {};\r\n\r\nvar pushStrategy = {\r\n  init: function( options ){\r\n    this.basePath = options.basePath || '';\r\n    if( this.basePath.slice(-1) === '/' ){\r\n      this.basePath = this.basePath.slice(0, -1);\r\n    }\r\n  },\r\n  start: function(){\r\n    var me = this;\r\n\r\n    // Register event listener\r\n    window.onpopstate = function(){\r\n      me.emit();\r\n    };\r\n\r\n    // Emit first onChange\r\n    me.emit();\r\n  },\r\n  push: function( location ){\r\n    history.pushState( {}, '', this.basePath + location );\r\n    this.emit();\r\n  },\r\n  replace: function( location ){\r\n    history.replaceState( {}, '', this.basePath + location );\r\n    this.emit();\r\n  },\r\n  onChange: function( cb ){\r\n    onChange = cb;\r\n  },\r\n  getLocation: function(){\r\n    var l = location.pathname + location.search + location.hash,\r\n      basePathLength = this.basePath.length\r\n    ;\r\n\r\n    if( l.slice(0, basePathLength) === this.basePath ){\r\n      l = l.slice( basePathLength );\r\n    }\r\n\r\n    return l;\r\n  },\r\n  emit: function(){\r\n    onChange && onChange( this.getLocation() );\r\n  },\r\n\tback: function () {\r\n    window.history.back();\r\n\t}\r\n};\r\n\r\nmodule.exports = pushStrategy;\r\n","import urlhub from 'urlhub'\r\nimport nodeStrategy from 'urlhub/nodeStrategy'\r\nimport hashStrategy from 'urlhub/hashStrategy'\r\nimport pushStrategy from 'urlhub/pushStrategy'\r\n\r\n// A wrapper around urlhub to better manage a stack\r\n// Changes in the current routes will be stacking the screens,\r\n// if going back the screens don't get unmounted, there is an index\r\n// that points to the current active route\r\n//\r\n// The route also handles tab screens. Navegating in a tab screen doesn't\r\n// update the main stack, but the children inside the tab screen\r\n\r\n// If we imagine a linear stack of routes like this:\r\n// /a ---> /a/tab ---> /a/tab/2 ---> /a/tab/2/details ( activeIndex: 2 )\r\n// [0]     [1]         [2]           [3]\r\n\r\n// But the real stack that handles the tab screens would be like this:\r\n//\r\n//   [0]     [1]         [2]\r\n//   /a ---> /a/tab ---> /a/tab/2/details (activeIndex: 1)\r\n//              |\r\n//              V\r\n// [/a/tab/1, /a/tab/2, /a/tab/3 ] (activeTabIndex: 1)\r\n// [0]        [1]       [2]\r\n//\r\n// So there is a new stack for every tab\r\n\r\nexport default function create( routes, options ){\r\n\tvar strategy;\r\n\tif( typeof document === 'undefined' ){\r\n\t\tstrategy = nodeStrategy\r\n\t}\r\n\telse if( options && options.strategy === 'hash' ){\r\n\t\tstrategy = hashStrategy\r\n\t}\r\n\telse {\r\n\t\tstrategy = pushStrategy\r\n\t}\r\n\r\n\tvar router = urlhub.create({strategy});\r\n\r\n\t// callbacks registered for be called on route changes\r\n\tvar callbacks = [];\r\n\r\n\tvar stackRouter = {\r\n\t\t// The actual urlhub router\r\n\t\turlhub: router,\r\n\r\n\t\t// The stack of screens in place, with nested tabs [{Screen, route, isTabs, isModal, key}]\r\n\t\tstack: [],\r\n\r\n\t\t// The current screen in the view port\r\n\t\tactiveIndex: -1,\r\n\t\t\r\n\t\t// Route cache to generate new routes\r\n\t\t_nestedStack: [],\r\n\r\n\t\t// Last navigated URLs\r\n\t\t_lastNavigated: [],\r\n\r\n\t\tmodal: { active: false, stack: [], activeIndex: -1 },\r\n\r\n\t\t// What to do when the URL changes\r\n\t\tonChange: function( handler ){\r\n\t\t\tcallbacks.push( handler )\r\n\t\t},\r\n\r\n\t\t// The main method to update the current screen\r\n\t\tnavigate: function( route ){\r\n\t\t\tvar isBack = route === this._lastNavigated[ this._lastNavigated.length - 2];\r\n\r\n\t\t\tif( isBack ){\r\n\t\t\t\tthis._lastNavigated.pop();\r\n\t\t\t\t// unfortunatelly this is buggy in chrome\r\n\t\t\t\t// router.back();\r\n\t\t\t\trouter.push.apply( router, arguments );\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._lastNavigated.push( route );\r\n\t\t\t\trouter.push.apply( router, arguments );\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// Set routes and our callback that will generate the stacks\r\n\trouter.setRoutes( routes );\r\n\trouter.onChange( createRouteChanger( stackRouter, routes, callbacks ) );\r\n\r\n\t// Some extra methods from urlhub\r\n\t['start', 'stop', 'onBeforeChange', 'replace'].forEach( method => {\r\n\t\tstackRouter[method] = function(){\r\n\t\t\treturn this.urlhub[method].apply( this.urlhub, arguments );\r\n\t\t}\r\n\t});\r\n\r\n\treturn stackRouter;\r\n}\r\n\r\n// Helper to translate urlhub's location changes to the model {stack, index}\r\nfunction createRouteChanger( router, routes, callbacks ){\r\n\r\n\t// Get the hierarchy of absolute routes\r\n\tvar routeData = getRouteData( routes );\r\n\t\r\n\tvar onChange = location => {\r\n\t\t// Check if the change hasn't been programmatic (by the browser history or address bar )\r\n\t\tlet route = location.pathname + location.search + location.hash;\r\n\t\tif( route !== router._lastNavigated[ router._lastNavigated.length - 1] ){\r\n\t\t\t// In this case we flush the last navigated as we can't rely on our history to try to predict\r\n\t\t\t// going back interactions anymore\r\n\t\t\trouter._lastNavigated = [];\r\n\t\t}\r\n\r\n\t\t// Create a nested stack based on the current location\r\n\t\tvar nestedStack = createNestedStack( location, routeData );\r\n\t\tvar { stack, index } = mergeStacks( router._nestedStack || [], nestedStack, routeData );\r\n\t\tsetStacksAndIndexes( router, splitStack( stack ), index, routeData )\r\n\r\n\t\t// Update attributes of the router\r\n\t\trouter.location = location\r\n\t\trouter._nestedStack = stack\r\n\r\n\t\t// Call user's callbacks\r\n\t\tcallbacks.forEach( clbk => clbk(location) )\r\n\t}\r\n\r\n\treturn onChange\r\n}\r\n\r\nfunction createNestedStack( location, routeData ) {\r\n\tvar matchIds = location.matchIds;\r\n\tvar inTab = false;\r\n\tvar stack = [];\r\n\r\n\tmatchIds.forEach( route => {\r\n\t\tvar data = routeData[route];\r\n\r\n\t\tif (inTab) {\r\n\t\t\t// If we are in a tab we won't push this route to the main stack,\r\n\t\t\t// just update the activeIndex\r\n\t\t\tinTab.tabs.activeIndex = findTab(route, inTab.tabs.stack)\r\n\r\n\t\t\t// Get out the stack\r\n\t\t\tinTab = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar item = createStackItem( route, location, data );\r\n\r\n\t\tif (item.isTabs) {\r\n\t\t\t// Push all children\r\n\t\t\titem.tabs = {\r\n\t\t\t\tactiveIndex: 0,\r\n\t\t\t\tstack: routeData[item.route].children.map( child => (\r\n\t\t\t\t\tcreateStackItem( route + child.path, location, routeData[ route + child.path ] )\r\n\t\t\t\t))\r\n\t\t\t};\r\n\t\t\tinTab = item;\r\n\t\t}\r\n\r\n\t\tstack.push(item);\r\n\t})\r\n\r\n\tif( inTab ){\r\n\t\t// This means that the last screen in the hierarchy was a tab wrapper\r\n\t\t// Check if we have any tab to show\r\n\t\tif( !inTab.tabs.stack.length ){\r\n\t\t\tconsole.warn('Urlstack: Hit a tabs URL without any children: ' + tabScreen.path)\r\n\t\t}\r\n\t}\r\n\r\n\treturn stack\r\n}\r\n\r\nfunction splitStack( nestedStack ){\r\n\tvar allStacks = [];\r\n\tvar currentStack = [];\r\n\r\n\tnestedStack.forEach( item => {\r\n\t\tif( item.isModal ){\r\n\t\t\tallStacks.push( currentStack );\r\n\t\t\tcurrentStack = [ item ]\r\n\t\t}\r\n\t\telse {\r\n\t\t\tcurrentStack.push( item )\r\n\t\t}\r\n\t})\r\n\tif( currentStack.length ){\r\n\t\tallStacks.push( currentStack )\r\n\t}\r\n\treturn allStacks;\r\n}\r\n\r\nfunction setStacksAndIndexes( router, stacks, targetIndex, routeData ){\r\n\tif( !stacks[0].length ){\r\n\t\t// If the first element is empty means that we are in a modal\r\n\t\tif( !router.stack.length ){\r\n\t\t\t// if the currentstack is empty we need to get the default screen\r\n\t\t\tvar bgRoute = routeData[ stacks[1][0].route ].backgroundRoute || '/*'\r\n\t\t\tvar location = router.urlhub.match( bgRoute )\r\n\t\t\tvar {stack, index} = mergeStacks( [], createNestedStack( location, routeData ), routeData);\r\n\t\t\trouter.stack = stack\r\n\t\t\trouter.activeIndex = index\r\n\t\t}\r\n\t\t// otherwise we need to preserve the current stack\r\n\t}\r\n\telse {\r\n\t\trouter.stack = stacks[0]\r\n\t\trouter.activeIndex = Math.max( 0, Math.min( targetIndex, stacks[0].length - 1 ) )\r\n\t\tif( router.modal ){\r\n\t\t\trouter.modal.active = false\r\n\t\t}\r\n\t}\r\n\r\n\tif( stacks.length > 1 ){\r\n\t\tif( !router.modal ){\r\n\t\t\trouter.modal = { stack: [], activeIndex: 0 }\r\n\t\t}\r\n\t\trouter.modal.active = targetIndex >= 0;\r\n\t\tsetStacksAndIndexes( router.modal, stacks.slice(1), targetIndex - stacks[0].length, routeData )\r\n\t}\r\n}\r\n\r\n\r\nfunction createStackItem ( route, location, routeData ){\r\n\treturn {\r\n\t\tScreen: routeData.cb,\r\n\t\troute: route,\r\n\t\tisTabs: !!routeData.isTabs,\r\n\t\tisModal: !!routeData.isModal,\r\n\t\tlocation: location,\r\n\t\tpath: getRoutePath( route, location.pathname ),\r\n\t\tkey: generateKey()\r\n\t}\r\n}\r\n\r\nfunction getRoutePath( route, pathname ){\r\n\tvar routeParts = route.split('/');\r\n\tvar pathParts = pathname.split('/');\r\n\tvar routePath = [];\r\n\r\n\trouteParts.forEach( (p, i) => {\r\n\t\troutePath.push( pathParts[i] || p )\r\n\t})\r\n\r\n\treturn routePath.join('/');\r\n}\r\n\r\nfunction mergeStacks( currentStack, candidateStack, routeData ){\r\n\tvar nextStack = []\r\n\tvar i = 0\r\n\tvar sameRoot = true\r\n\tvar current = currentStack[0]\r\n\tvar candidate = candidateStack[0]\r\n\r\n\twhile ( current || candidate ) {\r\n\t\tif (sameRoot && current && candidate) {\r\n\t\t\tif (current.Screen === candidate.Screen) {\r\n\t\t\t\tnextStack.push( mergeItems( current, candidate, routeData ) )\r\n\t\t\t\tif( current.path !== candidate.path ){\r\n\t\t\t\t\t// If the paths are not the same, some parameter might have changed\r\n\t\t\t\t\t// discard the rest of the current stack. We already have reused the id\r\n\t\t\t\t\tsameRoot = false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tsameRoot = false;\r\n\t\t\t\tnextStack.push( candidate )\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (sameRoot && current) {\r\n\t\t\tnextStack.push( current );\r\n\t\t}\r\n\t\telse if (candidate) {\r\n\t\t\tnextStack.push( candidate )\r\n\t\t}\r\n\t\t// else if( current ) do nothing because is not the same root\r\n\r\n\t\ti++;\r\n\t\tcurrent = currentStack[i]\r\n\t\tcandidate = candidateStack[i]\r\n\t}\r\n\r\n\treturn {\r\n\t\tstack: nextStack,\r\n\t\tindex: candidateStack.length - 1\r\n\t}\r\n}\r\n\r\nfunction mergeItems( current, candidate, routeData ){\r\n\tvar item = {\r\n\t\t...candidate, key: current.key,\r\n\t}\r\n\r\n\tif( item.tabs ){\r\n\t\t// Merge tab stack\r\n\t\tlet tabStack = [];\r\n\t\tlet activeIndex = item.tabs.activeIndex\r\n\r\n\t\t// Preserve current tab data, except for the active one\r\n\t\tcurrent.tabs.stack.forEach( (item, i) => {\r\n\t\t\ttabStack.push(\r\n\t\t\t\ti === activeIndex ? candidate.tabs.stack[i] : item\r\n\t\t\t)\r\n\r\n\t\t\ttabStack[i].key = item.key\r\n\t\t\t// set the parameter visited\r\n\t\t\ttabStack[i].visited = item.visited || i === activeIndex\r\n\t\t})\r\n\r\n\t\t// Refresh the tabs\r\n\t\titem.tabs = {\r\n\t\t\tstack: tabStack,\r\n\t\t\tactiveIndex\r\n\t\t}\r\n\t}\r\n\r\n\treturn item;\r\n}\r\n\r\n/**\r\n * Transform the route definition for urlhub to an object where the keys are the absolute\r\n * path of every route, this way we don't need to navigate through childrens to get\r\n * the information of a router given its path.\r\n * \r\n * @param {*} routes The route object for urlhub\r\n * @param {*} parentRoute The path of the parent route to get the absolute path of children\r\n */\r\nfunction getRouteData( routes, parentRoute = '' ){\r\n\tvar h = {}\r\n\r\n\troutes.forEach( r => {\r\n\t\tvar route = parentRoute + r.path;\r\n\t\th[route] = r;\r\n\t\tif( r.children ){\r\n\t\t\tvar childrenData = getRouteData( r.children, route );\r\n\t\t\th = { ...h, ...childrenData }\r\n\t\t}\r\n\t})\r\n\r\n\treturn h\r\n}\r\n\r\n/**\r\n * Generate a random key to identify a route\r\n */\r\nfunction generateKey() {\r\n\tvar number = Math.floor( Math.random() * 100000 )\r\n\t// Make sure it starts with a varter - j is first varter of my name :)\r\n\treturn 'j' + number.toString(36);\r\n}\r\n\r\nfunction findTab( route, stack ){\r\n\tlet i = stack.length;\r\n\twhile( i-- ){\r\n\t\tif( stack[i].route === route ){\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\r\n\t// By default we show the first tab\r\n\treturn 0;\r\n}\r\n"],"names":["isarray","require","module","exports","pathToRegexp","parse","compile","tokensToFunction","tokensToRegExp","PATH_REGEXP","RegExp","join","str","options","tokens","key","index","path","defaultDelimiter","delimiter","res","exec","m","escaped","offset","slice","length","next","prefix","name","capture","group","modifier","asterisk","push","partial","repeat","optional","pattern","escapeGroup","escapeString","substr","encodeURIComponentPretty","encodeURI","replace","c","charCodeAt","toString","toUpperCase","encodeAsterisk","matches","Array","i","obj","opts","data","encode","pretty","encodeURIComponent","token","value","segment","TypeError","JSON","stringify","j","test","attachKeys","re","keys","flags","sensitive","regexpToRegexp","groups","source","match","arrayToRegexp","parts","regexp","stringToRegexp","strict","end","route","endsWithDelimiter","q_flat_1","q_set_1","parseUrl","window","url","a","document","createElement","href","urlhub","create","Urlhub","joinUrls","strategy","Error","s","ops","Object","forEach","init","obc","cbs","prototype","setRoutes","routes","parseRoutes","parent","console","warn","parsedRoutes","me","r","params","parsed","regex","parser","id","cb","map","p","children","childRegex","location","candidates","isChild","sanitizeUrl","found","pathname","concat","matchIds","error","search","query","qs","hash","start","onChange","change","checkChange","current","nextLocation","getLocation","stop","refresh","runOnBeforeChange","onBeforeChange","updateLocation","back","method","mergeLocations","one","two","first","second","sanitized","prev","assign","nodeStrategy","history","initialLocation","emit","split","searchParts","pop","hashStrategy","onhashchange","protocol","host","pushStrategy","basePath","onpopstate","pushState","replaceState","l","basePathLength","router","callbacks","stackRouter","stack","activeIndex","_nestedStack","_lastNavigated","modal","active","handler","navigate","isBack","apply","arguments","createRouteChanger","routeData","getRouteData","nestedStack","createNestedStack","mergeStacks","setStacksAndIndexes","splitStack","clbk","inTab","tabs","findTab","item","createStackItem","isTabs","child","tabScreen","allStacks","currentStack","isModal","stacks","targetIndex","bgRoute","backgroundRoute","Math","max","min","Screen","getRoutePath","generateKey","routeParts","pathParts","routePath","candidateStack","nextStack","sameRoot","candidate","mergeItems","tabStack","visited","parentRoute","h","childrenData","number","floor","random"],"mappings":"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"}